<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/blog/icon.png"><title>合并策略 | 汪图南</title><meta name="description" content="汪图南的个人博客">
    <link rel="preload" href="/blog/assets/style-DBGMMoKo.css" as="style"><link rel="stylesheet" href="/blog/assets/style-DBGMMoKo.css">
    <link rel="modulepreload" href="/blog/assets/app-BAxTuE_T.js"><link rel="modulepreload" href="/blog/assets/merge.html-C5HpL6ci.js">
    <link rel="prefetch" href="/blog/assets/index.html-Dsgayz9o.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CbAAmyEW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dzvmvk3B.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BVR2NJfg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BSEYEikx.js" as="script"><link rel="prefetch" href="/blog/assets/vueTest.html-BtP81ziM.js" as="script"><link rel="prefetch" href="/blog/assets/base.html-CBm3sd29.js" as="script"><link rel="prefetch" href="/blog/assets/challenge.html-Cw3rFkbP.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DqalEXAj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-q4QrsHfZ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DnYlnREY.js" as="script"><link rel="prefetch" href="/blog/assets/algorithm.html-U1BXMt3Q.js" as="script"><link rel="prefetch" href="/blog/assets/es6.html-D36RUC6c.js" as="script"><link rel="prefetch" href="/blog/assets/know-down.html-CdXvz0Aq.js" as="script"><link rel="prefetch" href="/blog/assets/know-up.html-CrfVu3ou.js" as="script"><link rel="prefetch" href="/blog/assets/red-book.html-DjYHoM7c.js" as="script"><link rel="prefetch" href="/blog/assets/vue.html-EVO-Yo4H.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cjbg4HfS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dh8AwAUB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Bpk0NghF.js" as="script"><link rel="prefetch" href="/blog/assets/gin.html-nHWrjj1t.js" as="script"><link rel="prefetch" href="/blog/assets/gorm.html-Byfas6Rw.js" as="script"><link rel="prefetch" href="/blog/assets/mod.html-BKq7i-c9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CegddWe5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CQJDEB3j.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DW1qFrqq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DcTXLM9a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CtCoGR8P.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-oCYHK1T3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BYNpprml.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BXIlhoTa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cxb8wC-1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C06Rxv2S.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cbop5qAA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BWBEXokP.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BWVhNSW3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DEa2Hu9c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-SHpc7zQr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CwYK4vVD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DELrnDk4.js" as="script"><link rel="prefetch" href="/blog/assets/codegen.html-BoRe57MT.js" as="script"><link rel="prefetch" href="/blog/assets/compileToFunctions.html-CTMIkrMU.js" as="script"><link rel="prefetch" href="/blog/assets/optimize.html-Cs-fMz0n.js" as="script"><link rel="prefetch" href="/blog/assets/parse.html-C_yxrR5X.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BTP3Hria.js" as="script"><link rel="prefetch" href="/blog/assets/async.html-B1Pg68EV.js" as="script"><link rel="prefetch" href="/blog/assets/createComponent.html-rgknnLV6.js" as="script"><link rel="prefetch" href="/blog/assets/createElement.html-eTDY1Ekm.js" as="script"><link rel="prefetch" href="/blog/assets/lifecycle.html-BPHAXCUb.js" as="script"><link rel="prefetch" href="/blog/assets/mount.html-B6YG8ooM.js" as="script"><link rel="prefetch" href="/blog/assets/patch.html-rry9_Rgg.js" as="script"><link rel="prefetch" href="/blog/assets/register.html-Ci_WAGQP.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-DhZGLKQB.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-NWpxYT1p.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BsQlh-SL.js" as="script"><link rel="prefetch" href="/blog/assets/diff.html-B8SYYhOE.js" as="script"><link rel="prefetch" href="/blog/assets/vnode.html-C7mHkZPt.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8JSVEu0A.js" as="script"><link rel="prefetch" href="/blog/assets/events.html-BvaqYMQF.js" as="script"><link rel="prefetch" href="/blog/assets/global.html-CwX9_Zsm.js" as="script"><link rel="prefetch" href="/blog/assets/init.html-CFsEE4_1.js" as="script"><link rel="prefetch" href="/blog/assets/lifecycle.html-DJYuchms.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-SIIUNGgE.js" as="script"><link rel="prefetch" href="/blog/assets/state.html-eXHTZczW.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-S5CQeaaV.js" as="script"><link rel="prefetch" href="/blog/assets/directive.html-CuIzfMw4.js" as="script"><link rel="prefetch" href="/blog/assets/event.html-BaRinhiC.js" as="script"><link rel="prefetch" href="/blog/assets/filter.html-B8DhvUbj.js" as="script"><link rel="prefetch" href="/blog/assets/keep-alive.html-C4coe8t_.js" as="script"><link rel="prefetch" href="/blog/assets/plugin.html-DBlpr7To.js" as="script"><link rel="prefetch" href="/blog/assets/slot.html-CfmkIvch.js" as="script"><link rel="prefetch" href="/blog/assets/transition-group.html-sd1veJXI.js" as="script"><link rel="prefetch" href="/blog/assets/transition.html-B53Jg5-G.js" as="script"><link rel="prefetch" href="/blog/assets/vmodel.html-JNr770_3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BHDlJ0jo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CEnnJL6p.js" as="script"><link rel="prefetch" href="/blog/assets/api.html-Cq4GZXaR.js" as="script"><link rel="prefetch" href="/blog/assets/computed.html-Ut6b9BpK.js" as="script"><link rel="prefetch" href="/blog/assets/data.html-YfxRqwlI.js" as="script"><link rel="prefetch" href="/blog/assets/dep.html-DszO8Xv_.js" as="script"><link rel="prefetch" href="/blog/assets/methods.html-DhgxaKpN.js" as="script"><link rel="prefetch" href="/blog/assets/nexttick.html-B4XJuy43.js" as="script"><link rel="prefetch" href="/blog/assets/notify.html-DG8BfeR4.js" as="script"><link rel="prefetch" href="/blog/assets/prepare.html-D13KCAcs.js" as="script"><link rel="prefetch" href="/blog/assets/problem.html-C0JoF-96.js" as="script"><link rel="prefetch" href="/blog/assets/props.html-CctXJsWI.js" as="script"><link rel="prefetch" href="/blog/assets/reactive.html-CvPPWDrj.js" as="script"><link rel="prefetch" href="/blog/assets/watch.html-Crwo5aDi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DMhcqPCj.js" as="script"><link rel="prefetch" href="/blog/assets/vue.html-Cx5Ov2op.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C2WSrRGD.js" as="script"><link rel="prefetch" href="/blog/assets/change.html-9zJ3ybps.js" as="script"><link rel="prefetch" href="/blog/assets/components.html-kR0LfYTD.js" as="script"><link rel="prefetch" href="/blog/assets/hooks.html-5C26Pn68.js" as="script"><link rel="prefetch" href="/blog/assets/install.html-BqLy81he.js" as="script"><link rel="prefetch" href="/blog/assets/matcher.html-BmcdnAAA.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CijfvrqR.js" as="script"><link rel="prefetch" href="/blog/assets/api.html-lJZPIAl-.js" as="script"><link rel="prefetch" href="/blog/assets/init.html-Czrp0GME.js" as="script"><link rel="prefetch" href="/blog/assets/install.html-BPBa-2yt.js" as="script"><link rel="prefetch" href="/blog/assets/utils.html-BHHuN2rh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C4Y-I2ag.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-fYzED3Ks.js" as="script"><link rel="prefetch" href="/blog/assets/createApp.html-W3SoQrzq.js" as="script"><link rel="prefetch" href="/blog/assets/lifecycle.html-B8bFsH0X.js" as="script"><link rel="prefetch" href="/blog/assets/mount.html-CtV_Ud1l.js" as="script"><link rel="prefetch" href="/blog/assets/register.html-BvsVJf3l.js" as="script"><link rel="prefetch" href="/blog/assets/render.html-COu3NLo8.js" as="script"><link rel="prefetch" href="/blog/assets/setup.html-D_2DdP9P.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BaS3N1Gy.js" as="script"><link rel="prefetch" href="/blog/assets/optimization.html-Bu-1uMoM.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-g7LhgUJg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-u2KKoc19.js" as="script"><link rel="prefetch" href="/blog/assets/base.html-DyzYPbul.js" as="script"><link rel="prefetch" href="/blog/assets/computed.html-Dariix20.js" as="script"><link rel="prefetch" href="/blog/assets/reactive.html-DdY-uUFm.js" as="script"><link rel="prefetch" href="/blog/assets/readonly.html-BurKnpU5.js" as="script"><link rel="prefetch" href="/blog/assets/ref.html-CHODsM3e.js" as="script"><link rel="prefetch" href="/blog/assets/track.html-Ct7AkQ3z.js" as="script"><link rel="prefetch" href="/blog/assets/trigger.html-ilRwtXNO.js" as="script"><link rel="prefetch" href="/blog/assets/watch.html-fVhDhIfa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-D8-uhoqM.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DmtCdEoT.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DNouQHAK.js" as="script"><link rel="prefetch" href="/blog/assets/advanced.html-OzHwLXHx.js" as="script"><link rel="prefetch" href="/blog/assets/case.html-BkJ22g1H.js" as="script"><link rel="prefetch" href="/blog/assets/core.html-sbV6oPtv.js" as="script"><link rel="prefetch" href="/blog/assets/install.html-DiI0y_mv.js" as="script"><link rel="prefetch" href="/blog/assets/loader.html-BqxIEHyk.js" as="script"><link rel="prefetch" href="/blog/assets/optimization.html-BKsXtW8C.js" as="script"><link rel="prefetch" href="/blog/assets/plugin.html-Es_s2as7.js" as="script"><link rel="prefetch" href="/blog/assets/source.html-CZwLPlrJ.js" as="script"><link rel="prefetch" href="/blog/assets/start.html-D7abb5X7.js" as="script"><link rel="prefetch" href="/blog/assets/static.html-D_BgKUfD.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CY0f-fRr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZUP1qtTq.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-KV6vwkrC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CB1B3dUV.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Ck4heJoh.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9Kk5MYKm.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CFODbzUk.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DRvK2Ffn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-btm47rq3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Dx1pRxPi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CplDvvng.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cbcwl8rJ.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CrnDgKIn.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Do807J2W.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BkUCdlyK.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BHuS6JSY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BBj59nIi.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CMoshjSj.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BFhUqIEY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2dFchOfX.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C-OEFVDL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DG-x6OPp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-COmeVJ4e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CaIZHDRL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-avdUbf8h.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cb3upaq4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C5Tiz3EO.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BMbLW9Ra.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DsHphRd9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DUqFezMc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CLtQ20Xe.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DmUYop7t.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BSNQyhAC.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DQD4kagr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DIROKueP.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DuZQL-11.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BLjBrZtv.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-_2nIPGPT.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B_ZGFOiY.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-xYdGYVnf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DKQL7Itr.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CaUO1Oyp.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-igJHuuIy.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-Cd3li1Qa.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DvwuJh_H.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ZiOFl6na.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-54ZVeaCg.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C820aO7D.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-pcA-rxsI.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CRiSflpo.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CZFJnDgz.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BuUPO4Bs.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C6BgGCwf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DGugn9pL.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-C1jjTx9S.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-B7vHzUGS.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-BWWyRsj3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-DelN_Cdb.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-CRa0lkcp.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-CDDIgkEB.js" as="script"><link rel="prefetch" href="/blog/assets/leetcodeLink-DB7xL6DB.js" as="script"><link rel="prefetch" href="/blog/assets/linkAndSolution-BX3mjzV5.js" as="script"><link rel="prefetch" href="/blog/assets/giscus-1zs_z9NH.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container data-v-ad8a078f><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/blog/"><!----><span class="vp-site-name" aria-hidden="true">汪图南</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="LLM"><span class="title">LLM</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="LLM"><span class="title">LLM</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>RAG</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/rag/base/" aria-label="RAG"><!--[--><!--[--><!--]--><!--]-->RAG<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Python技术栈"><span class="title">Python技术栈</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Python技术栈"><span class="title">Python技术栈</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/python/base/" aria-label="快速入门"><!--[--><!--[--><!--]--><!--]-->快速入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/python/advanced/" aria-label="高级技巧"><!--[--><!--[--><!--]--><!--]-->高级技巧<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/blog/interview/" aria-label="前端面试之道"><!--[--><!--[--><!--]--><!--]-->前端面试之道<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端技术栈"><span class="title">前端技术栈</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端技术栈"><span class="title">前端技术栈</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/webpack/webpack/" aria-label="Webpack"><!--[--><!--[--><!--]--><!--]-->Webpack<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/rollup/" aria-label="Rollup"><!--[--><!--[--><!--]--><!--]-->Rollup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>TypeScript</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/typescript/base/" aria-label="TypeScript基础"><!--[--><!--[--><!--]--><!--]-->TypeScript基础<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/typescript/challenge/" aria-label="TypeScript类型挑战"><!--[--><!--[--><!--]--><!--]-->TypeScript类型挑战<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>CSS预编译器</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/cssPrecompiler/sass/" aria-label="SASS"><!--[--><!--[--><!--]--><!--]-->SASS<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>自动化测试</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/test/vueTest/" aria-label="Vue应用测试"><!--[--><!--[--><!--]--><!--]-->Vue应用测试<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Vue源码分析"><span class="title">Vue源码分析</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Vue源码分析"><span class="title">Vue源码分析</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/vueAnalysis/introduction/" aria-label="Vue2.0源码分析"><!--[--><!--[--><!--]--><!--]-->Vue2.0源码分析<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/vueNextAnalysis/introduction/" aria-label="Vue3.0源码分析"><!--[--><!--[--><!--]--><!--]-->Vue3.0源码分析<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/algorithm/base/introduction/" aria-label="数据结构和算法(基础)"><!--[--><!--[--><!--]--><!--]-->数据结构和算法(基础)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/algorithm/leetcode/introduction/" aria-label="LeetCode(刷题)"><!--[--><!--[--><!--]--><!--]-->LeetCode(刷题)<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="书籍"><span class="title">书籍</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="书籍"><span class="title">书籍</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>JavaScript书籍</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/know-up/" aria-label="你不知道的JavaScript(上)"><!--[--><!--[--><!--]--><!--]-->你不知道的JavaScript(上)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/know-down/" aria-label="你不知道的JavaScript(中下)"><!--[--><!--[--><!--]--><!--]-->你不知道的JavaScript(中下)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/algorithm/" aria-label="JavaScript数据结构和算法"><!--[--><!--[--><!--]--><!--]-->JavaScript数据结构和算法<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/designPattern/" aria-label="JavaScript设计模式与开发实践"><!--[--><!--[--><!--]--><!--]-->JavaScript设计模式与开发实践<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/es6/" aria-label="深入理解ES6"><!--[--><!--[--><!--]--><!--]-->深入理解ES6<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>Git书籍</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/git/" aria-label="精通Git"><!--[--><!--[--><!--]--><!--]-->精通Git<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/wangtunan/blog" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="LLM"><span class="title">LLM</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="LLM"><span class="title">LLM</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>RAG</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/rag/base/" aria-label="RAG"><!--[--><!--[--><!--]--><!--]-->RAG<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Python技术栈"><span class="title">Python技术栈</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Python技术栈"><span class="title">Python技术栈</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/python/base/" aria-label="快速入门"><!--[--><!--[--><!--]--><!--]-->快速入门<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/python/advanced/" aria-label="高级技巧"><!--[--><!--[--><!--]--><!--]-->高级技巧<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/blog/interview/" aria-label="前端面试之道"><!--[--><!--[--><!--]--><!--]-->前端面试之道<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="前端技术栈"><span class="title">前端技术栈</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="前端技术栈"><span class="title">前端技术栈</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>打包工具</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/webpack/webpack/" aria-label="Webpack"><!--[--><!--[--><!--]--><!--]-->Webpack<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/rollup/" aria-label="Rollup"><!--[--><!--[--><!--]--><!--]-->Rollup<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>TypeScript</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/typescript/base/" aria-label="TypeScript基础"><!--[--><!--[--><!--]--><!--]-->TypeScript基础<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/typescript/challenge/" aria-label="TypeScript类型挑战"><!--[--><!--[--><!--]--><!--]-->TypeScript类型挑战<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>CSS预编译器</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/cssPrecompiler/sass/" aria-label="SASS"><!--[--><!--[--><!--]--><!--]-->SASS<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>自动化测试</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/test/vueTest/" aria-label="Vue应用测试"><!--[--><!--[--><!--]--><!--]-->Vue应用测试<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="Vue源码分析"><span class="title">Vue源码分析</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="Vue源码分析"><span class="title">Vue源码分析</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/vueAnalysis/introduction/" aria-label="Vue2.0源码分析"><!--[--><!--[--><!--]--><!--]-->Vue2.0源码分析<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/vueNextAnalysis/introduction/" aria-label="Vue3.0源码分析"><!--[--><!--[--><!--]--><!--]-->Vue3.0源码分析<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="算法"><span class="title">算法</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="算法"><span class="title">算法</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/algorithm/base/introduction/" aria-label="数据结构和算法(基础)"><!--[--><!--[--><!--]--><!--]-->数据结构和算法(基础)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-item"><a class="route-link auto-link" href="/blog/algorithm/leetcode/introduction/" aria-label="LeetCode(刷题)"><!--[--><!--[--><!--]--><!--]-->LeetCode(刷题)<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="vp-navbar-item"><div class="vp-navbar-dropdown-wrapper"><button class="vp-navbar-dropdown-title" type="button" aria-label="书籍"><span class="title">书籍</span><span class="arrow down"></span></button><button class="vp-navbar-dropdown-title-mobile" type="button" aria-label="书籍"><span class="title">书籍</span><span class="right arrow"></span></button><ul class="vp-navbar-dropdown" style="display:none;"><!--[--><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>JavaScript书籍</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/know-up/" aria-label="你不知道的JavaScript(上)"><!--[--><!--[--><!--]--><!--]-->你不知道的JavaScript(上)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/know-down/" aria-label="你不知道的JavaScript(中下)"><!--[--><!--[--><!--]--><!--]-->你不知道的JavaScript(中下)<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/algorithm/" aria-label="JavaScript数据结构和算法"><!--[--><!--[--><!--]--><!--]-->JavaScript数据结构和算法<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/designPattern/" aria-label="JavaScript设计模式与开发实践"><!--[--><!--[--><!--]--><!--]-->JavaScript设计模式与开发实践<!--[--><!--[--><!--]--><!--]--></a></li><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/javascript/es6/" aria-label="深入理解ES6"><!--[--><!--[--><!--]--><!--]-->深入理解ES6<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><li class="vp-navbar-dropdown-item"><!--[--><h4 class="vp-navbar-dropdown-subtitle"><span>Git书籍</span></h4><ul class="vp-navbar-dropdown-subitem-wrapper"><!--[--><li class="vp-navbar-dropdown-subitem"><a class="route-link auto-link" href="/blog/books/git/" aria-label="精通Git"><!--[--><!--[--><!--]--><!--]-->精通Git<!--[--><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul></div></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/wangtunan/blog" aria-label="Github" rel="noopener noreferrer" target="_blank"><!--[--><!--[--><!--]--><!--]-->Github<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">介绍 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/introduction/" aria-label="介绍和参考"><!--[--><!--[--><!--]--><!--]-->介绍和参考<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">源码目录设计和架构设计 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/design/" aria-label="设计"><!--[--><!--[--><!--]--><!--]-->设计<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Rollup构建版本 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/rollup/" aria-label="Rollup基础知识"><!--[--><!--[--><!--]--><!--]-->Rollup基础知识<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/rollup/vue.html" aria-label="Vue中的Rollup构建"><!--[--><!--[--><!--]--><!--]-->Vue中的Rollup构建<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">从入口到构造函数整体流程 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/" aria-label="整体流程"><!--[--><!--[--><!--]--><!--]-->整体流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/global.html" aria-label="initGlobalAPI流程"><!--[--><!--[--><!--]--><!--]-->initGlobalAPI流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/init.html" aria-label="initMixin流程"><!--[--><!--[--><!--]--><!--]-->initMixin流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/state.html" aria-label="stateMixin流程"><!--[--><!--[--><!--]--><!--]-->stateMixin流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/events.html" aria-label="eventsMixin流程"><!--[--><!--[--><!--]--><!--]-->eventsMixin流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/lifecycle.html" aria-label="lifecycleMixin流程"><!--[--><!--[--><!--]--><!--]-->lifecycleMixin流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/entry/render.html" aria-label="renderMixin流程"><!--[--><!--[--><!--]--><!--]-->renderMixin流程<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">响应式原理 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/" aria-label="介绍"><!--[--><!--[--><!--]--><!--]-->介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/prepare.html" aria-label="前置核心概念"><!--[--><!--[--><!--]--><!--]-->前置核心概念<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/props.html" aria-label="props处理"><!--[--><!--[--><!--]--><!--]-->props处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/methods.html" aria-label="methods处理"><!--[--><!--[--><!--]--><!--]-->methods处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/data.html" aria-label="data处理"><!--[--><!--[--><!--]--><!--]-->data处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/computed.html" aria-label="computed处理"><!--[--><!--[--><!--]--><!--]-->computed处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/watch.html" aria-label="watch处理"><!--[--><!--[--><!--]--><!--]-->watch处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/reactive.html" aria-label="深入响应式原理"><!--[--><!--[--><!--]--><!--]-->深入响应式原理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/dep.html" aria-label="依赖收集"><!--[--><!--[--><!--]--><!--]-->依赖收集<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/notify.html" aria-label="派发更新"><!--[--><!--[--><!--]--><!--]-->派发更新<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/nexttick.html" aria-label="nextTick实现原理"><!--[--><!--[--><!--]--><!--]-->nextTick实现原理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/problem.html" aria-label="变化侦测注意事项"><!--[--><!--[--><!--]--><!--]-->变化侦测注意事项<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/reactive/api.html" aria-label="变化侦测API实现"><!--[--><!--[--><!--]--><!--]-->变化侦测API实现<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">虚拟DOM和VNode <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/dom/" aria-label="虚拟DOM"><!--[--><!--[--><!--]--><!--]-->虚拟DOM<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/dom/vnode.html" aria-label="VNode介绍"><!--[--><!--[--><!--]--><!--]-->VNode介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/dom/diff.html" aria-label="Diff算法"><!--[--><!--[--><!--]--><!--]-->Diff算法<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">组件化 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link route-link-active auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/" aria-label="介绍"><!--[--><!--[--><!--]--><!--]-->介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/mount.html" aria-label="$mount方法"><!--[--><!--[--><!--]--><!--]-->$mount方法<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/render.html" aria-label="render和renderProxy"><!--[--><!--[--><!--]--><!--]-->render和renderProxy<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/createElement.html" aria-label="createElement"><!--[--><!--[--><!--]--><!--]-->createElement<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/createComponent.html" aria-label="createComponent"><!--[--><!--[--><!--]--><!--]-->createComponent<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/blog/vueAnalysis/component/merge.html" aria-label="合并策略"><!--[--><!--[--><!--]--><!--]-->合并策略<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/patch.html" aria-label="update和patch"><!--[--><!--[--><!--]--><!--]-->update和patch<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/lifecycle.html" aria-label="组件生命周期"><!--[--><!--[--><!--]--><!--]-->组件生命周期<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/component/register.html" aria-label="组件注册"><!--[--><!--[--><!--]--><!--]-->组件注册<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">编译原理 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/compile/" aria-label="介绍"><!--[--><!--[--><!--]--><!--]-->介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/compile/compileToFunctions.html" aria-label="compileToFunctions"><!--[--><!--[--><!--]--><!--]-->compileToFunctions<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/compile/parse.html" aria-label="parse模板解析"><!--[--><!--[--><!--]--><!--]-->parse模板解析<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/compile/optimize.html" aria-label="optimize优化"><!--[--><!--[--><!--]--><!--]-->optimize优化<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/compile/codegen.html" aria-label="codegen代码生成"><!--[--><!--[--><!--]--><!--]-->codegen代码生成<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">扩展 <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/" aria-label="扩展"><!--[--><!--[--><!--]--><!--]-->扩展<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/directive.html" aria-label="directive指令"><!--[--><!--[--><!--]--><!--]-->directive指令<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/filter.html" aria-label="filter过滤器"><!--[--><!--[--><!--]--><!--]-->filter过滤器<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/event.html" aria-label="event事件处理"><!--[--><!--[--><!--]--><!--]-->event事件处理<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/vmodel.html" aria-label="v-model"><!--[--><!--[--><!--]--><!--]-->v-model<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/slot.html" aria-label="插槽"><!--[--><!--[--><!--]--><!--]-->插槽<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/keep-alive.html" aria-label="Keep-Alive"><!--[--><!--[--><!--]--><!--]-->Keep-Alive<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/transition.html" aria-label="Transition"><!--[--><!--[--><!--]--><!--]-->Transition<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/transition-group.html" aria-label="Transition-Group"><!--[--><!--[--><!--]--><!--]-->Transition-Group<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/expand/plugin.html" aria-label="Vue.use插件机制"><!--[--><!--[--><!--]--><!--]-->Vue.use插件机制<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Vue-Router <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/" aria-label="介绍"><!--[--><!--[--><!--]--><!--]-->介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/install.html" aria-label="路由安装"><!--[--><!--[--><!--]--><!--]-->路由安装<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/matcher.html" aria-label="matcher介绍"><!--[--><!--[--><!--]--><!--]-->matcher介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/change.html" aria-label="路由切换"><!--[--><!--[--><!--]--><!--]-->路由切换<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/components.html" aria-label="内置组件"><!--[--><!--[--><!--]--><!--]-->内置组件<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/router/hooks.html" aria-label="路由hooks钩子函数"><!--[--><!--[--><!--]--><!--]-->路由hooks钩子函数<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Vuex <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/vuex/" aria-label="介绍"><!--[--><!--[--><!--]--><!--]-->介绍<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/vuex/install.html" aria-label="Vuex安装"><!--[--><!--[--><!--]--><!--]-->Vuex安装<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/vuex/init.html" aria-label="Vuex初始化"><!--[--><!--[--><!--]--><!--]-->Vuex初始化<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/vuex/utils.html" aria-label="Vuex辅助API"><!--[--><!--[--><!--]--><!--]-->Vuex辅助API<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/blog/vueAnalysis/vuex/api.html" aria-label="Store实例API"><!--[--><!--[--><!--]--><!--]-->Store实例API<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="合并策略" tabindex="-1"><a class="header-anchor" href="#合并策略"><span>合并策略</span></a></h1><p>在这一节合并策略中，我们主要分三个步骤来说明：<strong>配置合并的背景</strong>、<strong>配置合并的场景</strong>以及<strong>合并策略</strong>。</p><h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景"><span>背景</span></a></h2><p>我们可能会很好奇，为什么要进行配置合并？这是因为<code>Vue</code>内部存在一些默认的配置，在初始化的时候又允许我们提供一些自定义配置，这是为了在不同的场景下达到定制化个性需求的目的。纵观一些优秀的开源库、框架它们的设计理念几乎都是类似的。</p><p>我们举例来说明一下配置合并的背景：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;global created mixin&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;global mounted mixin&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>假设我们使用<code>Vue.mixin</code>方法全局混入了两个生命周期配置<code>created</code>和<code>mounted</code>，那么在我们的应用中，这两个生命周期配置都会反应到各个实例上去，无论是根实例还是各种组件实例。但对于根实例或者组件实例而言，它们也可能会拥有自己的<code>created</code>或<code>mounted</code>配置，如果不进行合理的配置合并，那么会出现一些意料之外的问题。</p><h2 id="场景" tabindex="-1"><a class="header-anchor" href="#场景"><span>场景</span></a></h2><p>要进行配置合并的场景不止一两处，我们主要介绍以下四种场景：</p><ul><li><strong>vue-loader</strong>：在之前我们提到过当我们使用<code>.vue</code>文件的形式进行开发的时候，由于<code>.vue</code>属于特殊的文件扩展，<code>webpack</code>无法原生识别，因此需要对应的<code>loader</code>去解析，它就是<code>vue-loader</code>。假如我们撰写以下<code>HelloWorld.vue</code>组件，然后在别的地方去引入它。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// HelloWorld.vue</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;HelloWorld&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;hello, world&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// App.vue</span></span>
<span class="line"><span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">&#39;@/components/HelloWorld.vue&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    HelloWorld</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为我们在<code>HelloWorld.vue</code>文件中只提供了<code>name</code>和<code>data</code>两个配置选项，但真正调试的时候我们发现<code>HelloWorld</code>组件的实例上多了很多额外的属性，这是因为<code>vue-loader</code>帮我们默认添加的。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> HelloWorld <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">beforeCreate</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">beforeDestroy</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;HelloWorld&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token string">&#39;hello, world&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token operator">...</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以发现<code>vue-loader</code>默认添加的有<code>beforeCreate</code>和<code>beforeDestroy</code>两个配置，如果我们组件自身也提供了这两个配置的话，这种情况必须进行配置合并。</p><ul><li><strong>extend</strong>：在上一节我们介绍<code>createComponent</code>的时候，我们知道子组件会继承大<code>Vue</code>上的一些属性或方法，假设我们全局注册了一个组件。</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">&#39;@/components/HelloWorld.vue&#39;</span></span>
<span class="line">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;HelloWorld&#39;</span><span class="token punctuation">,</span> HelloWorld<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>当我们在其它组件中也注册了一些组件，这样大<code>Vue</code>上的<code>components</code>就要和组件中的<code>components</code>进行合理的配置合并。</p><ul><li><strong>mixin</strong>：在前面的<strong>配置合并背景</strong>小节中，我们使用<code>Vue.mixin</code>全局混入了两个生命周期配置，这属于<code>mixin</code>配置合并的范围，我们来举例另外一种组件内的<code>mixin</code>混入场景：</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// mixin定义</span></span>
<span class="line"><span class="token keyword">const</span> sayMixin <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello mixin created&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello mixin mounted&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 组件引入mixin</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">mixins</span><span class="token operator">:</span> <span class="token punctuation">[</span>sayMixin<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app component created&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app component mounted&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当在<code>App.vue</code>组件中提供<code>mixins</code>选择的时候，因为在我们定义的<code>sayMixin</code>也提供了<code>created</code>和<code>mounted</code>两个生命周期配置，因此这种情况下也要进行配置合并。又因为<code>mixins</code>接受一个数组选项，假如我们传递了多个已经定义的<code>mixin</code>，而这些<code>mixin</code>又可能会存在提供了相同配置的情况，因此同样需要进行配置合并。</p><p><strong>注意</strong>：<code>Vue.mixin</code>全局<code>API</code>方法在内部调用了<code>mergeOptions</code>来进行混入，它的定义位置我们在之前的<code>initGlobalAPI</code>小节中提到过，其实现代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> mergeOptions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../util/index&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">initMixin</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">Vue</span><span class="token operator">:</span> GlobalAPI</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  Vue<span class="token punctuation">.</span><span class="token function-variable function">mixin</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">mixin</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">,</span> mixin<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">this</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>this._init</strong>：严格意义上来说，这里其实并不算是一个配置合并的场景，而应该是一种配置合并的手段。对于第一种<code>vue-loader</code>和第二种<code>extend</code>的场景，它们在必要的场景下也会在<code>this._init</code>进行配置合并，例如在子组件实例化的时候，它在构造函数中就调用了<code>this._init</code>:</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">Sub</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">_init</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ...省略其它</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>options <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>_isComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// optimize internal component instantiation</span></span>
<span class="line">    <span class="token comment">// since dynamic options merging is pretty slow, and none of the</span></span>
<span class="line">    <span class="token comment">// internal component options needs special treatment.</span></span>
<span class="line">    <span class="token function">initInternalComponent</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> options<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    vm<span class="token punctuation">.</span>$options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span></span>
<span class="line">      <span class="token function">resolveConstructorOptions</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">      options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      vm</span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">// ...省略其它</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="合并策略-1" tabindex="-1"><a class="header-anchor" href="#合并策略-1"><span>合并策略</span></a></h2><p>我们先来看看合并策略的代码，它是定义在<code>src/core/util/options.js</code>文件中，其代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mergeOptions</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parent</span><span class="token operator">:</span> Object<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">child</span><span class="token operator">:</span> Object<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">checkComponents</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> child <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    child <span class="token operator">=</span> child<span class="token punctuation">.</span>options</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token function">normalizeProps</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">normalizeInject</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">normalizeDirectives</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// Apply extends and mixins on the child options,</span></span>
<span class="line">  <span class="token comment">// but only if it is a raw options object that isn&#39;t</span></span>
<span class="line">  <span class="token comment">// the result of another mergeOptions call.</span></span>
<span class="line">  <span class="token comment">// Only merged options has the _base property.</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>child<span class="token punctuation">.</span>_base<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>extends<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>extends<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>mixins<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">let</span> key</span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasOwn</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">function</span> <span class="token function">mergeField</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> strat <span class="token operator">=</span> strats<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">||</span> defaultStrat</span>
<span class="line">    options<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">strat</span><span class="token punctuation">(</span>parent<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> child<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> vm<span class="token punctuation">,</span> key<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> options</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们先忽略<code>mergeOptions</code>方法中其它的代码，来看最核心的<code>mergeField</code>，在这个方法里面，它会根据不同的<code>key</code>，调用策略对象<code>strats</code>中的策略方法，然后把合并完的配置再赋值到<code>options</code>上，<code>strats</code>策略对象每个<code>key</code>的具体定义我们会在之后对应的章节中介绍。</p><h3 id="默认合并策略" tabindex="-1"><a class="header-anchor" href="#默认合并策略"><span>默认合并策略</span></a></h3><p>在<code>mergeField</code>方法中，我们看到当传入的<code>key</code>没有对应的策略方法时，会使用<code>defaultStrat</code>默认合并策略，它的定义代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">defaultStrat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">childVal</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> childVal <span class="token operator">===</span> <span class="token keyword">undefined</span></span>
<span class="line">    <span class="token operator">?</span> parentVal</span>
<span class="line">    <span class="token operator">:</span> childVal</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>defaultStrat</code>默认合并策略的代码非常简单，即：简单的覆盖已有值，例如：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token function-variable function">defaultStrat</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">parentVal<span class="token punctuation">,</span> childVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> childVal <span class="token operator">===</span> <span class="token keyword">undefined</span></span>
<span class="line">    <span class="token operator">?</span> parentVal</span>
<span class="line">    <span class="token operator">:</span> childVal</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> parent <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;parent&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> child <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;child&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&#39;广州&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">mergeOptions</span> <span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> child<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parent<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">mergeField</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">function</span> <span class="token function">mergeField</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    options<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">defaultStrat</span><span class="token punctuation">(</span>parent<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> child<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> options</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> $options <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">)</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>$options<span class="token punctuation">)</span> <span class="token comment">// { age: 23, name: &#39;child&#39;, sex: 1, address: &#39;广州&#39; }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码分析：在以上案例中，<code>age</code>和<code>name</code>都存在于<code>parent</code>和<code>child</code>对象中，因为<code>child.age</code>值为<code>undefined</code>，所以最后取<code>parent.age</code>值，这种情况也适用于<code>sex</code>属性的合并。因为<code>child.name</code>值不为<code>undefined</code>，所以最后取<code>child.name</code>的值，这种情况也适用于<code>address</code>属性的合并。</p><p><strong>注意</strong>：如果你想针对某一个选项修改它的默认合并策略，可以使用<code>Vue.config.optionMergeStrategies</code>去配置，例如：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 自定义el选择的合并策略，只取第二个参数的。</span></span>
<span class="line"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line">Vue<span class="token punctuation">.</span>config<span class="token punctuation">.</span>optionMergeStrategies<span class="token punctuation">.</span>el <span class="token operator">=</span> <span class="token punctuation">(</span>toVal<span class="token punctuation">,</span> fromVal<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> fromVal</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="el和propsdata合并" tabindex="-1"><a class="header-anchor" href="#el和propsdata合并"><span>el和propsData合并</span></a></h3><p>对于<code>el</code>和<code>propsData</code>属性的合并，在<code>Vue</code>中使用了默认合并策略，其定义代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> strats <span class="token operator">=</span> config<span class="token punctuation">.</span>optionMergeStrategies</span>
<span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  strats<span class="token punctuation">.</span>el <span class="token operator">=</span> strats<span class="token punctuation">.</span><span class="token function-variable function">propsData</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">parent<span class="token punctuation">,</span> child<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// ...省略其它</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">defaultStrat</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对于<code>el</code>和<code>propsData</code>这两个选项来说，使用默认合并策略的原因很简单，因为<code>el</code>和<code>propsData</code>只允许有一份。</p><h3 id="生命周期hooks合并" tabindex="-1"><a class="header-anchor" href="#生命周期hooks合并"><span>生命周期hooks合并</span></a></h3><p>对于生命周期钩子函数而言，它们都是通过<code>mergeHook</code>方法来合并的，<code>strats</code>策略对象上关于<code>hooks</code>属性定义代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">LIFECYCLE_HOOKS</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string">&#39;beforeCreate&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;created&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;beforeMount&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;mounted&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;beforeUpdate&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;updated&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;beforeDestroy&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;destroyed&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;activated&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;deactivated&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;errorCaptured&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;serverPrefetch&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token constant">LIFECYCLE_HOOKS</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">hook</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  strats<span class="token punctuation">[</span>hook<span class="token punctuation">]</span> <span class="token operator">=</span> mergeHook</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们接下来看一下<code>mergeHook</code>是如何实现的，其代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">function</span> <span class="token function">mergeHook</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>Function<span class="token operator">&gt;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> <span class="token operator">?</span>Function <span class="token operator">|</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>Function<span class="token operator">&gt;</span></span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>Array<span class="token operator">&lt;</span>Function<span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> childVal</span>
<span class="line">    <span class="token operator">?</span> parentVal</span>
<span class="line">      <span class="token operator">?</span> parentVal<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>childVal<span class="token punctuation">)</span></span>
<span class="line">      <span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>childVal<span class="token punctuation">)</span></span>
<span class="line">        <span class="token operator">?</span> childVal</span>
<span class="line">        <span class="token operator">:</span> <span class="token punctuation">[</span>childVal<span class="token punctuation">]</span></span>
<span class="line">    <span class="token operator">:</span> parentVal</span>
<span class="line">  <span class="token keyword">return</span> res</span>
<span class="line">    <span class="token operator">?</span> <span class="token function">dedupeHooks</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">:</span> res</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">dedupeHooks</span> <span class="token punctuation">(</span><span class="token parameter">hooks</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> hooks<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>hooks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      res<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>hooks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> res</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以看到在<code>mergeHook</code>方法中，它用到了三层三目运算来判断，首先判断了是否有<code>childVal</code>，如果没有则直接返回<code>parentVal</code>；如果有，再判断<code>parentVal</code>有没有，如果有则一定是数组形式，这个时候直接把<code>childVal</code>添加到<code>parentVal</code>数组的末尾；如果没有，则需要判断一下<code>childVal</code>是不是数组，如果不是数组则转成数组，如果已经是数组了，则直接返回。</p><p>在最后还判断了<code>res</code>，然后满足条件则调用<code>dedupeHooks</code>，这个方法的作用很简单，就是剔除掉数组中的重复项。最后，我们根据以上逻辑撰写几个案例来说明。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 情况一</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 情况二</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created1</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">created2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 情况三</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">function</span> <span class="token function">created2</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们再来看一个比较特殊的场景：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// mixin.js</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> sayMixin <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;say mixin created&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> helloMixin <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;hello mixin created&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">// App.vue</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> sayMixin<span class="token punctuation">,</span> helloMixin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./mixin.js&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">mixins</span><span class="token operator">:</span> <span class="token punctuation">[</span>sayMixin<span class="token punctuation">,</span> helloMixin<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;component created&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 执行顺序</span></span>
<span class="line"><span class="token comment">// say mixin created</span></span>
<span class="line"><span class="token comment">// hello mixin created</span></span>
<span class="line"><span class="token comment">// component created</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码分析：我们可以看到<code>mixins</code>里面的<code>created</code>生命周期函数会优先于组件自身提供的<code>created</code>生命周期函数，这是因为在遍历<code>parent</code>和<code>child</code>的属性之前，会优先处理<code>extends</code>和<code>mixins</code>选项。以<code>mixins</code>为例，它会首先遍历我们提供的<code>mixins</code>数组，然后依次把这些配置按照规则合并到<code>parent</code>上，最后在遍历<code>child</code>的属性时，才会把其自身的配置合并对应的位置，在我们提供的例子当中，自身提供的<code>created</code>会使用数组<code>concat</code>方法添加到数组的末尾。当组件触发<code>created</code>生命周期的时候，会按照数组顺序依次调用。</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>child<span class="token punctuation">.</span>_base<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>extends<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>extends<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>mixins<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      parent <span class="token operator">=</span> <span class="token function">mergeOptions</span><span class="token punctuation">(</span>parent<span class="token punctuation">,</span> child<span class="token punctuation">.</span>mixins<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="data和provide合并" tabindex="-1"><a class="header-anchor" href="#data和provide合并"><span>data和provide合并</span></a></h3><p>对于<code>data</code>和<code>provide</code>而言，它们最后都使用<code>mergeDataOrFn</code>来合并，只不过对于<code>data</code>选项比较特殊，它需要单独包裹一层，它们在<code>strats</code>策略对象上的属性定义如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">strats<span class="token punctuation">.</span><span class="token function-variable function">data</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> any<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> any<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>Function <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>childVal <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> childVal <span class="token operator">!==</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">warn</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token string">&#39;The &quot;data&quot; option should be a function &#39;</span> <span class="token operator">+</span></span>
<span class="line">        <span class="token string">&#39;that returns a per-instance value in component &#39;</span> <span class="token operator">+</span></span>
<span class="line">        <span class="token string">&#39;definitions.&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        vm</span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">      <span class="token keyword">return</span> parentVal</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">mergeDataOrFn</span><span class="token punctuation">(</span>parentVal<span class="token punctuation">,</span> childVal<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">mergeDataOrFn</span><span class="token punctuation">(</span>parentVal<span class="token punctuation">,</span> childVal<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">strats<span class="token punctuation">.</span>provide <span class="token operator">=</span> mergeDataOrFn</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在合并<code>data</code>的包裹函数中，对<code>childVal</code>进行了检验，如果不是函数类型，提示错误信息并直接返回。如果时，再调用<code>mergeDataOrFn</code>方法来合并。接下来，我们来看一下<code>mergeDataOrFn</code>方法的具体实现逻辑：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">mergeDataOrFn</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> any<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> any<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>Function <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>vm<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// in a Vue.extend merge, both should be functions</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> parentVal</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parentVal<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> childVal</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// when parentVal &amp; childVal are both present,</span></span>
<span class="line">    <span class="token comment">// we need to return a function that returns the</span></span>
<span class="line">    <span class="token comment">// merged result of both functions... no need to</span></span>
<span class="line">    <span class="token comment">// check if parentVal is a function here because</span></span>
<span class="line">    <span class="token comment">// it has to be a function to pass previous merges.</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">mergedDataFn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token function">mergeData</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token keyword">typeof</span> childVal <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">?</span> <span class="token function">childVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> childVal<span class="token punctuation">,</span></span>
<span class="line">        <span class="token keyword">typeof</span> parentVal <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">?</span> <span class="token function">parentVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">:</span> parentVal</span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">mergedInstanceDataFn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token comment">// instance merge</span></span>
<span class="line">      <span class="token keyword">const</span> instanceData <span class="token operator">=</span> <span class="token keyword">typeof</span> childVal <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span></span>
<span class="line">        <span class="token operator">?</span> <span class="token function">childVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">        <span class="token operator">:</span> childVal</span>
<span class="line">      <span class="token keyword">const</span> defaultData <span class="token operator">=</span> <span class="token keyword">typeof</span> parentVal <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span></span>
<span class="line">        <span class="token operator">?</span> <span class="token function">parentVal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">        <span class="token operator">:</span> parentVal</span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>instanceData<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> <span class="token function">mergeData</span><span class="token punctuation">(</span>instanceData<span class="token punctuation">,</span> defaultData<span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">return</span> defaultData</span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>mergeDataOrFn</code>方法中，我们可以发现它根据<code>vm</code>进行了区分，但这两块的合并思路是一致的：如果<code>parentVal</code>和<code>childVal</code>是函数类型，则分别调用这个函数，然后合并它们返回的对象，这种情况主要针对<code>data</code>合并。对于<code>provide</code>而言，它不需要是<code>function</code>类型，因此直接使用<code>mergeData</code>来合并即可。我们再回过头来看，为什么要区分<code>vm</code>，这是因为要处理兼容<code>provide</code>的情况，当传递<code>provide</code>的时候，因为这个属性是在父级定义的，因此<code>this</code>属于父级而不是当前组件<code>vm</code>。</p><p>最后来看一下<code>mergeData</code>方法的实现代码：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">function</span> <span class="token function">mergeData</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">to</span><span class="token operator">:</span> Object<span class="token punctuation">,</span> <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token operator">?</span>Object</span><span class="token punctuation">)</span><span class="token operator">:</span> Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>from<span class="token punctuation">)</span> <span class="token keyword">return</span> to</span>
<span class="line">  <span class="token keyword">let</span> key<span class="token punctuation">,</span> toVal<span class="token punctuation">,</span> fromVal</span>
<span class="line"></span>
<span class="line">  <span class="token keyword">const</span> keys <span class="token operator">=</span> hasSymbol</span>
<span class="line">    <span class="token operator">?</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span></span>
<span class="line">    <span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    key <span class="token operator">=</span> keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span></span>
<span class="line">    <span class="token comment">// in case the object is already observed...</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">&#39;__ob__&#39;</span><span class="token punctuation">)</span> <span class="token keyword">continue</span></span>
<span class="line">    toVal <span class="token operator">=</span> to<span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">    fromVal <span class="token operator">=</span> from<span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasOwn</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">set</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> key<span class="token punctuation">,</span> fromVal<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span></span>
<span class="line">      toVal <span class="token operator">!==</span> fromVal <span class="token operator">&amp;&amp;</span></span>
<span class="line">      <span class="token function">isPlainObject</span><span class="token punctuation">(</span>toVal<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span></span>
<span class="line">      <span class="token function">isPlainObject</span><span class="token punctuation">(</span>fromVal<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">mergeData</span><span class="token punctuation">(</span>toVal<span class="token punctuation">,</span> fromVal<span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> to</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>mergeData</code>和前面提到<code>extend</code>方法所做的事情几乎是一样的，只不过由于<code>data</code>中所有的属性(包括嵌套对象的属性)，我们需要使用<code>set</code>处理成响应式的。<code>set</code>方法就是<code>Vue.set</code>或<code>this.$set</code>方法的本体，它定义在<code>src/core/observer/index.js</code>文件中，我们之前在响应式章节提到过。</p><h3 id="components、directives和filters合并" tabindex="-1"><a class="header-anchor" href="#components、directives和filters合并"><span>components、directives和filters合并</span></a></h3><p>对于<code>components</code>、<code>directives</code>以及<code>filters</code>的合并是同一个<code>mergeAssets</code>方法，<code>strats</code>策略对象上关于这几种属性定义代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> <span class="token constant">ASSET_TYPES</span> <span class="token operator">=</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string">&#39;component&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;directive&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&#39;filter&#39;</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"><span class="token constant">ASSET_TYPES</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  strats<span class="token punctuation">[</span>type <span class="token operator">+</span> <span class="token string">&#39;s&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> mergeAssets</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>接下来，我们看一下<code>mergeAssets</code>具体定义：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">function</span> <span class="token function">mergeAssets</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span><span class="token number">1</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">key</span><span class="token operator">:</span> string</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parentVal <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token function">assertObjectType</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> childVal<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">extend</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> childVal<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> res</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>mergeAssets</code>方法的代码不是很多，逻辑也很清晰，首先以<code>parentVal</code>创建一个<code>res</code>原型，如果<code>childVal</code>没有，则直接返回这个<code>res</code>原型；如果有，则使用<code>extend</code>把<code>childVal</code>上的所有属性扩展到<code>res</code>原型上。有一点需要注意，<code>extend</code>不是我们之前提到的<code>Vue.extend</code>或者<code>this.$extend</code>，它是定义在<code>src/shared/utils.js</code>文件中的一个方法，其代码如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">extend</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">to</span><span class="token operator">:</span> Object<span class="token punctuation">,</span> <span class="token literal-property property">_from</span><span class="token operator">:</span> <span class="token operator">?</span>Object</span><span class="token punctuation">)</span><span class="token operator">:</span> Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> _from<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    to<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> _from<span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> to</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们撰写一个简单的例子来说明一下<code>extend</code>方法的用法：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;AAA&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token string">&#39;男&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&#39;广州&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> extendObj <span class="token operator">=</span> <span class="token function">extend</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">)</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>extendObj<span class="token punctuation">)</span> <span class="token comment">// { name: &#39;AAA&#39;, age: 23, sex: &#39;男&#39;, address: &#39;广州&#39; }</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在介绍完<code>extend</code>方法后，我们回到<code>mergeAssets</code>方法，我们同样举例说明：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// main.js</span></span>
<span class="line"><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span></span>
<span class="line"><span class="token keyword">import</span> HelloWorld <span class="token keyword">from</span> <span class="token string">&#39;@/components/HelloWorld.vue&#39;</span></span>
<span class="line">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">&#39;HelloWorld&#39;</span><span class="token punctuation">,</span> HelloWorld<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// App.vue</span></span>
<span class="line"><span class="token keyword">import</span> Test <span class="token keyword">from</span> <span class="token string">&#39;@/components/test.vue&#39;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;App&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    Test</span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>main.js</code>入口文件中，我们全局定义了一个<code>HelloWorld</code> 全局组件，然后在<code>App.vue</code>中又定义了一个<code>Test</code>局部组件，当代码运行到<code>mergeAssets</code>的时候，部分参数如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">HelloWorld</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">KeepAlive</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">Transition</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">TransitionGroup</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">Test</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为<code>parentVal</code>和<code>childVal</code>都有值，因此会调用<code>extend</code>方法，调用前和调用后的<code>res</code>如下所示：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 调用前</span></span>
<span class="line"><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">HelloWorld</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">KeepAlive</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">Transition</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">TransitionGroup</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// extend调用后</span></span>
<span class="line"><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">Test</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">HelloWorld</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">VueComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">KeepAlive</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">Transition</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">TransitionGroup</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>假如我们在<code>App.vue</code>组件中都使用了这两个组件，如下：</p><div class="language-vue line-numbers-mode" data-highlighter="prismjs" data-ext="vue"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>test</span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hello-world</span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在<code>App.vue</code>组件渲染的过程中，当编译到<code>&lt;test /&gt;</code>时，会在其<code>components</code>选项中查找组件，马上在自身属性上找到了<code>test.vue</code>。然后当编译到<code>&lt;hello-world /&gt;</code>的时候，在自身对象上找不到这个属性，根据原型链的规则会在原型上去找，然后在<code>__proto__</code>上找到了<code>HelloWorld.vue</code>组件，两个组件得以顺利的被解析和渲染。</p><p>对于另外两个选项<code>directives</code>和<code>filters</code>，它们跟<code>components</code>是一样的处理逻辑。</p><h3 id="watch合并" tabindex="-1"><a class="header-anchor" href="#watch合并"><span>watch合并</span></a></h3><p>对于<code>watch</code>选项而言，它使用的合并方法是单独定义的，其在<code>strats</code>策略对象上的属性定义如下：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">strats<span class="token punctuation">.</span><span class="token function-variable function">watch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">key</span><span class="token operator">:</span> string</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// work around Firefox&#39;s Object.prototype.watch...</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>parentVal <span class="token operator">===</span> nativeWatch<span class="token punctuation">)</span> parentVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>childVal <span class="token operator">===</span> nativeWatch<span class="token punctuation">)</span> childVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line">  <span class="token comment">/* istanbul ignore if */</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>childVal<span class="token punctuation">)</span> <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parentVal <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">assertObjectType</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> childVal<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parentVal<span class="token punctuation">)</span> <span class="token keyword">return</span> childVal</span>
<span class="line">  <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> parentVal<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> childVal<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">let</span> parent <span class="token operator">=</span> ret<span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">const</span> child <span class="token operator">=</span> childVal<span class="token punctuation">[</span>key<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      parent <span class="token operator">=</span> <span class="token punctuation">[</span>parent<span class="token punctuation">]</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    ret<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> parent</span>
<span class="line">      <span class="token operator">?</span> parent<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span></span>
<span class="line">      <span class="token operator">:</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">?</span> child <span class="token operator">:</span> <span class="token punctuation">[</span>child<span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> ret</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以看到<code>watch</code>配置的合并与<code>hooks</code>合并的思路几乎差不多，只是多了一些微小的差异，当<code>childVal</code>没有时，直接返回按照<code>parentVal</code>创建的原型，类似的当<code>parentVal</code>没有时，直接返回<code>childVal</code>，注意这里因为是自身的配置，因此不需要像<code>parentVal</code>那样创建并一个原型。当<code>parentVal</code>和<code>childVal</code>都存在时，首先把<code>parentVal</code>上的属性全部扩展到<code>ret</code>对象上，然后遍历<code>childVal</code>的属性键。在遍历的过程中如果<code>parent</code>值不为数组形式，则手动处理成数组形式，然后把<code>child</code>使用数组<code>concat</code>方法添加到数组的末尾。以上代码分析，可以使用下面的示例来说明：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// 情况一</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;parent watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line"><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">__proto__</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;parent watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 情况二</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token keyword">undefined</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;child watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;child watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 情况三</span></span>
<span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;parent watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">msg</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;child watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;parent watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;child watch msg&#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与<code>hooks</code>一样，如果在<code>mixins</code>里面也提供了与自身组件一样的<code>watch</code>，那么会优先执行<code>mixins</code>里面的<code>watch</code>，然后在执行自身组件中的<code>watch</code>。</p><h3 id="props、methods、inject和computed合并" tabindex="-1"><a class="header-anchor" href="#props、methods、inject和computed合并"><span>props、methods、inject和computed合并</span></a></h3><p><code>props</code>、<code>methods</code>、<code>inject</code>和<code>computed</code>和之前我们提到的几种配置有点不一样，这几种配置有一个共同点：不允许存在相同的属性，例如我们在<code>methods</code>上提供的属性，不管来自于哪里，我们只需要把所有属性合并在一起即可。</p><p>接下来我们来看一下这几个属性在<code>strats</code>策略对象上的具体定义：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">strats<span class="token punctuation">.</span>props <span class="token operator">=</span></span>
<span class="line">strats<span class="token punctuation">.</span>methods <span class="token operator">=</span></span>
<span class="line">strats<span class="token punctuation">.</span>inject <span class="token operator">=</span></span>
<span class="line">strats<span class="token punctuation">.</span><span class="token function-variable function">computed</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span></span>
<span class="line">  <span class="token parameter"><span class="token literal-property property">parentVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">childVal</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span></span>
<span class="line">  vm<span class="token operator">?</span><span class="token operator">:</span> Component<span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">key</span><span class="token operator">:</span> string</span></span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token operator">?</span>Object <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>childVal <span class="token operator">&amp;&amp;</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">assertObjectType</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> childVal<span class="token punctuation">,</span> vm<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>parentVal<span class="token punctuation">)</span> <span class="token keyword">return</span> childVal</span>
<span class="line">  <span class="token keyword">const</span> ret <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> parentVal<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>childVal<span class="token punctuation">)</span> <span class="token function">extend</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> childVal<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> ret</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>我们可以看到，在其实现方法中代码并不是很复杂，仅仅使用到<code>extend</code>方法合并对象属性即可。当<code>parentVal</code>没有时，直接返回<code>childVal</code>，这里也不需要创建并返回一个原型，原因在上面提到过。如果<code>parentVal</code>有，则先创建一个原型，再使用<code>extend</code>把<code>parentVal</code>上的所有属性全部扩展到<code>ret</code>对象上。最后再判断<code>childVal</code>，如果有则再使用<code>extend</code>把<code>childVal</code>上的对象扩展到<code>ret</code>上，如果没有，则直接返回。以上代码分析，我们举例说明：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> parentVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;AAA&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> childVal <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&#39;广州&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;AAA&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&#39;广州&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--[--><div id="comment" class="giscus-wrapper input-top vp-comment layout-comment" vp-comment style="display:block;" data-v-ad8a078f><div style="display: flex;align-items: center;justify-content: center;height: 96px"><span style="--loading-icon: url(&quot;data:image/svg+xml;utf8,%3Csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; preserveAspectRatio=&#39;xMidYMid&#39; viewBox=&#39;25 25 50 50&#39;%3E%3CanimateTransform attributeName=&#39;transform&#39; type=&#39;rotate&#39; dur=&#39;2s&#39; keyTimes=&#39;0;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;360&#39;%3E%3C/animateTransform%3E%3Ccircle cx=&#39;50&#39; cy=&#39;50&#39; r=&#39;20&#39; fill=&#39;none&#39; stroke=&#39;currentColor&#39; stroke-width=&#39;4&#39; stroke-linecap=&#39;round&#39;%3E%3Canimate attributeName=&#39;stroke-dasharray&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;1,200;90,200;1,200&#39;%3E%3C/animate%3E%3Canimate attributeName=&#39;stroke-dashoffset&#39; dur=&#39;1.5s&#39; keyTimes=&#39;0;0.5;1&#39; repeatCount=&#39;indefinite&#39; values=&#39;0;-35px;-125px&#39;%3E%3C/animate%3E%3C/circle%3E%3C/svg%3E&quot;);--icon-size: 48px;display: inline-block;width: var(--icon-size);height: var(--icon-size);background-color: currentcolor;-webkit-mask-image: var(--loading-icon);mask-image: var(--loading-icon)"></span></div></div><!--]--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">最后更新时间: </span><time class="meta-item-info" datetime="2025-05-02T04:21:08.000Z" data-allow-mismatch>2025/5/2 04:21</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: why583440138@gmail.com">wangtunan</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/blog/vueAnalysis/component/createComponent.html" aria-label="createComponent"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">createComponent</span></div><!--]--></a><a class="route-link auto-link next" href="/blog/vueAnalysis/component/patch.html" aria-label="update和patch"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">update和patch</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/blog/assets/app-BAxTuE_T.js" defer></script>
  </body>
</html>
