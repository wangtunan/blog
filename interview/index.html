<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端面试之道 | 汪图南</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/blog/icon.png">
    <script>var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?1876f64fd31c9aba1a7a5e157813a075";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();</script>
    <meta name="description" content="汪图南的个人博客">
    
    <link rel="preload" href="/blog/assets/css/0.styles.df711742.css" as="style"><link rel="preload" href="/blog/assets/js/app.e2b3f633.js" as="script"><link rel="preload" href="/blog/assets/js/3.8b672db4.js" as="script"><link rel="preload" href="/blog/assets/js/2.e585f687.js" as="script"><link rel="preload" href="/blog/assets/js/18.267b2708.js" as="script"><link rel="prefetch" href="/blog/assets/js/1.9e27f4a0.js"><link rel="prefetch" href="/blog/assets/js/10.abd04970.js"><link rel="prefetch" href="/blog/assets/js/100.c3254a30.js"><link rel="prefetch" href="/blog/assets/js/101.7c24e37e.js"><link rel="prefetch" href="/blog/assets/js/102.57c5a5b8.js"><link rel="prefetch" href="/blog/assets/js/103.0aa63558.js"><link rel="prefetch" href="/blog/assets/js/104.6c3bda7a.js"><link rel="prefetch" href="/blog/assets/js/105.9e7ae3c9.js"><link rel="prefetch" href="/blog/assets/js/106.e87071a8.js"><link rel="prefetch" href="/blog/assets/js/107.741ca66a.js"><link rel="prefetch" href="/blog/assets/js/108.45bb4994.js"><link rel="prefetch" href="/blog/assets/js/109.ae7f638c.js"><link rel="prefetch" href="/blog/assets/js/11.ddca3676.js"><link rel="prefetch" href="/blog/assets/js/110.b8278429.js"><link rel="prefetch" href="/blog/assets/js/111.0cf21380.js"><link rel="prefetch" href="/blog/assets/js/112.2278b395.js"><link rel="prefetch" href="/blog/assets/js/113.49af98c7.js"><link rel="prefetch" href="/blog/assets/js/114.24d7ba45.js"><link rel="prefetch" href="/blog/assets/js/115.3efa422a.js"><link rel="prefetch" href="/blog/assets/js/116.b1f07740.js"><link rel="prefetch" href="/blog/assets/js/117.123d2e73.js"><link rel="prefetch" href="/blog/assets/js/118.166a13dd.js"><link rel="prefetch" href="/blog/assets/js/119.5ce8a5b9.js"><link rel="prefetch" href="/blog/assets/js/12.737cb762.js"><link rel="prefetch" href="/blog/assets/js/120.a4de47e5.js"><link rel="prefetch" href="/blog/assets/js/121.810c56a5.js"><link rel="prefetch" href="/blog/assets/js/122.a778b325.js"><link rel="prefetch" href="/blog/assets/js/123.14cdb5f4.js"><link rel="prefetch" href="/blog/assets/js/124.551f3b64.js"><link rel="prefetch" href="/blog/assets/js/125.16b6013f.js"><link rel="prefetch" href="/blog/assets/js/126.ef9b01ee.js"><link rel="prefetch" href="/blog/assets/js/127.5a3de5f8.js"><link rel="prefetch" href="/blog/assets/js/128.dc2a8815.js"><link rel="prefetch" href="/blog/assets/js/129.770a230a.js"><link rel="prefetch" href="/blog/assets/js/130.1914e24b.js"><link rel="prefetch" href="/blog/assets/js/131.11a14433.js"><link rel="prefetch" href="/blog/assets/js/132.0b18dcdc.js"><link rel="prefetch" href="/blog/assets/js/133.e15d360d.js"><link rel="prefetch" href="/blog/assets/js/134.78fd8215.js"><link rel="prefetch" href="/blog/assets/js/135.cf8b6b4c.js"><link rel="prefetch" href="/blog/assets/js/136.1225557f.js"><link rel="prefetch" href="/blog/assets/js/137.5943c21c.js"><link rel="prefetch" href="/blog/assets/js/138.3ba8c383.js"><link rel="prefetch" href="/blog/assets/js/139.e6842f66.js"><link rel="prefetch" href="/blog/assets/js/140.c0be9085.js"><link rel="prefetch" href="/blog/assets/js/141.b17dff23.js"><link rel="prefetch" href="/blog/assets/js/142.be1160f7.js"><link rel="prefetch" href="/blog/assets/js/143.618188ad.js"><link rel="prefetch" href="/blog/assets/js/144.c1660ef6.js"><link rel="prefetch" href="/blog/assets/js/145.815862de.js"><link rel="prefetch" href="/blog/assets/js/15.1abdc53c.js"><link rel="prefetch" href="/blog/assets/js/16.f74b6f21.js"><link rel="prefetch" href="/blog/assets/js/17.ad3f3b79.js"><link rel="prefetch" href="/blog/assets/js/19.81b16c65.js"><link rel="prefetch" href="/blog/assets/js/20.3611e2da.js"><link rel="prefetch" href="/blog/assets/js/21.71c03611.js"><link rel="prefetch" href="/blog/assets/js/22.bb4536ca.js"><link rel="prefetch" href="/blog/assets/js/23.4d923623.js"><link rel="prefetch" href="/blog/assets/js/24.155fb1f6.js"><link rel="prefetch" href="/blog/assets/js/25.081bf204.js"><link rel="prefetch" href="/blog/assets/js/26.f69f2672.js"><link rel="prefetch" href="/blog/assets/js/27.3444d41d.js"><link rel="prefetch" href="/blog/assets/js/28.f258f108.js"><link rel="prefetch" href="/blog/assets/js/29.0f639db0.js"><link rel="prefetch" href="/blog/assets/js/30.dd15b4cc.js"><link rel="prefetch" href="/blog/assets/js/31.838f1af8.js"><link rel="prefetch" href="/blog/assets/js/32.144cee3c.js"><link rel="prefetch" href="/blog/assets/js/33.1033e30a.js"><link rel="prefetch" href="/blog/assets/js/34.c2ea7b36.js"><link rel="prefetch" href="/blog/assets/js/35.781d2240.js"><link rel="prefetch" href="/blog/assets/js/36.e1131061.js"><link rel="prefetch" href="/blog/assets/js/37.a32d405c.js"><link rel="prefetch" href="/blog/assets/js/38.0f8567a3.js"><link rel="prefetch" href="/blog/assets/js/39.7d15d8b5.js"><link rel="prefetch" href="/blog/assets/js/4.719595d3.js"><link rel="prefetch" href="/blog/assets/js/40.d6197d4e.js"><link rel="prefetch" href="/blog/assets/js/41.27c95221.js"><link rel="prefetch" href="/blog/assets/js/42.d53bf412.js"><link rel="prefetch" href="/blog/assets/js/43.111769b6.js"><link rel="prefetch" href="/blog/assets/js/44.04049fcb.js"><link rel="prefetch" href="/blog/assets/js/45.186fad1e.js"><link rel="prefetch" href="/blog/assets/js/46.3cc431e7.js"><link rel="prefetch" href="/blog/assets/js/47.06d948cf.js"><link rel="prefetch" href="/blog/assets/js/48.145434fd.js"><link rel="prefetch" href="/blog/assets/js/49.6a7ae33f.js"><link rel="prefetch" href="/blog/assets/js/5.08e5ce2d.js"><link rel="prefetch" href="/blog/assets/js/50.9b49ff3d.js"><link rel="prefetch" href="/blog/assets/js/51.a69dc7af.js"><link rel="prefetch" href="/blog/assets/js/52.58f3f9b0.js"><link rel="prefetch" href="/blog/assets/js/53.6d9c0982.js"><link rel="prefetch" href="/blog/assets/js/54.5271aa58.js"><link rel="prefetch" href="/blog/assets/js/55.b84c8ff0.js"><link rel="prefetch" href="/blog/assets/js/56.c14c8c0a.js"><link rel="prefetch" href="/blog/assets/js/57.2c14451d.js"><link rel="prefetch" href="/blog/assets/js/58.5e844c4c.js"><link rel="prefetch" href="/blog/assets/js/59.c4d7931c.js"><link rel="prefetch" href="/blog/assets/js/6.8470a004.js"><link rel="prefetch" href="/blog/assets/js/60.dd579e10.js"><link rel="prefetch" href="/blog/assets/js/61.2b8b685a.js"><link rel="prefetch" href="/blog/assets/js/62.93581ab1.js"><link rel="prefetch" href="/blog/assets/js/63.af1785e0.js"><link rel="prefetch" href="/blog/assets/js/64.11d22585.js"><link rel="prefetch" href="/blog/assets/js/65.6ceace49.js"><link rel="prefetch" href="/blog/assets/js/66.10e8627f.js"><link rel="prefetch" href="/blog/assets/js/67.194fd8bb.js"><link rel="prefetch" href="/blog/assets/js/68.95aa1845.js"><link rel="prefetch" href="/blog/assets/js/69.2d476f84.js"><link rel="prefetch" href="/blog/assets/js/7.881c396a.js"><link rel="prefetch" href="/blog/assets/js/70.e2db9bb1.js"><link rel="prefetch" href="/blog/assets/js/71.9ffdfa46.js"><link rel="prefetch" href="/blog/assets/js/72.20818d96.js"><link rel="prefetch" href="/blog/assets/js/73.5838b16e.js"><link rel="prefetch" href="/blog/assets/js/74.01afb822.js"><link rel="prefetch" href="/blog/assets/js/75.299b2deb.js"><link rel="prefetch" href="/blog/assets/js/76.0221ff31.js"><link rel="prefetch" href="/blog/assets/js/77.f4cbe28d.js"><link rel="prefetch" href="/blog/assets/js/78.df396381.js"><link rel="prefetch" href="/blog/assets/js/79.129a8dd2.js"><link rel="prefetch" href="/blog/assets/js/8.631b107b.js"><link rel="prefetch" href="/blog/assets/js/80.5fadfa15.js"><link rel="prefetch" href="/blog/assets/js/81.dd3b2525.js"><link rel="prefetch" href="/blog/assets/js/82.7bb1f733.js"><link rel="prefetch" href="/blog/assets/js/83.7f2fe472.js"><link rel="prefetch" href="/blog/assets/js/84.ffa6a1da.js"><link rel="prefetch" href="/blog/assets/js/85.51d431a3.js"><link rel="prefetch" href="/blog/assets/js/86.d9a761e6.js"><link rel="prefetch" href="/blog/assets/js/87.26da0af5.js"><link rel="prefetch" href="/blog/assets/js/88.d9849d2b.js"><link rel="prefetch" href="/blog/assets/js/89.063437cc.js"><link rel="prefetch" href="/blog/assets/js/9.10d9f56a.js"><link rel="prefetch" href="/blog/assets/js/90.1681ee39.js"><link rel="prefetch" href="/blog/assets/js/91.b5a6f276.js"><link rel="prefetch" href="/blog/assets/js/92.bd19b682.js"><link rel="prefetch" href="/blog/assets/js/93.2d0f56bf.js"><link rel="prefetch" href="/blog/assets/js/94.05213e72.js"><link rel="prefetch" href="/blog/assets/js/95.4effaccc.js"><link rel="prefetch" href="/blog/assets/js/96.84f8ac8b.js"><link rel="prefetch" href="/blog/assets/js/97.7bb152dc.js"><link rel="prefetch" href="/blog/assets/js/98.07ef13e7.js"><link rel="prefetch" href="/blog/assets/js/99.5c33329b.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.0bb60075.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.df711742.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">汪图南</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/interview/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  前端面试之道
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端书籍" class="dropdown-title"><span class="title">前端书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端书籍" class="mobile-dropdown-title"><span class="title">前端书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JavaScript书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/books/javascript/know-up.html" class="nav-link">
  你不知道的JavaScript(上)
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/know-down.html" class="nav-link">
  你不知道的JavaScript(中下)
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/algorithm.html" class="nav-link">
  JavaScript数据结构和算法
</a></li><li class="dropdown-subitem"><a href="/blog/designPattern/" class="nav-link">
  JavaScript设计模式与开发实践
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/es6.html" class="nav-link">
  深入理解ES6
</a></li></ul></li><li class="dropdown-item"><h4>
          Git书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/books/git/" class="nav-link">
  精通Git
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue源码分析" class="dropdown-title"><span class="title">Vue源码分析</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue源码分析" class="mobile-dropdown-title"><span class="title">Vue源码分析</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vueAnalysis/introduction/" class="nav-link">
  Vue2.0源码分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/vueNextAnalysis/introduction/" class="nav-link">
  Vue3.0源码分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自动化测试" class="dropdown-title"><span class="title">自动化测试</span> <span class="arrow down"></span></button> <button type="button" aria-label="自动化测试" class="mobile-dropdown-title"><span class="title">自动化测试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/test/vueTest.html" class="nav-link">
  Vue应用测试
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/webpack/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/rollup/" class="nav-link">
  Rollup
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="TypeScript" class="dropdown-title"><span class="title">TypeScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="TypeScript" class="mobile-dropdown-title"><span class="title">TypeScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/typescript/base.html" class="nav-link">
  TypeScript基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/typescript/challenge.html" class="nav-link">
  TypeScript类型挑战
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS预编译器" class="dropdown-title"><span class="title">CSS预编译器</span> <span class="arrow down"></span></button> <button type="button" aria-label="CSS预编译器" class="mobile-dropdown-title"><span class="title">CSS预编译器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cssPrecompiler/sass/" class="nav-link">
  SASS
</a></li><li class="dropdown-item"><!----> <a href="/blog/cssPrecompiler/sassLoader/" class="nav-link">
  Sass-Loader源码分析
</a></li></ul></div></div><div class="nav-item"><a href="/blog/vuepress/" class="nav-link">
  VuePress
</a></div> <a href="https://github.com/wangtunan/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/interview/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  前端面试之道
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端书籍" class="dropdown-title"><span class="title">前端书籍</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端书籍" class="mobile-dropdown-title"><span class="title">前端书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JavaScript书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/books/javascript/know-up.html" class="nav-link">
  你不知道的JavaScript(上)
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/know-down.html" class="nav-link">
  你不知道的JavaScript(中下)
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/algorithm.html" class="nav-link">
  JavaScript数据结构和算法
</a></li><li class="dropdown-subitem"><a href="/blog/designPattern/" class="nav-link">
  JavaScript设计模式与开发实践
</a></li><li class="dropdown-subitem"><a href="/blog/books/javascript/es6.html" class="nav-link">
  深入理解ES6
</a></li></ul></li><li class="dropdown-item"><h4>
          Git书籍
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/blog/books/git/" class="nav-link">
  精通Git
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue源码分析" class="dropdown-title"><span class="title">Vue源码分析</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue源码分析" class="mobile-dropdown-title"><span class="title">Vue源码分析</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/vueAnalysis/introduction/" class="nav-link">
  Vue2.0源码分析
</a></li><li class="dropdown-item"><!----> <a href="/blog/vueNextAnalysis/introduction/" class="nav-link">
  Vue3.0源码分析
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="自动化测试" class="dropdown-title"><span class="title">自动化测试</span> <span class="arrow down"></span></button> <button type="button" aria-label="自动化测试" class="mobile-dropdown-title"><span class="title">自动化测试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/test/vueTest.html" class="nav-link">
  Vue应用测试
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="打包工具" class="dropdown-title"><span class="title">打包工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="打包工具" class="mobile-dropdown-title"><span class="title">打包工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/webpack/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/blog/rollup/" class="nav-link">
  Rollup
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="TypeScript" class="dropdown-title"><span class="title">TypeScript</span> <span class="arrow down"></span></button> <button type="button" aria-label="TypeScript" class="mobile-dropdown-title"><span class="title">TypeScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/typescript/base.html" class="nav-link">
  TypeScript基础
</a></li><li class="dropdown-item"><!----> <a href="/blog/typescript/challenge.html" class="nav-link">
  TypeScript类型挑战
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS预编译器" class="dropdown-title"><span class="title">CSS预编译器</span> <span class="arrow down"></span></button> <button type="button" aria-label="CSS预编译器" class="mobile-dropdown-title"><span class="title">CSS预编译器</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/cssPrecompiler/sass/" class="nav-link">
  SASS
</a></li><li class="dropdown-item"><!----> <a href="/blog/cssPrecompiler/sassLoader/" class="nav-link">
  Sass-Loader源码分析
</a></li></ul></div></div><div class="nav-item"><a href="/blog/vuepress/" class="nav-link">
  VuePress
</a></div> <a href="https://github.com/wangtunan/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>前端面试之道</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/interview/#javascript基础知识面试题" class="sidebar-link">JavaScript基础知识面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#原始类型" class="sidebar-link">原始类型</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#对象类型" class="sidebar-link">对象类型</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#typeof和instanceof" class="sidebar-link">typeof和instanceof</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#类型转换" class="sidebar-link">类型转换</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#和" class="sidebar-link">== 和 ===</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#new构造调用的过程" class="sidebar-link">new构造调用的过程</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#this全解析" class="sidebar-link">this全解析</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#闭包" class="sidebar-link">闭包</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#原型、原型链" class="sidebar-link">原型、原型链</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#浅拷贝、深拷贝" class="sidebar-link">浅拷贝、深拷贝</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#继承" class="sidebar-link">继承</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#es6" class="sidebar-link">ES6</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#javascript异步" class="sidebar-link">JavaScript异步</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#eventloop事件循环" class="sidebar-link">EventLoop事件循环</a></li></ul></li><li><a href="/blog/interview/#javascript进阶面试题" class="sidebar-link">JavaScript进阶面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#手写getquerystring" class="sidebar-link">手写getQueryString</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写自己的setinterval" class="sidebar-link">手写自己的setInterval</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写call、apply和bind方法" class="sidebar-link">手写call、apply和bind方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写promise" class="sidebar-link">手写Promise</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写函数节流" class="sidebar-link">手写函数节流</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写函数防抖" class="sidebar-link">手写函数防抖</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写instanceof" class="sidebar-link">手写instanceof</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写简易深拷贝" class="sidebar-link">手写简易深拷贝</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写对象属性值迭代器" class="sidebar-link">手写对象属性值迭代器</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写图片懒加载" class="sidebar-link">手写图片懒加载</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写事件委托" class="sidebar-link">手写事件委托</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写原生ajax请求" class="sidebar-link">手写原生Ajax请求</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写函数aop" class="sidebar-link">手写函数AOP</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写柯里化" class="sidebar-link">手写柯里化</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写分时函数" class="sidebar-link">手写分时函数</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写jsonp" class="sidebar-link">手写JSONP</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写new关键词方法" class="sidebar-link">手写new关键词方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写类extends关键词方法" class="sidebar-link">手写类extends关键词方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写object-create方法" class="sidebar-link">手写Object.create方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写数组降维flat方法" class="sidebar-link">手写数组降维flat方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写数组map方法" class="sidebar-link">手写数组map方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写数组reduce方法" class="sidebar-link">手写数组reduce方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写数组去重方法" class="sidebar-link">手写数组去重方法</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写基于发布-订阅的事件系统" class="sidebar-link">手写基于发布/订阅的事件系统</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写vue-数据响应式原理" class="sidebar-link">手写Vue 数据响应式原理</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#手写vue-nexttick方法" class="sidebar-link">手写Vue nextTick方法</a></li></ul></li><li><a href="/blog/interview/#浏览器相关基础面试题" class="sidebar-link">浏览器相关基础面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#事件机制" class="sidebar-link">事件机制</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#跨域" class="sidebar-link">跨域</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#浏览器存储" class="sidebar-link">浏览器存储</a></li></ul></li><li><a href="/blog/interview/#浏览器其他面试题" class="sidebar-link">浏览器其他面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#缓存机制" class="sidebar-link">缓存机制</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#渲染原理" class="sidebar-link">渲染原理</a></li></ul></li><li><a href="/blog/interview/#安全防范面试题" class="sidebar-link">安全防范面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#xss跨域脚本攻击" class="sidebar-link">XSS跨域脚本攻击</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#csp内容安全策略" class="sidebar-link">CSP内容安全策略</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#csrf跨域请求伪造" class="sidebar-link">CSRF跨域请求伪造</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#点击劫持" class="sidebar-link">点击劫持</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#中间人攻击" class="sidebar-link">中间人攻击</a></li></ul></li><li><a href="/blog/interview/#前端监控面试题" class="sidebar-link">前端监控面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#页面埋点" class="sidebar-link">页面埋点</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#性能监控" class="sidebar-link">性能监控</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#异常监控" class="sidebar-link">异常监控</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#错误上报" class="sidebar-link">错误上报</a></li></ul></li><li><a href="/blog/interview/#性能优化面试题" class="sidebar-link">性能优化面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#图片优化" class="sidebar-link">图片优化</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#函数节流和防抖" class="sidebar-link">函数节流和防抖</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#预解析、预加载和预渲染" class="sidebar-link">预解析、预加载和预渲染</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#cdn分布式缓存" class="sidebar-link">CDN分布式缓存</a></li></ul></li><li><a href="/blog/interview/#http相关面试题" class="sidebar-link">HTTP相关面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/interview/#tcp和udp" class="sidebar-link">TCP和UDP</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#http组成及tls" class="sidebar-link">HTTP组成及TLS</a></li><li class="sidebar-sub-header"><a href="/blog/interview/#http2-0和http3-0" class="sidebar-link">HTTP2.0和HTTP3.0</a></li></ul></li><li><a href="/blog/interview/#常见设计模式面试题" class="sidebar-link">常见设计模式面试题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/interview/#常见数据结构和算法面试题" class="sidebar-link">常见数据结构和算法面试题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/blog/interview/#vue相关面试题" class="sidebar-link">Vue相关面试题</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端面试之道"><a href="#前端面试之道" class="header-anchor">#</a> 前端面试之道</h1> <h2 id="javascript基础知识面试题"><a href="#javascript基础知识面试题" class="header-anchor">#</a> JavaScript基础知识面试题</h2> <h3 id="原始类型"><a href="#原始类型" class="header-anchor">#</a> 原始类型</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>JavaScript 中原始类型有六种，原始类型既只保存原始值，是没有函数可以调用的。</p></div> <h4 id="六种原始类型"><a href="#六种原始类型" class="header-anchor">#</a> 六种原始类型</h4> <ul><li>string</li> <li>number</li> <li>boolean</li> <li>null</li> <li>undefined</li> <li>symbol</li></ul> <div class="custom-block warning"><p class="custom-block-title">注意</p> <p>为什么说原始类型没有函数可以调用，但<code>'1'.toString()</code>却又可以在浏览器中正确执行？</p></div> <p>因为<code>'1'.toString()</code>中的字符串<code>'1'</code>在这个时候会被封装成其对应的字符串对象，以上代码相当于<code>new String('1').toString()</code>，因为<code>new String('1')</code>创建的是一个对象，而这个对象里是存在<code>toString()</code>方法的。</p> <h4 id="null到底是什么类型"><a href="#null到底是什么类型" class="header-anchor">#</a> null到底是什么类型</h4> <p>现在很多书籍把<code>null</code>解释成空对象，是一个对象类型。然而在早期<code>JavaScript</code>的版本中使用的是32位系统，考虑性能问题，使用低位存储变量的类型信息，<code>000</code>开头代表对象，而<code>null</code>就代表全零，所以将它错误的判断成<code>Object</code>，虽然后期内部判断代码已经改变，但<code>null</code>类型为<code>object</code>的判断却保留了下来，至于<code>null</code>具体是什么类型，属于仁者见仁智者见智，你说它是一个<code>bug</code>也好，说它是空对象，是对象类型也能理解的通。</p> <h3 id="对象类型"><a href="#对象类型" class="header-anchor">#</a> 对象类型</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>在 JavaScript 中，除了原始类型，其他的都是对象类型，对象类型存储的是地址，而原始类型存储的是值。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
a<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出[1]</span>
</code></pre></div><p>在以上代码中，创建了一个对象类型<code>a</code>(数组)，再把<code>a</code>的地址赋值给了变量<code>b</code>，最后改变<code>a</code>的值，打印<code>b</code>时，<code>b</code>的值也同步发生了改变，因为它们在内存中使用的是同一个地址，改变其中任何一变量的值，都会影响到其他变量。</p> <h4 id="对象当做函数参数"><a href="#对象当做函数参数" class="header-anchor">#</a> 对象当做函数参数</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">testPerson</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">52</span><span class="token punctuation">;</span>
  person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'李四'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> person<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token function">testPerson</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出52</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出18</span>
</code></pre></div><p><strong>代码分析</strong>：</p> <ol><li><code>testPerson</code>函数中，<code>person</code>传递的是对象<code>p1</code>的指针副本</li> <li>在函数内部，改变<code>person</code>的属性，会同步反映到对象<code>p1</code>上，<code>p1</code>对象中的<code>age</code>属性发生了改变，即值为52</li> <li><code>testPerson</code>函数又返回了一个新的对象，这个对象此时和参数<code>person</code>没有任何关系，因为它分配了一个新的内存地址</li> <li>以上分析可以用如下图表示</li></ol> <p><img src="/blog/assets/img/1.84a25f35.png" alt="对象当做函数参数图片"></p> <h3 id="typeof和instanceof"><a href="#typeof和instanceof" class="header-anchor">#</a> typeof和instanceof</h3> <h4 id="typeof"><a href="#typeof" class="header-anchor">#</a> typeof</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>typeof</code>能准确判断除<code>null</code>以外的原始类型的值，对于对象类型，除了函数会判断成<code>function</code>，其他对象类型一律返回<code>object</code></p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token number">1</span>          <span class="token comment">// number</span>
<span class="token keyword">typeof</span> <span class="token string">'1'</span>        <span class="token comment">// string</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span>       <span class="token comment">// boolean</span>
<span class="token keyword">typeof</span> <span class="token keyword">undefined</span>  <span class="token comment">// undefined</span>
<span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">// symbol</span>

<span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>         <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>         <span class="token comment">// object</span>
<span class="token keyword">typeof</span> console<span class="token punctuation">.</span>log<span class="token comment">// function</span>
</code></pre></div><h4 id="instanceof"><a href="#instanceof" class="header-anchor">#</a> instanceof</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>instanceof</code>通过原型链可以判断出对象的类型，但并不是百分百准确</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str <span class="token keyword">instanceof</span> <span class="token class-name">String</span><span class="token punctuation">)</span><span class="token comment">// true</span>
</code></pre></div><h3 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h3> <p><code>JavaScript</code>中，类型转换只有三种：</p> <ol><li>转换成数字</li> <li>转换成布尔值</li> <li>转换成字符串</li></ol> <h4 id="经典类型面试题"><a href="#经典类型面试题" class="header-anchor">#</a> 经典类型面试题</h4> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre></div><p><strong>代码分析</strong>：</p> <ol><li>左侧是一个对象(数组)</li> <li>右侧是一个布尔值，对象<code>[]</code>转换成布尔值<code>true</code>，因为除了<code>null</code>所有对象都转换成布尔值，所以<code>![]</code>结果为<code>false</code></li> <li>此时相当于<code>对象==布尔值</code>，依据类型转换规则，转换成数字类型进行比较</li> <li>对象(空数组)转换成<code>0</code>，布尔值<code>false</code>转换成<code>0</code></li> <li>即<code>0==0</code>，返回<code>true</code></li></ol> <p>类型转换规则，如下图：</p> <p><img src="/blog/assets/img/2.d470ad60.png" alt="类型转换规则"></p> <h3 id="和"><a href="#和" class="header-anchor">#</a> == 和 ===</h3> <p>如果你对上面的例子还一知半解，那么我们来详细介绍一下<code>==</code>和<code>===</code>的规则以及区别。</p> <h4 id="严格相等"><a href="#严格相等" class="header-anchor">#</a> ===严格相等</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>===</code>叫做严格相等，是指：左右两边不仅值要相等，类型也要相等，例如<code>'1'===1</code>的结果是<code>false</code>，因为一边是<code>string</code>，另一边是<code>number</code>。</p></div> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token operator">===</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出false</span>
</code></pre></div><h4 id="不严格相等"><a href="#不严格相等" class="header-anchor">#</a> ==不严格相等</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>==</code>不像<code>===</code>那样严格，对于一般情况，只要值相等，就返回<code>true</code>，但<code>==</code>还涉及一些类型转换，它的转换规则如下：</p> <ul><li>两边的类型是否相同，相同的话就比较值的大小，例如<code>1==2</code>，返回<code>false</code></li> <li>类型不相同会进行类型转换</li> <li>判断的是否是<code>null</code>和<code>undefined</code>，是的话就返回<code>true</code></li> <li>判断的类型是否是<code>String</code>和<code>Number</code>，是的话，把<code>String</code>类型转换成<code>Number</code>，再进行比较</li> <li>判断其中一方是否是<code>Boolean</code>，是的话就把<code>Boolean</code>转换成<code>Number</code>，再进行比较</li> <li>如果其中一方为<code>Object</code>，且另一方为<code>String</code>、<code>Number</code>或者<code>Symbol</code>，会将<code>Object</code>转换成原始类型后，再进行比较</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">}</span>
        ↓
<span class="token number">1</span> <span class="token operator">==</span> <span class="token string">'[object Object]'</span>
</code></pre></div><h4 id="转boolean"><a href="#转boolean" class="header-anchor">#</a> 转boolean</h4> <p>除了<code>undefined</code>、<code>null</code>、<code>false</code>、<code>0</code>、<code>-0</code>、<code>NaN</code>和空字符串转换成<code>false</code>以外，其他所有值都转换成<code>true</code>，包括所有对象。</p> <h4 id="对象转原始类型"><a href="#对象转原始类型" class="header-anchor">#</a> 对象转原始类型</h4> <p>对象转原始类型，会调用内置的[ToPrimitive]函数，对于该函数而言，其逻辑如下：</p> <ol><li>是否已经是原始类型，是则直接返回</li> <li>调用<code>valueOf()</code>，如果转换为原始类型，则返回</li> <li>调用<code>toString()</code>，如果转换为原始类型，则返回</li> <li>也可以重写<code>Symbol.toPrimitive()</code>方法，优先级别最高</li> <li>如果都没有返回原始类型，会报错</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'2'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">3</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出4</span>
</code></pre></div><h4 id="对象转原始类型应用"><a href="#对象转原始类型应用" class="header-anchor">#</a> 对象转原始类型应用</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 问：如何使if(a==1&amp;&amp;a==2&amp;&amp;a==3) {console.log('true')};正确打印'true'</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">==</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a<span class="token operator">==</span><span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'true'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出true</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>代码分析</strong>：</p> <ol><li>重写对象<code>a</code>的<code>valueOf()</code>方法，使<code>value</code>属性每次调用时自增</li> <li>当判断<code>a==1</code>时，第一次调用<code>valueOf()</code>方法，此时<code>value</code>等于1，判断<code>1==1</code>，继续向下走</li> <li>判断<code>a==2</code>时，第二次调用<code>valueOf()</code>方法，此时<code>value</code>等于2，判断<code>2==2</code>，继续向下走</li> <li>判断<code>a==3</code>时，第三次调用<code>valueOf()</code>方法，此时<code>value</code>等于3，判断<code>3==3</code>，<code>if</code>判断结束</li> <li><code>if</code>条件判断为<code>true &amp;&amp; true &amp;&amp; true</code>，执行<code>console.log('true')</code>，打印<code>true</code></li></ol> <h3 id="new构造调用的过程"><a href="#new构造调用的过程" class="header-anchor">#</a> new构造调用的过程</h3> <p>无论是通过字面量还是通过<code>new</code>进行构造函数调用创建出来的对象，其实都一样。调用<code>new</code>的过程如下：</p> <ol><li>创建一个新对象</li> <li>原型绑定</li> <li>绑定this到这个新对象上</li> <li>返回新对象</li></ol> <h3 id="this全解析"><a href="#this全解析" class="header-anchor">#</a> this全解析</h3> <p><code>JavaScript</code>中的<code>this</code>只有如下几种情况，并按他们的优先级从低到高划分如下：</p> <ol><li>独立函数调用，例如<code>getUserInfo()</code>，此时<code>this</code>指向全局对象<code>window</code></li> <li>对象调用，例如<code>stu.getStudentName()</code>，此时<code>this</code>指向调用的对象<code>stu</code></li> <li><code>call()</code>、<code>apply()</code>和<code>bind()</code>改变上下文的方法，<code>this</code>指向取决于这些方法的第一个参数，当第一个参数为<code>null</code>时，<code>this</code>指向全局对象<code>window</code></li> <li>箭头函数没有<code>this</code>，箭头函数里面的<code>this</code>只取决于包裹箭头函数的第一个普通函数的<code>this</code></li> <li><code>new</code>构造函数调用，<code>this</code>永远指向构造函数返回的实例上，优先级最高。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'global name'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj name'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">foo</span><span class="token operator">:</span> foo
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj1 name'</span>
<span class="token punctuation">}</span>

<span class="token comment">// 独立函数调用，输出：global name</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 对象调用，输出：obj name</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// apply()，输出：obj1 name</span>
obj<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// new 构造函数调用，输出：p1 name</span>
<span class="token keyword">var</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'p1 name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="this解析流程图"><a href="#this解析流程图" class="header-anchor">#</a> this解析流程图</h4> <p><img src="/blog/assets/img/3.4fd85c39.png" alt="this解析流程图"></p> <h3 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>当一个函数能够记住并访问它所在的词法作用域的时候，就产生了闭包，即使函数是在词法作用域之外执行</p></div> <h4 id="闭包的几种表现形式"><a href="#闭包的几种表现形式" class="header-anchor">#</a> 闭包的几种表现形式</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li>返回一个函数</li> <li>作为函数参数传递</li> <li>回调函数</li> <li>非典型闭包IIFE(立即执行函数表达式)</li></ol></div> <p><strong>返回一个函数</strong>：这种形式的闭包在<code>JavaScript</code>的代码编写中，是非常常见的一种方式。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a  <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token comment">// 这就是闭包</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> bar <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出2，而不是1</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>作为函数参数传递</strong>：无论通过何种手段将内部函数传递到它所在词法作用域之外，它都会持有对原始作用域的引用，无论在何处执行这个函数，都会产生闭包。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">bar</span><span class="token punctuation">(</span>baz<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 这就是闭包</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出2，而不是1</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>回调函数</strong>：在定时器、事件监听、Ajax请求、跨窗口通信、Web Workers或者任何异步中，只要使用了回调函数，实际上就是在使用闭包。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定时器</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timeHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>，<span class="token number">100</span><span class="token punctuation">)</span>

<span class="token comment">// 事件监听</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DOM Listener'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>IIFE</strong>：IIFE(立即执行函数表达式)并不是一个典型的闭包，但它确实创建了一个闭包。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token constant">IIFE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 输出2</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="经典循环和闭包面试题"><a href="#经典循环和闭包面试题" class="header-anchor">#</a> 经典循环和闭包面试题</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>以下代码运行结果是什么，如何改进？</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>代码分析</strong>：<br></p> <ol><li><code>for</code>循环创建了5个定时器，并且定时器是在循环结束后才开始执行</li> <li><code>for</code>循环结束后，用<code>var i</code>定义的变量<code>i</code>此时等于6</li> <li>依次执行五个定时器，都打印变量<code>i</code>，所以结果是打印5次6</li></ol> <p><strong>第一种改进方法</strong>：利用<code>IIFE(立即执行函数表达式)</code>当每次<code>for</code>循环时，把此时的<code>i</code>变量传递到定时器中</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>第二种方法</strong>：<code>setTimeout</code>函数的第三个参数，可以作为定时器执行时的变量进行使用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token parameter">j</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>第三种方法(推荐)</strong>：在循环中使用<code>let i</code>代替<code>var i</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">timer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="原型、原型链"><a href="#原型、原型链" class="header-anchor">#</a> 原型、原型链</h3> <p>撰写中......</p> <h3 id="浅拷贝、深拷贝"><a href="#浅拷贝、深拷贝" class="header-anchor">#</a> 浅拷贝、深拷贝</h3> <p>由于<code>JavaScript</code>中对象是引用类型，保存的是地址，深、浅拷贝的区别是，当拷贝结束后，在一定程度上改变原对象中的某一个引用类型属性的值，新拷贝出来的对象依然受影响的话，就是浅拷贝，反之就是深拷贝。</p> <h4 id="浅拷贝的几种实现方法"><a href="#浅拷贝的几种实现方法" class="header-anchor">#</a> 浅拷贝的几种实现方法</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li>利用<code>Object.assign()</code>方法</li> <li>利用<code>...</code>扩展运算符</li></ol></div> <p><strong>第一种方法：</strong> <code>Object.assign()</code>会拷贝原始对象中的所有属性到一个新对象上，如果属性为对象，则拷贝的是对象的地址，改变对象中的属性值，新拷贝出来的对象依然会受影响。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isStudent</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">money</span><span class="token operator">:</span> <span class="token number">12</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> newObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出张三</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 输出23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出21，受影响</span>
</code></pre></div><p><strong>第二种方法：</strong><code>...</code>扩展运算符是<code>ES6</code>新增加的内容</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isStudent</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>obj<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出张三</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 输出23</span>
</code></pre></div><h4 id="深拷贝几种实现方式"><a href="#深拷贝几种实现方式" class="header-anchor">#</a> 深拷贝几种实现方式</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li>配合使用<code>JSON.parse()</code>和<code>JSON.stringify()</code>两个函数(局限性比较大)</li> <li>实现自己的简易深拷贝方法</li> <li><code>lodash</code>第三方库实现深拷贝</li></ol></div> <p><strong>第一种方法：</strong> 利用<code>JSON</code>的序列化和反序列化方法，可以实现简易对象深拷贝，但此种方法有较大的限制：<br></p> <ol><li>会忽略属性值为<code>undefined</code>的属性</li> <li>会忽略属性为<code>Symbol</code>的属性</li> <li>不会序列化函数</li> <li>不能解决循环引用的问题，直接报错</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayHello</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isStudent</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">money</span><span class="token operator">:</span> <span class="token number">12</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 输出张三</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 输出23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出12</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 报错</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 报错</span>
</code></pre></div><p><strong>第二种：</strong> 实现自己简易的深拷贝函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">deepClone</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">isObject</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">typeof</span> o <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> o <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'非对象'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> isArray <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> newObj <span class="token operator">=</span> isArray <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span>obj<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span>obj<span class="token punctuation">}</span><span class="token punctuation">;</span>
  Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">money</span><span class="token operator">:</span> <span class="token number">12000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> cloneObj <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">13000</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出13000</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出12000</span>
</code></pre></div><p><strong>第三种方法：</strong> 使用<a href="https://lodash.com/docs#cloneDeep" target="_blank" rel="noopener noreferrer">lodash<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>第三方函数库实现(需要先引入lodash.js)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'张三'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">isStudent</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">money</span><span class="token operator">:</span> <span class="token number">12</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> newObj <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出张三</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">// 输出23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出12，不受影响</span>
</code></pre></div><h3 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h3> <p>在<code>JavaScript</code>ES6之前，实现继承需要依赖原型、原型链和构造函数等等技术手段组合使用，在ES6之后，可以使用<code>Class</code>类继承(并没有真正的类，只是一个语法糖，实质依然是函数)</p> <div class="custom-block tip"><p class="custom-block-title">继承的几种方式</p> <ol><li>原型链实现继承</li> <li>借用构造函数实现继承</li> <li>组合继承</li> <li>寄生组合继承</li> <li>类继承</li></ol></div> <h4 id="原型链实现继承"><a href="#原型链实现继承" class="header-anchor">#</a> 原型链实现继承</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>通过重写子类的原型，并将它指向父类的手段实现。这种方式实现的继承，创建出来的实例既是子类的实例，又是父类的实例。它有如下几种缺陷：</p> <ol><li>不能向父类构造函数传参</li> <li>父类上的引用类型属性会被所有实例共享，其中一个实例改变时，会影响其他实例</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> dog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'旺财'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dog2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'钢镚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dog2<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;yellow&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;yellow&quot;]</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1 <span class="token keyword">instanceof</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1 <span class="token keyword">instanceof</span> <span class="token class-name">Animal</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>
</code></pre></div><h4 id="借用构造函数实现继承"><a href="#借用构造函数实现继承" class="header-anchor">#</a> 借用构造函数实现继承</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>借用构造函数实现继承，通过在子类中使用<code>call()</code>方法，实现借用父类构造函数并向父类构造函数传参的目的。但这种方法，无法继承父类原型对象上的属性和方法。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' is eating!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Animal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> dog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'旺财'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dog2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'钢镚'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dog2<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [&quot;red&quot;, &quot;blue&quot;, &quot;yellow&quot;]</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1 <span class="token keyword">instanceof</span> <span class="token class-name">Dog</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2 <span class="token keyword">instanceof</span> <span class="token class-name">Animal</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// false</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
</code></pre></div><h4 id="组合继承"><a href="#组合继承" class="header-anchor">#</a> 组合继承</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>组合继承是组合了原型链继承和借用构造函数继承这两种方法，它保留了两种继承方式的优点，但它并不是百分百完美的：</p> <ul><li>父类构造函数被调用多次。</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' is eatting'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Animal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 第一次调用</span>
<span class="token keyword">var</span> dog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 第二次调用</span>
<span class="token keyword">var</span> dog2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 第三次调用</span>
dog1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出dog1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出['red','blue']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出dog2 is eatting</span>
</code></pre></div><h4 id="寄生组合继承"><a href="#寄生组合继承" class="header-anchor">#</a> 寄生组合继承</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>寄生组合继承是在组合继承的基础上，采用<code>Object.create()</code>方法来改造实现</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">eat</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' is eatting'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Dog</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">Animal</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">Animal</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Dog</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Dog<span class="token punctuation">;</span>
<span class="token keyword">var</span> dog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dog2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dog1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出dog1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出['red','blue']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出dog2 is eatting</span>
</code></pre></div><h4 id="class实现继承"><a href="#class实现继承" class="header-anchor">#</a> Class实现继承</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>运用ES6 class新特性来实现继承</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">' is eatting'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> dog1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> dog2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dog</span><span class="token punctuation">(</span><span class="token string">'dog2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dog1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'yellow'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出dog1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出['red','blue']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dog2<span class="token punctuation">.</span><span class="token function">eat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出dog2 is eatting</span>
</code></pre></div><h3 id="es6"><a href="#es6" class="header-anchor">#</a> ES6</h3> <p>本章节只介绍ES6常考知识点，更多基础知识请直接跳转至<a href="/blog/books/javascript/know-down.html">你不知道的JavaScript(中)</a></p> <h4 id="var、let和const的区别"><a href="#var、let和const的区别" class="header-anchor">#</a> var、let和const的区别</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li><code>var</code>声明的变量会提升到作用域的顶部，而<code>let</code>和<code>const</code>不会进行提升</li> <li><code>var</code>声明的全局变量会被挂载到全局<code>window</code>对象上，而<code>let</code>和<code>const</code>不会</li> <li><code>var</code>可以重复声明同一个变量，而<code>let</code>和<code>const</code>不会</li> <li><code>var</code>声明的变量作用域范围是函数作用域，而<code>let</code>和<code>const</code>声明的变量作用域范围是块级作用域。</li> <li><code>const</code>声明的常量，一旦声明则不能再次赋值，再次赋值会报错(更改对象属性不会，因为对象地址没有变)</li></ol></div> <p><strong>作用域提升：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 报错</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.1415</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>挂载到全局变量：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.1415</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出abc</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出undefined</span>
</code></pre></div><p><strong>重复声明变量：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a<span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出abc</span>

<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b<span class="token punctuation">;</span><span class="token comment">// 报错</span>
</code></pre></div><p><strong>变量的作用域范围：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'abc'</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token string">'ABC'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出abc</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出ABC</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出abc</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>const常量：</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.1415</span><span class="token punctuation">;</span>
<span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.1415926</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
</code></pre></div><h4 id="扩展-收缩符"><a href="#扩展-收缩符" class="header-anchor">#</a> 扩展/收缩符</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>ES6新增加的运算符<code>...</code>，称为扩展或者收缩，具体作用取决于到底如何使用。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ...的扩展</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出1,2,3</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token operator">...</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// 扩展数组：ES6写法</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 扩展数组：ES5写法</span>


<span class="token comment">// ...的收缩</span>
<span class="token comment">// 1.收集参数：ES6写法</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 输出[1,2,3,4,5]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2.收集参数：ES5写法</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出[1,2,3,4,5]</span>
<span class="token punctuation">}</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="解构赋值"><a href="#解构赋值" class="header-anchor">#</a> 解构赋值</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>常用的解构赋值，有如下两种情况：<br></p> <ol><li>对象的解构</li> <li>数组的解构</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 常用解构方式:解构对象 or 解构数组</span>

<span class="token comment">// ES6之前的获取返回数组和返回对象的方式</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token constant">X</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token constant">Y</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token constant">Z</span><span class="token operator">:</span> <span class="token number">6</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token constant">X</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token constant">Y</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> z <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token constant">Z</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出1,2,3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出4,5,6</span>

<span class="token comment">// ES6之后获取返回数组和返回对象的方式</span>
<span class="token keyword">var</span> <span class="token punctuation">[</span><span class="token constant">A</span><span class="token punctuation">,</span><span class="token constant">B</span><span class="token punctuation">,</span><span class="token constant">C</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token punctuation">{</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">Y</span><span class="token punctuation">,</span><span class="token constant">Z</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">A</span><span class="token punctuation">,</span><span class="token constant">B</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出1,2,3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">,</span><span class="token constant">Y</span><span class="token punctuation">,</span><span class="token constant">Z</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出4,5,6</span>
</code></pre></div><h4 id="字符串模板"><a href="#字符串模板" class="header-anchor">#</a> 字符串模板</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>${内容}</code>：字符串模板里的内容可以是变量、函数调用以及表达式。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 字符串模板</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">'why'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> address <span class="token operator">=</span> <span class="token string">'广州'</span><span class="token punctuation">;</span>

<span class="token comment">// ES5拼接字符串</span>
<span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'我叫：'</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">',我的年龄是：'</span><span class="token operator">+</span>age<span class="token operator">+</span><span class="token string">',我的地址是：'</span><span class="token operator">+</span>address<span class="token punctuation">;</span>

<span class="token comment">// ES6模板字符串</span>
<span class="token keyword">var</span> newStr <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">我叫：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,我的年龄是：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,我的地址是：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>address<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出:我叫：why,我的年龄是：23，我的地址是：广州</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newStr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出:我叫：why,我的年龄是：23，我的地址是：广州</span>
</code></pre></div><h4 id="map和set结构"><a href="#map和set结构" class="header-anchor">#</a> map和set结构</h4> <p><strong>Map结构：</strong> 对象是创建无序键值对数据结构映射的主要机制，在ES6之前，对象的属性只能是字符串，在ES6之后，<code>Map</code>结构允许使用对象、数组等作为键。<code>Map</code>结构的方法或者属性如下：</p> <ul><li><code>set()</code>：新增一个map结构的数据</li> <li><code>get(key)</code>：根据键获取值</li> <li><code>size</code>：获取map结构的长度</li> <li><code>delete(key)</code>：根据指定的键删除</li> <li><code>has(key)</code>：判断指定的键是否存在于map结构中</li> <li><code>keys()</code>遍历，<code>values()</code>遍历，<code>entries()</code>键值对遍历</li> <li><code>clear()</code>清空map结构</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Map结构</span>
<span class="token keyword">var</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    y <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 设置map数据</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>y<span class="token punctuation">,</span><span class="token string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取map数据</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出bar</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出foo</span>

<span class="token comment">// 获取map结构的长度</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 输出2</span>

<span class="token comment">// 根据指定键删除map数据</span>
map<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 根据指定的键判断是否存在于map结构中</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出false</span>

<span class="token comment">// 遍历map键</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment">// 输出{id:2}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历map值</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> value <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出foo</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历map键值对</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 输出y</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 输出{id:2}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Set结构：</strong> <code>Set</code>是一个集合，它里面的值是唯一的，重复添加会被忽略(<code>Set</code>结构不允许强制类型转换，<code>1</code>和<code>&quot;1&quot;</code>被认为是两个不同的值)。<code>Set</code>结构的方法和属性如下： <br></p> <ul><li><code>add()</code>：添加新值</li> <li><code>size</code>：获取<code>Set</code>结构的长度</li> <li><code>delete()</code>：根据指定的键删除</li> <li><code>has()</code>：判断指定的键是否存在<code>Set</code>集合中</li> <li><code>keys()</code>遍历、<code>values()</code>遍历、<code>entries()</code>遍历</li> <li><code>clear()</code>：清空<code>Set</code>结构</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Set结构</span>
<span class="token keyword">var</span> set <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token comment">// 添加Set数据</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
set<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取Set数据的长度</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 输出5</span>

<span class="token comment">// 删除Set数据</span>
set<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 判断某个值是否存在Set结构中</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>set<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 输出false</span>

<span class="token comment">// 遍历Set的键</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">of</span> set<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// 输出{id：1} {id:2} 1 &quot;1&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历Set的值</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> value <span class="token keyword">of</span> set<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">// 输出{id:1} {id:2} 1 &quot;1&quot;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 遍历Set的键值对</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> item <span class="token keyword">of</span> set<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 {id:1} {id:2} 1 &quot;1&quot;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 {id:1} {id:2} 1 &quot;1&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Set结构的扩展运用：</strong> 数组去重、并集、交集、差集</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Set集合的运用：数组的去重、并集、交集、差集</span>
<span class="token keyword">var</span> arr1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 去重：输出1,2,3,4,5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 并集：输出1,2,3,4,5,6,7</span>
<span class="token keyword">var</span> union <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span><span class="token operator">...</span>arr2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>union<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// 交集：输出4,5</span>
<span class="token keyword">var</span> intec <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> arr2<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>intec<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 差集</span>
<span class="token keyword">var</span> diff1 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>arr2<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> diff2 <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr2<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>arr1<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>diff1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 输出：1,2,3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>diff2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 输出：6,7</span>
</code></pre></div><h4 id="proxy能干什么"><a href="#proxy能干什么" class="header-anchor">#</a> Proxy能干什么</h4> <p>在<code>Vue2.0+</code>的版本中，<code>Vue</code>使用<code>Object.definedProperty()</code>方法来实现数据的响应式，在<code>Vue3.0</code>的开发计划中，作者计划使用ES6新增加的<code>Proxy</code>代理来实现数据的响应式，它相比于<code>Object.definedProperty()</code>有如下几个特点： <br></p> <ol><li><code>Proxy</code>可以一次性为所有属性实现代理，无需遍历，性能更佳</li> <li><code>Proxy</code>能监听到以前使用<code>Object.definedProperty()</code>监听不到的数据变动。</li> <li>由于是ES6新增加的特性，所以浏览器兼容性方面比<code>Object.definedProperty()差</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token function-variable function">onWatch</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span>setBind<span class="token punctuation">,</span> getLogger</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">getLogger</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">,</span> receiver<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setBind</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> property<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> property<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> p <span class="token operator">=</span> <span class="token function">onWatch</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">属性的改变，其值为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> property</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">监听到获取属性</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>property<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,其值为</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token comment">// 监听到a属性的改变，其值为2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 监听到获取属性a,其值为2</span>
</code></pre></div><h4 id="数组的map、filter和reduce的区别"><a href="#数组的map、filter和reduce的区别" class="header-anchor">#</a> 数组的map、filter和reduce的区别</h4> <p><strong>map：</strong> <code>map</code>方法的作用是生成一个新数组(把原数组中的所有元素做一些变动，放进新数组中)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">v</span> <span class="token operator">=&gt;</span> v<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出[2,4,6];</span>
</code></pre></div><p><strong>filter：</strong> <code>filter</code>方法的作用是从原数组中过滤出符合条件的元素，并生成一个新数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> newArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出[2,4,6];</span>
</code></pre></div><p><strong>reduce：</strong> <code>reduce</code>方法的作用是通过回调函数的形式，把原数组中的元素最终转换成一个值，第一个参数是回调函数，第二个参数是初始值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">account<span class="token punctuation">,</span> current</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> account <span class="token operator">+</span> current<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 21</span>
</code></pre></div><h3 id="javascript异步"><a href="#javascript异步" class="header-anchor">#</a> JavaScript异步</h3> <h4 id="并发和并行"><a href="#并发和并行" class="header-anchor">#</a> 并发和并行</h4> <p>并行和并发是两个概念，容易混淆是因为并行和并发在中文意思上相近，其实在英文中，这是完全不相同的东西，并行(parallelism)、并发(concurrency)</p> <div class="custom-block tip"><p class="custom-block-title">概念理解</p> <p>并行(parallelism)：是微观概念，假设CPU有两个核心，则我们就可以同时完成任务A和任务B，同时完成多个任务的情况就可以称之为并行。<br>
并发(concurrency)：是宏观概念，现在有任务A和任务B，在一段时间内，通过任务之间的切换完成这两个任务，这种情况称之为并发。</p></div> <h4 id="回调函数"><a href="#回调函数" class="header-anchor">#</a> 回调函数</h4> <p>回调函数广泛存在于我们所编写的<code>JavaScript</code>代码中，它表现在事件绑定，Ajax请求或者其他的情况下，一个回调函数可表现成如下形式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>回调地狱：</strong> 回调函数很好的解决了某些异步情况，但过度滥用回调函数会造成回调地狱，即回调函数过长，嵌套过深。过长或者嵌套过深的回调函数，会让回调函数存在强耦合关系，一旦有一个函数有所改动，那么可能会牵一发而动全身。一个回调地狱可能如下所示：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ajax</span><span class="token punctuation">(</span>firstUrl<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是首次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">ajax</span><span class="token punctuation">(</span>secondUrl<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第二次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ajax</span><span class="token punctuation">(</span>threeUrl<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第三次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// todo更多</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="generator"><a href="#generator" class="header-anchor">#</a> Generator</h4> <p>在ES6之前，一个函数一旦执行将不会被中断，一直到函数执行完毕，在ES6之后，由于<code>Generator</code>的存在，函数可以暂停自身，待到合适的机会再次执行。用<code>Generator</code>可以解决回调地狱。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token operator">*</span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是首次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第二次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第三次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> it <span class="token operator">=</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result1 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result2 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> result3 <span class="token operator">=</span> it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="promise"><a href="#promise" class="header-anchor">#</a> Promise</h4> <p><code>Promise</code>翻译过来就是承诺的意思，<code>Promise</code>一共有三种状态：<code>pending(等待中)</code>、<code>resolve(完成)</code>和<code>reject(拒绝)</code>，这个承诺意味着在将来一定会有一个表决，并且只能表决一次，表决的状态一定是<code>resolve(完成)</code>或者<code>reject(拒绝)</code>，一个<code>Promise</code>可能会是如下的形式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通的Promise</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第一次表决有效，其后无论是resolve()还是reject()都无效</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// Promise解决回调地狱</span>
<span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是首次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第二次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'这里是第三次回调函数'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Promise.all()：</strong> <code>Promise.all()</code>方法是把一个或者几个<code>Promise</code>组合在一个数组里，只有当数组中的所有<code>Promise</code>全部表决完成，才返回。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span>p2<span class="token punctuation">,</span>p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出[1,2,3]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>Promise.race()：</strong> <code>Promise.race()</code>方法把一个或者几个<code>Promise</code>组合在一个数组里，只要数组中有一个表决了，就返回。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> p3 <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p2<span class="token punctuation">,</span>p1<span class="token punctuation">,</span>p3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="async-await"><a href="#async-await" class="header-anchor">#</a> async/await</h4> <p>如果一个方法前面加上了<code>async</code>，那么这个方法就会返回一个<code>Promise</code>，<code>async</code>就是将函数用<code>Promise.resolve()</code>包裹了下，并且<code>await</code>只能配合<code>async</code>使用，不能单独出现。一个<code>async/await</code>可能会是如下的形式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通的async/await</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// await自动用promise.resolve()包装</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// async/await解决回调地狱</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> result1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> result2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> result3 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">ajax</span><span class="token punctuation">(</span>url3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">fetch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="setinterval、settimeout和requestanimationframe"><a href="#setinterval、settimeout和requestanimationframe" class="header-anchor">#</a> setInterval、setTimeout和requestAnimationFrame</h4> <p><strong>setTimeout</strong> <code>setTimeout</code>延时执行某一段代码，但<code>setTimeout</code>由于<code>EventLoop</code>的存在，并不百分百是准时的，一个<code>setTimeout</code>可能会表示如下的形式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 延时1s之后，打印hello,world</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello,world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>setInterval：</strong> <code>setInterval</code>在指定的时间内，重复执行一段代码，与<code>setTimeout</code>类似，它也不是准时的，并且有时候及其不推荐使用<code>setInterval</code>定时器，因为它与某些耗时的代码配合使用的话，会存在执行积累的问题，它会等耗时操作结束后，一起一个或者多个执行定时器，存在性能问题。一个<code>setInterval</code>可能会表示如下的形式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello,world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>requestAnimationFrame：</strong> 翻译过来就是请求动画帧，它是html5专门用来设计请求动画的API，它与<code>setTimeout</code>相比有如下优势：</p> <ol><li>根据不同屏幕的刷新频率，自动调整执行回调函数的时机。</li> <li>当窗口处于未激活状态时，<code>requestAnimationFrame</code>会停止执行，而<code>setTimeout</code>不会</li> <li>自带函数节流功能</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> progress <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  progress <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>progress <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">//第一帧渲染</span>
window<span class="token punctuation">.</span><span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="eventloop事件循环"><a href="#eventloop事件循环" class="header-anchor">#</a> EventLoop事件循环</h3> <h4 id="进程和线程"><a href="#进程和线程" class="header-anchor">#</a> 进程和线程</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>JavaScript</code>是单线程执行的，在<code>JavaScript</code>运行期间，有可能会阻塞UI渲染，这在一方面说明<code>JavaScript</code>引擎线程和UI渲染线程是互斥的。<code>JavaScript</code>被设计成单线程的原因在于，<code>JavaScript</code>可以修改DOM，如果在<code>JavaScript</code>工作期间，UI还在渲染的话，则可能不会正确渲染DOM。单线程也有一些好处，如下：</p> <ol><li>节省内存空间</li> <li>节省上下文切换时间</li> <li>没有锁的问题存在</li></ol></div> <p><strong>进程：</strong> CPU在运行指令及加载和保存上下文所需的时间，放在应用上一个程序就是一个进程，一个浏览器tab选项卡就是一个进程 <br> <strong>线程：</strong> 线程是进程中更小的单位，描述了执行一段指令所需的时间。</p> <h4 id="执行栈"><a href="#执行栈" class="header-anchor">#</a> 执行栈</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>可以把执行栈看成是一个存储函数调用的栈结构，遵循先进后出的原则，一个执行栈可能表现如下：</p></div> <p><img src="/blog/assets/img/5.2d2f74f2.gif" alt="执行栈"></p> <h4 id="eventloop"><a href="#eventloop" class="header-anchor">#</a> EventLoop</h4> <p>上面讲到函数会在执行栈中执行，那么当遇到异步代码后，该如何处理呢？其实当遇到异步代码的时候，会被挂起在Task队列中，一旦执行栈为空，就会从Task中拿出需要执行的代码执行，所以本质上讲JS中的异步还是同步行为。</p> <p><img src="/blog/assets/img/6.c4905935.png" alt="EventLoop">
如上图，可以看到，不同的异步任务是有区别的，异步任务又可以划分如下：</p> <ol><li>宏任务(<code>script</code>、<code>setTimeout</code>、<code>setInterval</code>、<code>setImmidiate</code>、<code>I/O</code>、<code>UI Rendering</code>)可以有多个队列</li> <li>微任务(<code>procress.nextTick</code>、<code>Promise.then</code>、<code>Object.observe</code>、<code>mutataionObserver</code>)只能有一个队列</li></ol> <p><strong>执行顺序：</strong> 当执行栈执行完毕后，会首先执行微任务队列，当微任务队列执行完毕再从宏任务中读取并执行，当再次遇到微任务时，放入微任务队列。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 输出结果：5 4 1 2 3</span>
</code></pre></div><p><strong>代码分析：</strong></p> <ol><li><code>console.log(5)</code>是唯一的同步任务，首先执行，输出5</li> <li>将所有异步任务放在Task队列中，挂起</li> <li>同步任务执行完毕，开始执行微任务队列，即<code>Promise.then</code>，输出4</li> <li>微任务队列执行完毕，执行宏任务队列<code>setTimeout</code></li> <li>宏任务队列中首先执行同步任务，再次遇到微任务，放入微任务队列中，输出1</li> <li>同步任务执行完毕，执行微任务队列，输出2</li> <li>微任务队列执行完毕，执行宏任务队列<code>setTimeout</code>，输出3</li></ol> <h2 id="javascript进阶面试题"><a href="#javascript进阶面试题" class="header-anchor">#</a> JavaScript进阶面试题</h2> <h3 id="手写getquerystring"><a href="#手写getquerystring" class="header-anchor">#</a> 手写getQueryString</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>给定一段URL和参数的名称，获取此参数的值</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/s?id=123&amp;name=why&amp;phone=13876769797'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> strs <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> index <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">undefined</span>
  <span class="token punctuation">}</span>
  strs <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> strs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> splitItem <span class="token operator">=</span> strs<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>splitItem<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> splitItem<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 测试：输出why</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getQueryString</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h3 id="手写自己的setinterval"><a href="#手写自己的setinterval" class="header-anchor">#</a> 手写自己的setInterval</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>用<code>requestAnimationFrame</code>实现自己的<code>setInterval</code>方法</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">timer</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  <span class="token function-variable function">setInterval</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> interval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span>now
    <span class="token keyword">let</span> startTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> endTime <span class="token operator">=</span> startTime
    <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">const</span> <span class="token function-variable function">loop</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      self<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>loop<span class="token punctuation">)</span>
      endTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>endTime <span class="token operator">-</span> startTime <span class="token operator">&gt;=</span> interval<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        startTime <span class="token operator">=</span> endTime <span class="token operator">=</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>loop<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>timer
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">clearInterval</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">const</span> timer <span class="token operator">=</span> obj<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'interval...'</span><span class="token punctuation">)</span>
  count<span class="token operator">++</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    obj<span class="token punctuation">.</span><span class="token function">clearInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> 
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写call、apply和bind方法"><a href="#手写call、apply和bind方法" class="header-anchor">#</a> 手写call、apply和bind方法</h3> <h4 id="手写call"><a href="#手写call" class="header-anchor">#</a> 手写Call</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myCall</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'not a function'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> symbolFn <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  context <span class="token operator">=</span> context <span class="token operator">||</span> window
  context<span class="token punctuation">[</span>symbolFn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> context<span class="token punctuation">[</span>symbolFn<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">[</span>symbolFn<span class="token punctuation">]</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'obj'</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
foo<span class="token punctuation">.</span><span class="token function">myCall</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// obj</span>
</code></pre></div><h4 id="手写apply"><a href="#手写apply" class="header-anchor">#</a> 手写apply</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myApply</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  context <span class="token operator">=</span> context <span class="token operator">||</span> window<span class="token punctuation">;</span>
  context<span class="token punctuation">.</span>fn <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> result <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">?</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">:</span> context<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">delete</span> context<span class="token punctuation">.</span>fn<span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">101</span>
<span class="token punctuation">}</span>
foo<span class="token punctuation">.</span><span class="token function">myApply</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出101</span>
</code></pre></div><h4 id="手写bind"><a href="#手写bind" class="header-anchor">#</a> 手写bind</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myBind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span> <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token function">TypeError</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">self</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">121</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> newFunc <span class="token operator">=</span> foo<span class="token punctuation">.</span><span class="token function">myBind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">newFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出121</span>
</code></pre></div><h3 id="手写promise"><a href="#手写promise" class="header-anchor">#</a> 手写Promise</h3> <p><strong>简易Promise：</strong> 简易<code>Promise</code>并不完全符合<code>Promise/A+</code>规范，但面试时能写出简易<code>Promise</code>算是已经过关了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// promise三个状态：pending(等待)、resolved(完成)、rejected(拒绝)</span>
<span class="token keyword">const</span> <span class="token constant">PENDING</span> <span class="token operator">=</span> <span class="token string">'pending'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">RESOLVED</span> <span class="token operator">=</span> <span class="token string">'resolved'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">REJECTED</span> <span class="token operator">=</span> <span class="token string">'rejected'</span><span class="token punctuation">;</span>
<span class="token comment">// 简易Promise</span>
<span class="token keyword">function</span> <span class="token function">MyPromise</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">PENDING</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>resolvedCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  self<span class="token punctuation">.</span>rejectedCallbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 完成方法</span>
  <span class="token keyword">function</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state<span class="token operator">===</span><span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">RESOLVED</span><span class="token punctuation">;</span>
      self<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      self<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 拒绝方法</span>
  <span class="token keyword">function</span> <span class="token function">reject</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token constant">REJECTED</span><span class="token punctuation">;</span>
      self<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      self<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">cb</span> <span class="token operator">=&gt;</span> <span class="token function">cb</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 执行传入的方法</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// then方法</span>
<span class="token class-name">MyPromise</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">then</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">success<span class="token punctuation">,</span> error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  success <span class="token operator">=</span> <span class="token keyword">typeof</span> success <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token parameter">v</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  error <span class="token operator">=</span> <span class="token keyword">typeof</span> error <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">?</span> <span class="token function-variable function">error</span> <span class="token operator">:</span> <span class="token parameter">r</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> r<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">PENDING</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    self<span class="token punctuation">.</span>resolvedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span><span class="token punctuation">;</span>
    self<span class="token punctuation">.</span>rejectedCallbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">RESOLVED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">success</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token constant">REJECTED</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">error</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 执行自定义Promise</span>
<span class="token keyword">new</span> <span class="token class-name">MyPromise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写函数节流"><a href="#手写函数节流" class="header-anchor">#</a> 手写函数节流</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>函数节流：将原本1秒可能执行10次的函数，节流成1秒只执行2次-3次，有许多函数需要节流，例如：<br></p> <ol><li><code>window.onresize</code>事件</li> <li><code>mouseover</code>事件</li> <li><code>scroll</code>事件</li> <li>其他事件</li></ol></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">throttle</span> <span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> interval <span class="token operator">=</span> <span class="token number">500</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token keyword">let</span> firstTime <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments
    <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>firstTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      firstTime <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> interval<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 运用</span>
window<span class="token punctuation">.</span>onresize <span class="token operator">=</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'window onresize'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写函数防抖"><a href="#手写函数防抖" class="header-anchor">#</a> 手写函数防抖</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>函数防抖：函数防抖的核心思路是利用<code>setTimeout</code>延迟执行某个方法，只有在指定的事件后才执行，中间触发的事件不执行。最常见的函数防抖就是，搜索框只有用户在输入完毕后才去服务器执行查询。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token operator">...</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay <span class="token operator">||</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span>onresize <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'window onresize end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写instanceof"><a href="#手写instanceof" class="header-anchor">#</a> 手写instanceof</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>instanceof</code>原理是在对象原型链中是否能找到执行类型的<code>prototype</code></p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myInstanceOf</span> <span class="token punctuation">(</span><span class="token parameter">left<span class="token punctuation">,</span> right</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> left <span class="token operator">!==</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>left<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> right<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    left <span class="token operator">=</span> left<span class="token punctuation">.</span>__proto__
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'AAA'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myInstanceOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> Person<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myInstanceOf</span><span class="token punctuation">(</span>p1<span class="token punctuation">,</span> Object<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span>     <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span>     <span class="token comment">// true</span>
</code></pre></div><h3 id="手写简易深拷贝"><a href="#手写简易深拷贝" class="header-anchor">#</a> 手写简易深拷贝</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>案例只实现了简易的深拷贝函数，工作中推荐使用<code>lodash</code>的深拷贝方法。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isObject</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">deepClone</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> isArray <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
  <span class="token keyword">const</span> newObj <span class="token operator">=</span> isArray <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">:</span> value
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> newObj
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">colors</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">salary</span><span class="token operator">:</span> <span class="token number">200</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'funciton'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> cloneObj <span class="token operator">=</span> <span class="token function">deepClone</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>colors<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>job<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>job<span class="token punctuation">)</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'UI'</span>
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>salary <span class="token operator">=</span> <span class="token number">300</span>
obj<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
obj<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>colors<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneObj<span class="token punctuation">.</span>job<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>job<span class="token punctuation">)</span>
cloneObj<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写对象属性值迭代器"><a href="#手写对象属性值迭代器" class="header-anchor">#</a> 手写对象属性值迭代器</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>自定义对象属性值迭代器，使之能使用<code>for of</code>循环遍历对象属性的值</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">'广州'</span>
<span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">writable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">done</span><span class="token operator">:</span> index <span class="token operator">&gt;=</span> keys<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
          <span class="token literal-property property">value</span><span class="token operator">:</span> self<span class="token punctuation">[</span>keys<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> val <span class="token keyword">of</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">属性值为：</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="手写图片懒加载"><a href="#手写图片懒加载" class="header-anchor">#</a> 手写图片懒加载</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>图片懒加载是一种常用的技术，如果直接给某个img标签设置src属性，由于图片过大或者网络不佳，图片的位置会出现一片空白，图片懒加载就是使用一个<code>loading</code>图片来进行站位，等真正的图片加载完毕后再显示出来。</p></div> <h4 id="不使用代理模式实现图片懒加载"><a href="#不使用代理模式实现图片懒加载" class="header-anchor">#</a> 不使用代理模式实现图片懒加载</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> loadingSrc <span class="token operator">=</span> <span class="token string">'https://www.imooc.com/static/img/index/logo2020.png'</span>
<span class="token keyword">const</span> imgSrc <span class="token operator">=</span> <span class="token string">'https://img1.sycdn.imooc.com/5c09123400014ba418720632.jpg'</span>
<span class="token keyword">const</span> myImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> imgNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgNode<span class="token punctuation">)</span>
  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> img<span class="token punctuation">.</span>src
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> loadingSrc
      img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>imgSrc<span class="token punctuation">)</span>
</code></pre></div><h4 id="使用代理模式实现图片懒加载"><a href="#使用代理模式实现图片懒加载" class="header-anchor">#</a> 使用代理模式实现图片懒加载</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> loadingSrc <span class="token operator">=</span> <span class="token string">'https://www.imooc.com/static/img/index/logo2020.png'</span>
<span class="token keyword">const</span> imgSrc <span class="token operator">=</span> <span class="token string">'https://img1.sycdn.imooc.com/5c09123400014ba418720632.jpg'</span>
<span class="token keyword">const</span> myImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> imgNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgNode<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      imgNode<span class="token punctuation">.</span>src <span class="token operator">=</span> src
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> proxyImage <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>img<span class="token punctuation">.</span>src<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">setSrc</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      myImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>loadingSrc<span class="token punctuation">)</span>
      img<span class="token punctuation">.</span>src <span class="token operator">=</span> src
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
proxyImage<span class="token punctuation">.</span><span class="token function">setSrc</span><span class="token punctuation">(</span>imgSrc<span class="token punctuation">)</span>
</code></pre></div><h3 id="手写事件委托"><a href="#手写事件委托" class="header-anchor">#</a> 手写事件委托</h3> <div class="custom-block tip"><p class="custom-block-title">题目</p> <p>循环创建10个li标签，当点击li标签时，打印其对应的索引</p></div> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">loadNode</span><span class="token punctuation">(</span><span class="token parameter">len</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    html <span class="token operator">+=</span> <span class="token string">'&lt;li&gt;'</span><span class="token operator">+</span>index<span class="token operator">+</span><span class="token string">'&lt;/li&gt;'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  list<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event <span class="token operator">=</span> event <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>
    <span class="token keyword">var</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token operator">||</span> event<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>innerText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  list<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">loadNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写原生ajax请求"><a href="#手写原生ajax请求" class="header-anchor">#</a> 手写原生Ajax请求</h3> <div class="custom-block tip"><p class="custom-block-title">原生ajax步骤</p> <ol><li>创建<code>XMLHttpRequest</code>对象</li> <li>使用<code>open</code>方法设置和服务器的交互信息</li> <li>使用<code>send</code>发送数据</li> <li>注册事件</li></ol></div> <h4 id="get请求"><a href="#get请求" class="header-anchor">#</a> get请求</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span><span class="token string">'https://www.baidu.com/getUserInfo?name=AAA&amp;age=18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="post请求"><a href="#post请求" class="header-anchor">#</a> post请求</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">'Content-type'</span><span class="token punctuation">,</span> <span class="token string">'application/x-www-form-urlencoded'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'post'</span><span class="token punctuation">,</span><span class="token string">'https://www.baidu.com/getUserInfo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'name=AAA&amp;age=18'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span><span class="token number">4</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status<span class="token operator">==</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'请求成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="手写函数aop"><a href="#手写函数aop" class="header-anchor">#</a> 手写函数AOP</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>AOP(面向切面编程)的主要作用是把一些跟核心业务逻辑模块无关的功能抽离出来，这些跟业务逻辑无关的功能通常包括日志统计，安全控制，异常处理等。把这些功能抽离出来后，再通过动态织入的方式掺入业务逻辑模块中</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">before</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">beforeFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">beforeFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments
    <span class="token function">beforeFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">after</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">afterFn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">afterFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> args <span class="token operator">=</span> arguments
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token function">afterFn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">func</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> newFunc <span class="token operator">=</span> func<span class="token punctuation">.</span><span class="token function">before</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">newFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 1 2 3</span>
</code></pre></div><h3 id="手写柯里化"><a href="#手写柯里化" class="header-anchor">#</a> 手写柯里化</h3> <p><strong>柯里化</strong>：又称部分求值，一个柯里化参数首先会接受一些参数，接受这些参数之后，该函数并不会立即求值，而是继续返回另外一个函数，刚才传入的参数在函数形成的闭包中被保存起来，待到合适的时机一起求值。<br></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通用的柯里化</span>
<span class="token keyword">var</span> <span class="token function-variable function">currying</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> cost <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">var</span> money <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      money <span class="token operator">+=</span>arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> money<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> cost <span class="token operator">=</span> <span class="token function">currying</span><span class="token punctuation">(</span>cost<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">cost</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">cost</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">cost</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">cost</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">cost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出330</span>
</code></pre></div><h3 id="手写分时函数"><a href="#手写分时函数" class="header-anchor">#</a> 手写分时函数</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>分时函数案例：把1秒创建1000个DOM节点，改成每隔200毫秒创建10个节点，这样不用短时间在页面中创建大量的DOM。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">timeChunk</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span>fn<span class="token punctuation">,</span>count<span class="token punctuation">,</span>interval</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> <span class="token function-variable function">start</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>count <span class="token operator">||</span> <span class="token number">1</span> <span class="token punctuation">,</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> interval <span class="token operator">||</span> <span class="token number">200</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span> <span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> renderDOMList <span class="token operator">=</span> <span class="token function">timeChunk</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> data<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">renderDOMList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="手写jsonp"><a href="#手写jsonp" class="header-anchor">#</a> 手写JSONP</h3> <div class="custom-block tip"><p class="custom-block-title">原理</p> <p>JSONP实现跨域的原理是利用<code>script</code>标签没有跨域限制，通过<code>src</code>指向一个<code>ajax</code>的URL，最后跟一个回调函数<code>callback</code></p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">JSONP</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cbName <span class="token operator">=</span> <span class="token string">'callback_'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> queryString <span class="token operator">=</span> <span class="token function">normalizeParams</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token keyword">const</span> hasIndex <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span>
  url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hasIndex <span class="token operator">?</span> url <span class="token operator">:</span> url <span class="token operator">+</span> <span class="token string">'?'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>queryString<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;jsoncallback=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cbName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url
  window<span class="token punctuation">[</span>cbName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">normalizeParams</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index <span class="token operator">?</span> <span class="token string">'&amp;'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">'广东'</span>
<span class="token punctuation">}</span>
<span class="token constant">JSONP</span><span class="token punctuation">(</span><span class="token string">'https://www.runoob.com/try/ajax/jsonp.php'</span><span class="token punctuation">,</span> params<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="手写new关键词方法"><a href="#手写new关键词方法" class="header-anchor">#</a> 手写new关键词方法</h3> <p><code>new</code>关键词调用构造函数的过程如下：</p> <ol><li>创建一个空对象，这个对象讲会作为执行构造函数执行之后返回对象的实例。</li> <li>将空对象的<code>__proto__</code>指向构造函数的<code>prototype</code>。</li> <li>将这个空对象赋值给构造函数内部的<code>this</code>，并执行构造函数。</li> <li>根据构造函数的逻辑，返回第一步创建的对象或者构造函数显示的返回值。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myNew</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.获取构造函数</span>
  <span class="token keyword">const</span> constructor <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 2.创建空对象并设置原型</span>
  <span class="token keyword">const</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  <span class="token comment">// 3.绑定this并执行构造函数</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
  <span class="token comment">// 4.返回构造函数显示返回的值或新对象</span>
  <span class="token keyword">return</span> <span class="token function">isObject</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">?</span> result <span class="token operator">:</span> obj
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">isObject</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span>
<span class="token punctuation">}</span>
<span class="token comment">// 案例一</span>
<span class="token keyword">function</span> <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>
<span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token function">myNew</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">'AAA'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span>   <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>                <span class="token comment">// AAA</span>

<span class="token comment">// 案例二</span>
<span class="token keyword">function</span> <span class="token function">Student</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> stu <span class="token operator">=</span> <span class="token function">myNew</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> <span class="token string">'BBB'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu <span class="token keyword">instanceof</span> <span class="token class-name">Student</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>stu<span class="token punctuation">)</span> 
</code></pre></div><h3 id="手写类extends关键词方法"><a href="#手写类extends关键词方法" class="header-anchor">#</a> 手写类extends关键词方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">inherit</span> <span class="token punctuation">(</span><span class="token parameter">child<span class="token punctuation">,</span> parent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1.继承父类原型上的属性</span>
  child<span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>parent<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
  <span class="token comment">// 2.修复子类的构造函数</span>
  child<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> child
  <span class="token comment">// 3.存储父类</span>
  child<span class="token punctuation">.</span>super <span class="token operator">=</span> parent
  <span class="token comment">// 4.继承静态属性</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span>setPrototypeOf<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> parent<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    child<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> parent
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>parent<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>k <span class="token keyword">in</span> child<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        child<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> parent<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 父类</span>
<span class="token keyword">function</span> <span class="token function">Parent</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>parentColors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">Parent</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
Parent<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 子类</span>
<span class="token keyword">function</span> <span class="token function">Child</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
  <span class="token keyword">this</span><span class="token punctuation">.</span>childColors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承</span>
<span class="token function">inherit</span><span class="token punctuation">(</span>Child<span class="token punctuation">,</span> Parent<span class="token punctuation">)</span>

<span class="token comment">// test</span>
<span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token string">'child1'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">)</span>  <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>              <span class="token comment">// child1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>childColors<span class="token punctuation">)</span>       <span class="token comment">// ['green']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child1<span class="token punctuation">.</span>parentColors<span class="token punctuation">)</span>      <span class="token comment">// undefined</span>

<span class="token keyword">const</span> child2 <span class="token operator">=</span> Child<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">'child2'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2 <span class="token keyword">instanceof</span> <span class="token class-name">Child</span><span class="token punctuation">)</span>  <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2 <span class="token keyword">instanceof</span> <span class="token class-name">Parent</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>name<span class="token punctuation">)</span>              <span class="token comment">// child2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>childColors<span class="token punctuation">)</span>       <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>child2<span class="token punctuation">.</span>parentColors<span class="token punctuation">)</span>      <span class="token comment">// ['red']</span>
</code></pre></div><h3 id="手写object-create方法"><a href="#手写object-create方法" class="header-anchor">#</a> 手写Object.create方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">create</span> <span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> properties</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> strType <span class="token operator">=</span> <span class="token keyword">typeof</span> obj
  <span class="token keyword">const</span> isObject <span class="token operator">=</span> strType <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">||</span> strType <span class="token operator">===</span> <span class="token string">'function'</span>
  <span class="token keyword">const</span> isUndefined <span class="token operator">=</span> strType <span class="token operator">===</span> <span class="token string">'undefined'</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isUndefined <span class="token operator">||</span> <span class="token operator">!</span>isObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Object prototype may only be an Object or null'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 设置原型</span>
  <span class="token keyword">function</span> <span class="token constant">F</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> obj
  <span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// 兼容第二个参数</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>properties <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> properties <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> properties<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 兼容null</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> myObj1 <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'广东'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originObj1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'广东'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myObj1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token comment">// 23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myObj1<span class="token punctuation">.</span>address<span class="token punctuation">)</span>     <span class="token comment">// 广东</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originObj1<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token comment">// 23</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originObj1<span class="token punctuation">.</span>address<span class="token punctuation">)</span> <span class="token comment">// 广东</span>

<span class="token keyword">const</span> myObj2 <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originObj2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'toString'</span> <span class="token keyword">in</span> myObj2<span class="token punctuation">)</span>     <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'toString'</span> <span class="token keyword">in</span> originObj2<span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><h3 id="手写数组降维flat方法"><a href="#手写数组降维flat方法" class="header-anchor">#</a> 手写数组降维flat方法</h3> <p>原生<code>Array.prototype.flat</code>方法接受一个<code>depth</code>参数，默认值为<code>1</code>，<code>depth</code>表示要降维的维数：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token comment">// [1, 2, 3, 4, [5, 6]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// [1, 2, 3, 4, 5, 6]</span>
</code></pre></div><h4 id="reduce-递归实现方案"><a href="#reduce-递归实现方案" class="header-anchor">#</a> reduce + 递归实现方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: 可查看更多flat实现方法</span>
<span class="token keyword">function</span> <span class="token function">flat</span> <span class="token punctuation">(</span><span class="token parameter">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> depth <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>depth <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> acc<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">flat</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> depth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult1 <span class="token operator">=</span> <span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult1 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> myResult2 <span class="token operator">=</span> <span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">Infinity</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult1<span class="token punctuation">)</span>      <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult1<span class="token punctuation">)</span>  <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult2 <span class="token punctuation">)</span>     <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult2 <span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
</code></pre></div><h4 id="foreach-递归实现方案"><a href="#foreach-递归实现方案" class="header-anchor">#</a> forEach + 递归实现方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: 可查看更多flat实现方法</span>
<span class="token keyword">function</span> <span class="token function">flat</span> <span class="token punctuation">(</span><span class="token parameter">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> depth <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 注意：立即执行函书前的语句必须要有分号</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">flatFunc</span><span class="token punctuation">(</span><span class="token parameter">arr<span class="token punctuation">,</span> depth</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> depth <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">flatFunc</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> depth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> depth<span class="token punctuation">)</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult1 <span class="token operator">=</span> <span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult1 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> myResult2 <span class="token operator">=</span> <span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">Infinity</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult1<span class="token punctuation">)</span>      <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult1<span class="token punctuation">)</span>  <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult2 <span class="token punctuation">)</span>     <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult2 <span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
</code></pre></div><h4 id="generator方案"><a href="#generator方案" class="header-anchor">#</a> generator方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: 可查看更多flat实现方法</span>
<span class="token keyword">function</span> <span class="token operator">*</span> <span class="token function">flat</span> <span class="token punctuation">(</span><span class="token parameter">arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> depth <span class="token operator">=</span> <span class="token number">1</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> depth <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> <span class="token operator">*</span> <span class="token function">flat</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> depth <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">yield</span> item
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> originResult1 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> myResult2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token function">flat</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">Infinity</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> originResult2 <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">flat</span><span class="token punctuation">(</span><span class="token number">Infinity</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult1<span class="token punctuation">)</span>      <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult1<span class="token punctuation">)</span>  <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, [2, 3, 4]]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult2 <span class="token punctuation">)</span>     <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult2 <span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span>
</code></pre></div><h3 id="手写数组map方法"><a href="#手写数组map方法" class="header-anchor">#</a> 手写数组map方法</h3> <p><code>map</code>方法接受两个参数，其中第二个参数为<code>callback</code>回调函数执行时的<code>this</code>。</p> <h4 id="while循环方案"><a href="#while循环方案" class="header-anchor">#</a> while循环方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: Array.prototype.map</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myMap</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'this is null or not defined'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>callback<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a function</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> thisArg <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token operator">?</span> arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token keyword">undefined</span>
  <span class="token keyword">const</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> value<span class="token punctuation">,</span> mapValue
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token keyword">in</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> arr<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
      mapValue <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thisArg<span class="token punctuation">,</span> value<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr<span class="token punctuation">)</span>
      result<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> mapValue
    <span class="token punctuation">}</span>
    index<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">myMap</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult<span class="token punctuation">)</span>     <span class="token comment">// [2, 3, 4, empty, 5]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult<span class="token punctuation">)</span> <span class="token comment">// [2, 3, 4, empty, 5]</span>
</code></pre></div><h4 id="reduce方案"><a href="#reduce方案" class="header-anchor">#</a> reduce方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: Array.prototype.reduce</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myMap</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    acc<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> cur<span class="token punctuation">,</span> index<span class="token punctuation">,</span> array<span class="token punctuation">)</span>
    <span class="token keyword">return</span> acc
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">myMap</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=&gt;</span> value <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult<span class="token punctuation">)</span>     <span class="token comment">// [2, 3, 4, empty, 5]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult<span class="token punctuation">)</span> <span class="token comment">// [2, 3, 4, empty, 5]</span>
</code></pre></div><h3 id="手写数组reduce方法"><a href="#手写数组reduce方法" class="header-anchor">#</a> 手写数组reduce方法</h3> <p>此小节先介绍<code>reduce</code>方法的实现，再介绍基于<code>reduce</code>方法的两个经典案例。</p> <h4 id="reduce实现"><a href="#reduce实现" class="header-anchor">#</a> reduce实现</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// MDN: Array.prototype.reduce</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">myReduce</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> initialValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Array.prototype.reduce called on null or undefined'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> callback <span class="token operator">!==</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>callback<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not a function</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> array <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> len <span class="token operator">=</span> array<span class="token punctuation">.</span>length <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span>
  <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">let</span> result
  <span class="token comment">// 处理初始值</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> initialValue
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// example: [,,,,5]</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>index <span class="token operator">&lt;</span> len <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token punctuation">(</span>index <span class="token keyword">in</span> array<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      index<span class="token operator">++</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;=</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Reduce of empty array with no initial value'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    value <span class="token operator">=</span> array<span class="token punctuation">[</span>index<span class="token operator">++</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>index <span class="token operator">&lt;</span> len<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token keyword">in</span> array<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      result <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> array<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> array<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    index<span class="token operator">++</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token keyword">const</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> myResult <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">myReduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> cur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> originResult <span class="token operator">=</span> array<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> acc <span class="token operator">+</span> cur<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myResult<span class="token punctuation">)</span>     <span class="token comment">// 11</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originResult<span class="token punctuation">)</span> <span class="token comment">// 11</span>
</code></pre></div><h4 id="基于reduce顺序执行promise"><a href="#基于reduce顺序执行promise" class="header-anchor">#</a> 基于reduce顺序执行promise</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">p1</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>val <span class="token operator">*</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">p2</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>val <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">p3</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> val <span class="token operator">*</span> <span class="token number">3</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">runPromiseInSequence</span> <span class="token punctuation">(</span><span class="token parameter">promiseArr<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> promiseArr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">promiseChain<span class="token punctuation">,</span> currentFunc</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> promiseChain<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>currentFunc<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> promiseArr <span class="token operator">=</span> <span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span>
<span class="token function">runPromiseInSequence</span><span class="token punctuation">(</span>promiseArr<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>console<span class="token punctuation">.</span>log<span class="token punctuation">)</span> <span class="token comment">// 6</span>
</code></pre></div><h4 id="基于reduce实现管道函数pie"><a href="#基于reduce实现管道函数pie" class="header-anchor">#</a> 基于reduce实现管道函数pie</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// pie顺序执行每一个参数函数</span>
<span class="token keyword">const</span> <span class="token function-variable function">pieFunc1</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">const</span> <span class="token function-variable function">pieFunc2</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">2</span>
<span class="token keyword">const</span> <span class="token function-variable function">pieFunc3</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=&gt;</span> x <span class="token operator">+</span> <span class="token number">3</span>
<span class="token keyword">function</span> <span class="token function">pie</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> funcArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> funcArr<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      acc <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>acc<span class="token punctuation">)</span>
      <span class="token keyword">return</span> acc
    <span class="token punctuation">}</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> func1 <span class="token operator">=</span> <span class="token function">pie</span><span class="token punctuation">(</span>pieFunc1<span class="token punctuation">,</span> pieFunc2<span class="token punctuation">)</span>
<span class="token keyword">const</span> func2 <span class="token operator">=</span> <span class="token function">pie</span><span class="token punctuation">(</span>pieFunc1<span class="token punctuation">,</span> pieFunc3<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   <span class="token comment">// 3</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// 14</span>
</code></pre></div><h3 id="手写数组去重方法"><a href="#手写数组去重方法" class="header-anchor">#</a> 手写数组去重方法</h3> <p>数组去重有很多种方法，这里只介绍两种：<code>Set</code>结构去重和<code>reduce</code>方法去重。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义变量</span>
<span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> uniqueArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment">// 1.Set结构去重</span>
uniqueArr <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uniqueArr<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>

<span class="token comment">// 2.reduce方法去重</span>
<span class="token keyword">function</span> <span class="token function">deDuplicationArray</span> <span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>array <span class="token operator">||</span> array<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> array<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">acc<span class="token punctuation">,</span> cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>acc<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      acc<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cur<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> acc
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
uniqueArr <span class="token operator">=</span> <span class="token function">deDuplicationArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>uniqueArr<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, 4, 5]</span>
</code></pre></div><h3 id="手写基于发布-订阅的事件系统"><a href="#手写基于发布-订阅的事件系统" class="header-anchor">#</a> 手写基于发布/订阅的事件系统</h3> <p>事件系统包括如下几个方法：</p> <ol><li><code>on</code>监听事件方法。</li> <li><code>off</code>取消监听事件方法。</li> <li><code>emit</code>触发事件方法。</li> <li><code>once</code>绑定一次事件监听方法。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">invokeCallback</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> context<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'invoke callback error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> event <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">subs</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">on</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> event<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>event<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">off</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1、一个参数都没有，解绑全部</span>
    <span class="token comment">// 2、只传event，解绑改event所有事件</span>
    <span class="token comment">// 3、两个参数都传递，只移除指定某一个</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> event<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span>event<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> cbs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cbs <span class="token operator">||</span> cbs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">let</span> cb
    <span class="token keyword">let</span> i <span class="token operator">=</span> cbs<span class="token punctuation">.</span>length
    <span class="token keyword">while</span><span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cb <span class="token operator">=</span> cbs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>cb <span class="token operator">===</span> callback <span class="token operator">||</span> cb<span class="token punctuation">.</span>fn <span class="token operator">===</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cbs<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">once</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> self <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">function</span> <span class="token function">on</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      self<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> on<span class="token punctuation">)</span>
      <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> on<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">emit</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> cbs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">[</span>event<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cbs <span class="token operator">&amp;&amp;</span> cbs<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> cbs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">invokeCallback</span><span class="token punctuation">(</span>cbs<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">speakCallback1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'speak callback1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">speakCallback2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'speak callback2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">combineCallback</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'write or listen callback'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">runningCallback1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'running callback1'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">runningCallback2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'running callback2'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">,</span> speakCallback1<span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">,</span> speakCallback2<span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'write'</span><span class="token punctuation">,</span> <span class="token string">'listen'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> combineCallback<span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'running'</span><span class="token punctuation">,</span> runningCallback1<span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">'running'</span><span class="token punctuation">,</span> runningCallback2<span class="token punctuation">)</span>

event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">)</span>   <span class="token comment">// speak callback1, speak callback2</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'running'</span><span class="token punctuation">)</span> <span class="token comment">// running callback1</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'running'</span><span class="token punctuation">)</span> <span class="token comment">// running callback2</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'write'</span><span class="token punctuation">)</span>   <span class="token comment">// write or listen callback</span>

event<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">,</span> speakCallback1<span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'write'</span><span class="token punctuation">,</span> <span class="token string">'listen'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">)</span>   <span class="token comment">// speak callback2</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'write'</span><span class="token punctuation">)</span>   <span class="token comment">//</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'listen'</span><span class="token punctuation">)</span>  <span class="token comment">// </span>

event<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'speak'</span><span class="token punctuation">)</span>   <span class="token comment">// </span>
event<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'running'</span><span class="token punctuation">)</span> <span class="token comment">//</span>
</code></pre></div><h3 id="手写vue-数据响应式原理"><a href="#手写vue-数据响应式原理" class="header-anchor">#</a> 手写Vue 数据响应式原理</h3> <h4 id="object-defineproperty方案"><a href="#object-defineproperty方案" class="header-anchor">#</a> Object.defineProperty方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">observe</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">defineReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">defineReactive</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get value'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> val
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      val <span class="token operator">=</span> newVal
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'change value'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">salary</span><span class="token operator">:</span> <span class="token number">1000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">observe</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> obj<span class="token punctuation">.</span>name
obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'BBB'</span>
<span class="token keyword">const</span> jobName <span class="token operator">=</span> obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>name
obj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'fe'</span>
</code></pre></div><h4 id="proxy方案"><a href="#proxy方案" class="header-anchor">#</a> Proxy方案</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">observe</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> handler <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> val <span class="token operator">=</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> val <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get value'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'change value'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> Reflect<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'AAA'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">,</span>
  <span class="token literal-property property">job</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'FE'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">salary</span><span class="token operator">:</span> <span class="token number">1000</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> proxyObj <span class="token operator">=</span> <span class="token function">observe</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
<span class="token keyword">const</span> name <span class="token operator">=</span> proxyObj<span class="token punctuation">.</span>name
proxyObj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'BBB'</span>
<span class="token keyword">const</span> jobName <span class="token operator">=</span> proxyObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>name
proxyObj<span class="token punctuation">.</span>job<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'fe'</span>
</code></pre></div><h3 id="手写vue-nexttick方法"><a href="#手写vue-nexttick方法" class="header-anchor">#</a> 手写Vue nextTick方法</h3> <p><code>nextTick</code>支持两种形式使用方式：</p> <ol><li>回调函数形式。</li> <li>如果当前环节支持<code>Promise</code>，还支持<code>Promise.then</code>的形式。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// callback形式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Promise.then形式</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>基于<code>Vue</code>源码，<code>nextTick</code>手写代码如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> pending <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token keyword">let</span> timeFunc
<span class="token keyword">const</span> callbacks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">function</span> <span class="token function">flushCallbacks</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  pending <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token keyword">const</span> cbs <span class="token operator">=</span> callbacks<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  callbacks<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> cbs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cbs<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">invokeCallback</span> <span class="token punctuation">(</span><span class="token parameter">callback<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'invoke nextTick callback error'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">nextTick</span> <span class="token punctuation">(</span><span class="token parameter">cb<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context <span class="token operator">=</span> context <span class="token operator">||</span> window
  <span class="token keyword">let</span> _resolve
  callbacks<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">invokeCallback</span><span class="token punctuation">(</span>cb<span class="token punctuation">,</span> context<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>_resolve<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">_resolve</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>pending<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pending <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token function">timeFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cb <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      _resolve <span class="token operator">=</span> resolve
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setTimeFunc</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> p <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function-variable function">timeFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      p<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> MutationObserver <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> number <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
    <span class="token keyword">const</span> textNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">)</span>
    observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>textNode<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">characterData</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function-variable function">timeFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      number <span class="token operator">=</span> <span class="token punctuation">(</span>number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>
      textNode<span class="token punctuation">.</span>data <span class="token operator">=</span> number
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> setImmediate <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">timeFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setImmediate</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">timeFunc</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>flushCallbacks<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">setTimeFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick callback'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick promise'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="浏览器相关基础面试题"><a href="#浏览器相关基础面试题" class="header-anchor">#</a> 浏览器相关基础面试题</h2> <h3 id="事件机制"><a href="#事件机制" class="header-anchor">#</a> 事件机制</h3> <h4 id="注册事件"><a href="#注册事件" class="header-anchor">#</a> 注册事件</h4> <p>注册事件，我们一般使用<code>addEventListener(name, callback, boolean)</code>函数，该函数支持三个参数，参数说明如下：</p> <ol><li><code>name</code>：代表待注册事件的名字，例如：<code>click</code>或者<code>mouseover</code></li> <li><code>callback</code>：代表注册事件的回调函数</li> <li><code>boolean</code>：一个<code>boolean</code>值，为<code>true</code>代表事件捕获时触发，为<code>false</code>时代表事件冒泡时触发。参数缺省时默认为<code>false</code></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一个注册事件的案例</span>
<span class="token comment">// 点击DOM元素时。顺序打印出：捕获时触发 冒泡时触发</span>
<span class="token keyword">var</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'捕获时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'冒泡时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="事件触发顺序"><a href="#事件触发顺序" class="header-anchor">#</a> 事件触发顺序</h4> <p>在浏览器中，事件的触发顺序一般而言依据：<strong>捕获</strong>-&gt;<strong>目标阶段</strong>-&gt;<strong>冒泡</strong>三个顺序。但事件的触发顺序并不总是按以上顺序执行，当我们给同一个DOM元素同时注册捕获和冒泡事件时，事件的触发顺序是按你注册事件的顺序来执行的。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 点击DOM元素时。顺序打印出：冒泡时触发 捕获时触发</span>
<span class="token keyword">var</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'冒泡时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'捕获时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>阻止事件冒泡：</strong> <code>stopPropagation()</code>和<code>stopImmediaPropagation()</code>方法都能阻止事件的向上冒泡，但这两者是有区别的：<code>stopImmediaPropagation()</code>还能阻止目标执行别的注册事件。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 阻止事件冒泡</span>
<span class="token comment">// 1. 当不阻止冒泡时，window的click会触发</span>
<span class="token comment">// 2. 当使用stopPropagation()时，window的click不会被触发</span>
<span class="token comment">// 3. 当使用stopImmediatePropagation()时，DOM的捕获事件不会触发，window的click不会触发</span>
<span class="token keyword">var</span> box <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'冒泡时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// event.stopPropagation();</span>
  <span class="token comment">// event.stopImmediatePropagation();</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
box<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'捕获时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'子元素点击事件向上冒泡时触发'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="跨域"><a href="#跨域" class="header-anchor">#</a> 跨域</h3> <div class="custom-block tip"><p class="custom-block-title">同源策略</p> <p>同源策略是指，一个源的客户端脚本在没有明确授权的情况下，不能访问另一个源的客户端脚本。当一个URL和另一个URL，只要<strong>协议</strong>、<strong>域名</strong>或者<strong>端口号</strong>有一个不同，则就会出现跨域。
解决跨域常用方法有：</p> <ol><li>JSONP</li> <li>CORS</li> <li>document.domain</li> <li>postMessage</li></ol></div> <h4 id="jsonp实现跨域"><a href="#jsonp实现跨域" class="header-anchor">#</a> JSONP实现跨域</h4> <div class="custom-block tip"><p class="custom-block-title">原理</p> <p>JSONP实现跨域的原理是利用<code>script</code>标签没有跨域限制，通过<code>src</code>指向一个<code>ajax</code>的URL，最后跟一个回调函数<code>callback</code></p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 一个JSONP跨域的案例</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;http://www.baidu.com/getUserInfo?name=张三&amp;callback=jsonp&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token keyword">function</span> <span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'JSONP实现跨域'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 实现自己的JSONP</span>
<span class="token keyword">var</span> <span class="token function-variable function">jsonp</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> cbName <span class="token operator">=</span> <span class="token string">'callback_'</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> queryString <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">?</span> <span class="token string">'?'</span> <span class="token operator">:</span> <span class="token string">'&amp;'</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    queryString <span class="token operator">+=</span> k <span class="token operator">+</span> <span class="token string">'='</span> <span class="token operator">+</span> data<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&amp;'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  queryString <span class="token operator">+=</span> <span class="token string">'callback='</span> <span class="token operator">+</span> cbName<span class="token punctuation">;</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url <span class="token operator">+</span> queryString<span class="token punctuation">;</span>
  window<span class="token punctuation">[</span>cbName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">callback</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 实测</span>
<span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token string">'http://api.douban.com/v2/movie/in_theaters'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">'count'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="cors实现跨域"><a href="#cors实现跨域" class="header-anchor">#</a> CORS实现跨域</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>CORS：<code>CORS</code>需要浏览器和后端同时配合才能生效，后端通过设置<code>Access-Control-Allow-Origin</code>就可以开启哪些域名可以使用<code>CORS</code>跨域，在进行<code>CORS</code>跨域请求时，会出现简单请求或者复杂请求。</p></div> <p><strong>CORS简单请求</strong>：当请求方式为<code>get</code>，<code>head</code>、<code>post</code>之一并且<code>Content-Type</code>为<code>text/plain</code>、<code>multipart/form-data</code>、<code>application/x-www-form-urlencoded</code>三种之一时，就是简单请求。</p> <p><strong>CORS复杂请求：</strong> 当不符合简单请求时，就是复杂请求，对于复杂请求来说，首先会发送一个<code>option</code>请求，用于知道服务器是否允许跨域请求。</p> <h4 id="document-domain实现跨域"><a href="#document-domain实现跨域" class="header-anchor">#</a> document.domain实现跨域</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>document.domain只能用于<strong>二级域名相同</strong>的情况下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 域名a.test.com 和域名b.test.com</span>
<span class="token comment">// 设置如下代码后，二级域名为test.com的网站都能实现跨域</span>
document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'test.com'</span>
</code></pre></div></div> <h4 id="postmessage"><a href="#postmessage" class="header-anchor">#</a> postMessage</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p><code>postMessage</code>一般用于获取嵌套在页面中的第三方页面的数据，一个页面发送请求，另外一个页面判断来源并接受请求。</p></div> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://www.baidu.com<span class="token punctuation">&quot;</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 父页面发送请求</span>
window<span class="token punctuation">.</span>frames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'getcolor'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 父页面接受请求</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印red</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 子页面发送请求</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="浏览器存储"><a href="#浏览器存储" class="header-anchor">#</a> 浏览器存储</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>浏览器存储有如下四种方法，每种方法都有不同支持，具体特性请参考表格</p> <ol><li>cookie</li> <li>localStorage</li> <li>sessionStorage</li> <li>indexDB</li></ol></div> <p><img src="/blog/assets/img/4.d4f3ac84.png" alt="浏览器存储四种方法"></p> <h4 id="cookie"><a href="#cookie" class="header-anchor">#</a> Cookie</h4> <p><strong>设置cookie</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token parameter">cname<span class="token punctuation">,</span> cvalue<span class="token punctuation">,</span> exdays</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  d<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>exdays<span class="token operator">*</span><span class="token number">24</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> expires <span class="token operator">=</span> <span class="token string">&quot;expires=&quot;</span><span class="token operator">+</span>d<span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> cname <span class="token operator">+</span> <span class="token string">&quot;=&quot;</span> <span class="token operator">+</span> cvalue <span class="token operator">+</span> <span class="token string">&quot;; &quot;</span> <span class="token operator">+</span> expires<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'why'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>获取cookie</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> arr<span class="token punctuation">,</span> reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(^| )&quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;=([^;]*)(;|$)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arr <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>reg<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">unescape</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'why'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印why</span>
</code></pre></div><h4 id="localstorage-和-sessionstorage"><a href="#localstorage-和-sessionstorage" class="header-anchor">#</a> localStorage 和 sessionStorage</h4> <p><strong>设置localStorage和sessionStorage</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'why'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>获取localStorage和sessionStorage</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token string">'why'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 打印why</span>
sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 打印23</span>
</code></pre></div><h4 id="service-worker"><a href="#service-worker" class="header-anchor">#</a> service worker</h4> <p><code>Service Worker</code>是运行在浏览器背后的独立进程，一般可以用来实现缓存功能，实现<code>Service Worker</code>的话，必须使用https传输协议，一个实现<code>Service Worker</code>缓存<code>js</code>文件可以如下写</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'./1.js'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">success</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'注册成功'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">error</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'注册失败'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="浏览器其他面试题"><a href="#浏览器其他面试题" class="header-anchor">#</a> 浏览器其他面试题</h2> <p>一个浏览器数据请求会经历三个步骤：<strong>发起网络请求</strong>、<strong>后端处理</strong>、<strong>浏览器响应</strong>。浏览器缓存可以让我们在第一步和第三步中优化性能。</p> <h3 id="缓存机制"><a href="#缓存机制" class="header-anchor">#</a> 缓存机制</h3> <h4 id="缓存位置"><a href="#缓存位置" class="header-anchor">#</a> 缓存位置</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>缓存在不同的位置，它的优先级是不同的，缓存按优先级可以划分为：</p> <ol><li>Service Worker可以让我们自由控制应该缓存哪些文件(PWA实现的重要手段)</li> <li>Memory Cache(内存缓存)内存缓存读取效率高，但一旦我们关闭了浏览器，内存缓存也就没有了。</li> <li>Disk Cache(硬盘缓存)与内存缓存相比，硬盘缓存具有量大以及时效的两大优点。</li> <li>Push Cache当前三者缓存都没有命中时，才会读取Push Cache中的缓存信息，但此种方式的缓存信息时间较短，只在会话<code>Session</code>中存在，一旦会话结束也就释放了。</li> <li>当以上缓存都没有命中时，才会发起请求。</li></ol></div> <h4 id="缓存策略"><a href="#缓存策略" class="header-anchor">#</a> 缓存策略</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>通常来说，浏览器缓存策略分为两种：<strong>强缓存</strong>和<strong>协商缓存</strong>，缓存策略可通过HTTP Header来实现。</p></div> <p><strong>强缓存：</strong> 强缓存可以通过设置<code>Expires</code>和<code>Cache-Control</code>来实现，强缓存表示在缓存期间，不需要请求，<code>State Code</code>为200，<code>Cache-Control</code>可以组合使用多个指令，常见指令如下所示：</p> <p><img src="/blog/assets/img/7.0456b875.png" alt="缓存指令"></p> <p><strong>协商缓存：</strong> 协商缓存表示如果缓存过期了，那么就需要重新发起请求验证资源是否有更新，可通过设置HTTP Header的<code>Last-Modified</code>和<code>ETag</code>来实现，如果资源没有改变，<code>State Code</code>为304</p> <h3 id="渲染原理"><a href="#渲染原理" class="header-anchor">#</a> 渲染原理</h3> <h4 id="dom树"><a href="#dom树" class="header-anchor">#</a> DOM树</h4> <p>浏览器在接受到服务器传递回来的字节流数据后，会经过转换，把<code>0</code>和<code>1</code>的字节流数据转换成DOM树结构，会经历如下图所示的过程：</p> <p><img src="data:image/png;base64,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" alt="DOM树渲染结构过程">
最终可能回渲染成如下的DOM树结构：</p> <p><img src="data:image/png;base64,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" alt="DOM树结构"></p> <h4 id="cssdom"><a href="#cssdom" class="header-anchor">#</a> CSSDOM</h4> <p>与DOM树渲染过程类似，CSSOM树渲染过程会经历如下图所示的过程：</p> <p><img src="data:image/png;base64,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" alt="CSSOM渲染过程"></p> <h4 id="dom和cssom树合并"><a href="#dom和cssom树合并" class="header-anchor">#</a> DOM和CSSOM树合并</h4> <p>当DOM树和CSSOM树渲染完毕后，就会合并在一起形成一个渲染树，渲染树并不是简单的将DOM树和CSSOM树简单的合并在一起，渲染树只包含需要显示的DOM节点。渲染树合并完毕后，然后会根据渲染树进行布局，随后调用GPU进行绘制，显示在屏幕上。</p> <p><img src="/blog/assets/img/11.a6ed6452.png" alt="渲染树"></p> <h2 id="安全防范面试题"><a href="#安全防范面试题" class="header-anchor">#</a> 安全防范面试题</h2> <h3 id="xss跨域脚本攻击"><a href="#xss跨域脚本攻击" class="header-anchor">#</a> XSS跨域脚本攻击</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>XSS攻击简单来说就是攻击者想尽一切办法把可执行的代码嵌入到页面中，以达到非法窃取某些数据或者破坏的目的。</p></div> <p>依据情景的不同，XSS攻击可分为几种类型。</p> <h4 id="反射性xss"><a href="#反射性xss" class="header-anchor">#</a> 反射性XSS</h4> <p>反射性XSS也叫做非持久性XSS，是指发生请求时，XSS代码会出现在请求的URL中，作为参数提交到服务器，服务器接受并响应。响应结果中包含XSS代码，最后通过浏览器进行解析并执行，一个反射性XSS可能如下所示</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">ajax</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1500</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">'https://www.baidu.com/getUserInfo?name=&lt;script&gt;alert(document.cookie)&lt;/script&gt;'</span><span class="token punctuation">;</span>
<span class="token function">ajax</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">'beforeend'</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'='</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="存储型xss"><a href="#存储型xss" class="header-anchor">#</a> 存储型XSS</h4> <p>存储型XSS也叫持久性XSS，它的主要攻击方式是将代码发送到服务器，最常见的存储型XSS攻击就是评论或者浏览攻击，一个存储型XSS可能如下图所示：</p> <p><img src="/blog/assets/img/12.5c4e51ca.png" alt="储存性XSS攻击"></p> <h4 id="xss防御"><a href="#xss防御" class="header-anchor">#</a> XSS防御</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ol><li>将由用户输入的内容，进行必要的标签转义，包括<code>&lt;</code>、<code>&gt;</code>、<code>/</code>等</li> <li>再服务端设置<code>cookie</code>属性<code>httpOnly</code>防止客户端通过<code>document.cookie</code>读取</li> <li>过滤一些危险属性或者方法，例如<code>onerror</code>方法、<code>href</code>属性、<code>src</code>属性等</li></ol></div> <h3 id="csp内容安全策略"><a href="#csp内容安全策略" class="header-anchor">#</a> CSP内容安全策略</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>CSP内容安全策略本质上来说是建立白名单机制，告诉浏览器哪些外部资源可以加载和执行，我们只需要配置，拦截主要交给浏览器。</p></div> <p>通常有两种方法设置CSP：</p> <ol><li>通过设置<code>HTTP Header</code>的<code>Content-Security-Policy</code></li> <li>通过<code>meta</code>标签来设置，例如：<code>&lt;meta http-equiv=&quot;Content-Security-Policy&quot;&gt;</code></li></ol> <h3 id="csrf跨域请求伪造"><a href="#csrf跨域请求伪造" class="header-anchor">#</a> CSRF跨域请求伪造</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>CSRF攻击原理上是攻击者伪造一个后端请求地址，诱导用户进行点击，如果用户在已登录的情况下点击了这个危险链接，则后端服务器会认为是用户在正常访问，攻击者从而可以从请求中拿到一些信息，进而进行攻击。</p></div> <h4 id="csrf防御"><a href="#csrf防御" class="header-anchor">#</a> CSRF防御</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>CSRF防御有如下几种方式：</p> <ol><li><code>Get</code>请求不对数据进行修改</li> <li>不让第三方网站访问用户的<code>Cookie</code>，可以通过<code>Cookie</code>的<code>SameSite</code>属性</li> <li>阻止第三方网站请求</li> <li>在进行请求时，附加<code>refer</code>验证和<code>token</code>验证</li></ol></div> <h3 id="点击劫持"><a href="#点击劫持" class="header-anchor">#</a> 点击劫持</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击。</p></div> <h4 id="防御手段"><a href="#防御手段" class="header-anchor">#</a> 防御手段</h4> <p>设置HTTP响应头<code>X-FRAME-OPTIONS</code>，它可以设置<code>DENY</code>、<code>SAMEORIGIN</code>、<code>ALLOW-FROM</code>分别表示不允许<code>iframe</code>展示、只允许同源<code>iframe</code>展示、表示页面可以在指定来源的<code>iframe</code>中展示。</p> <h3 id="中间人攻击"><a href="#中间人攻击" class="header-anchor">#</a> 中间人攻击</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>中间人攻击是攻击方同时与服务端和客户端建立起了连接，并让对方认为连接是安全的，但是实际上整个通信过程都被攻击者控制了。攻击者不仅能获得双方的通信信息，还能修改通信信息。一般来说使用<code>HTTPS</code>协议可以有效防止中间人攻击，但并不是说<code>HTTPS</code>就可以高枕无忧，因为攻击者可以通过某种方式从<code>HTTPS</code>降级到<code>HTTP</code>进行访问。</p></div> <p><img src="/blog/assets/img/13.d8ae3b54.jpg" alt="中间人攻击"></p> <h2 id="前端监控面试题"><a href="#前端监控面试题" class="header-anchor">#</a> 前端监控面试题</h2> <h3 id="页面埋点"><a href="#页面埋点" class="header-anchor">#</a> 页面埋点</h3> <h3 id="性能监控"><a href="#性能监控" class="header-anchor">#</a> 性能监控</h3> <h3 id="异常监控"><a href="#异常监控" class="header-anchor">#</a> 异常监控</h3> <h3 id="错误上报"><a href="#错误上报" class="header-anchor">#</a> 错误上报</h3> <h2 id="性能优化面试题"><a href="#性能优化面试题" class="header-anchor">#</a> 性能优化面试题</h2> <h3 id="图片优化"><a href="#图片优化" class="header-anchor">#</a> 图片优化</h3> <p>图片优化分为多个方面，可实行的图片优化可能如下所示：</p> <ol><li>压缩图片大小</li> <li>适当将合适的图片合成在一起形成雪碧图</li> <li>图片懒加载</li></ol> <h3 id="函数节流和防抖"><a href="#函数节流和防抖" class="header-anchor">#</a> 函数节流和防抖</h3> <p>函数节流和函数防抖运用在合适的地方，能有效提升页面性能和服务器压力，可实行的方案可能如下所示：</p> <ol><li>函数节流(<code>Scroll</code>滚动事件、<code>mouse</code>相关事件、<code>onresize</code>事件等)</li> <li>搜索框实时查询利用函数防抖</li></ol> <h3 id="预解析、预加载和预渲染"><a href="#预解析、预加载和预渲染" class="header-anchor">#</a> 预解析、预加载和预渲染</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// DNS解析需要时间，可利用如下代码实现DNS预解析</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;dns-prefetch&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;https://www.baidu.com&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// 有些资源需要马上使用，可以使用如下代码实现，预加载不会阻塞onload事件</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;preload&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;https://www.baidu.com/logo.png&quot;</span><span class="token operator">&gt;</span>
<span class="token comment">// 将用户大概率会打开的资源进行预渲染，可以提升网页的加载速度</span>
<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;prerender&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;https://www.baidu.com/login.html&quot;</span><span class="token operator">&gt;</span> 
</code></pre></div><h3 id="cdn分布式缓存"><a href="#cdn分布式缓存" class="header-anchor">#</a> CDN分布式缓存</h3> <p>CDN的原理是尽可能的在各地部署机房缓存数据，这样即使主服务器在国外，国内的用户可能通过国内的机房快速进行访问。</p> <p><img src="/blog/assets/img/13.1e87c239.png" alt="CDN分布式缓存"></p> <h2 id="http相关面试题"><a href="#http相关面试题" class="header-anchor">#</a> HTTP相关面试题</h2> <h3 id="tcp和udp"><a href="#tcp和udp" class="header-anchor">#</a> TCP和UDP</h3> <h3 id="http组成及tls"><a href="#http组成及tls" class="header-anchor">#</a> HTTP组成及TLS</h3> <h3 id="http2-0和http3-0"><a href="#http2-0和http3-0" class="header-anchor">#</a> HTTP2.0和HTTP3.0</h3> <h2 id="常见设计模式面试题"><a href="#常见设计模式面试题" class="header-anchor">#</a> 常见设计模式面试题</h2> <p>强烈建议阅读<a href="/blog/designPattern/">JavaScript设计模式与开发实践</a></p> <h2 id="常见数据结构和算法面试题"><a href="#常见数据结构和算法面试题" class="header-anchor">#</a> 常见数据结构和算法面试题</h2> <p>推荐阅读<a href="/blog/books/javascript/algorithm.html">常见数据结构和算法</a></p> <h2 id="vue相关面试题"><a href="#vue相关面试题" class="header-anchor">#</a> Vue相关面试题</h2> <p>强烈建议阅读<a href="/blog/vueAnalysis/introduction/">Vue源码分析</a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">8/28/2023, 2:20:54 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.e2b3f633.js" defer></script><script src="/blog/assets/js/3.8b672db4.js" defer></script><script src="/blog/assets/js/2.e585f687.js" defer></script><script src="/blog/assets/js/18.267b2708.js" defer></script>
  </body>
</html>
