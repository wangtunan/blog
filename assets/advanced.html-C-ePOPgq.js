import{_ as n,c as a,b as p,o as e}from"./app-DnxTA_sf.js";const t="/blog/assets/32-BaFIydeo.png",o="/blog/assets/33-Bxqh-JXB.png",l="/blog/assets/19-Dph_nbZi.png",c="/blog/assets/20-DTKaFaMl.png",i="/blog/assets/21-Nzhqo1-P.png",r="/blog/assets/22-CVfhAgh4.png",u={};function d(k,s){return e(),a("div",null,s[0]||(s[0]=[p(`<h1 id="webpackè¿›é˜¶" tabindex="-1"><a class="header-anchor" href="#webpackè¿›é˜¶"><span>Webpackè¿›é˜¶</span></a></h1><h2 id="tree-shaking" tabindex="-1"><a class="header-anchor" href="#tree-shaking"><span>Tree Shaking</span></a></h2><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p><code>Tree Shaking</code>æ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œé€šå¸¸ç”¨äºæè¿°ç§»é™¤<code>js</code>ä¸­æœªä½¿ç”¨çš„ä»£ç ã€‚</p></div><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p>Tree Shaking åªé€‚ç”¨äº<code>ES Module</code>è¯­æ³•(æ—¢é€šè¿‡<code>export</code>å¯¼å‡ºï¼Œ<code>import</code>å¼•å…¥)ï¼Œå› ä¸ºå®ƒä¾èµ–äº<code>ES Module</code>çš„é™æ€ç»“æ„ç‰¹æ€§ã€‚</p></div><p>åœ¨æ­£å¼ä»‹ç»<code>Tree Shaking</code>ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç°åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>math.js</code>æ–‡ä»¶ï¼Œå®ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯¹<code>index.js</code>åšä¸€ä¸‹å¤„ç†ï¼Œå®ƒçš„ä»£ç åƒä¸‹é¢è¿™æ ·ï¼Œä»<code>math.js</code>ä¸­å¼•ç”¨<code>add</code>æ–¹æ³•å¹¶è°ƒç”¨ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math&#39;</span></span>
<span class="line"><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä¸Šé¢çš„<code>.js</code>æ”¹åŠ¨å®Œæ¯•åï¼Œæˆ‘ä»¬æœ€åéœ€è¦å¯¹<code>webpack.config.js</code>åšä¸€ä¸‹é…ç½®ï¼Œè®©å®ƒæ”¯æŒ<code>Tree Shaking</code>ï¼Œå®ƒçš„æ”¹åŠ¨å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line highlighted">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line highlighted">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;main.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨ä»¥ä¸Š<code>webpack.config.js</code>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>npx webpack</code>è¿›è¡Œæ‰“åŒ…ï¼Œå®ƒçš„æ‰“åŒ…ç»“æœå¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// dist/main.js</span></span>
<span class="line"><span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">/* harmony export (binding) */</span> </span>
<span class="line">__webpack_require__<span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span>__webpack_exports__<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> add<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">/* unused harmony export minus */</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">minus</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰“åŒ…ç»“æœåˆ†æ</strong>ï¼šè™½ç„¶æˆ‘ä»¬é…ç½®äº† <code>Tree Shaking</code>ï¼Œä½†åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬ä¾ç„¶èƒ½å¤Ÿçœ‹åˆ°æœªä½¿ç”¨è¿‡çš„<code>minus</code>æ–¹æ³•ï¼Œä»¥ä¸Šæ³¨é‡Šä¹Ÿæ¸…æ™°äº†è¯´æ˜äº†è¿™ä¸€ç‚¹ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯èƒ½ä¼šé—®ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬é…ç½®äº†<code>Tree Shaking</code>ï¼Œ<code>minus</code>æ–¹æ³•ä¹Ÿæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä½†ä¾ç„¶è¿˜æ˜¯è¢«æ‰“åŒ…è¿›äº†<code>main.js</code>ä¸­ï¼Ÿ<br></p><p>å…¶å®è¿™ä¸ªåŸå› å¾ˆç®€å•ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å¤„äºå¼€å‘ç¯å¢ƒä¸‹æ‰“åŒ…ï¼Œå½“æˆ‘ä»¬å¤„äºå¼€å‘ç¯å¢ƒä¸‹æ—¶ï¼Œç”±äº<code>source-map</code>ç­‰ç›¸å…³å› ç´ çš„å½±å“ï¼Œå¦‚æœæˆ‘ä»¬ä¸æŠŠæ²¡æœ‰ä½¿ç”¨çš„ä»£ç ä¸€èµ·æ‰“åŒ…è¿›æ¥çš„è¯ï¼Œ<code>source-map</code>å°±ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œè¿™ä¼šå½±å“æˆ‘ä»¬æœ¬åœ°å¼€å‘çš„æ•ˆç‡ã€‚<br></p><p>çœ‹å®Œä»¥ä¸Šæœ¬åœ°å¼€å‘<code>Tree Shaking</code>çš„ç»“æœï¼Œæˆ‘ä»¬ä¹ŸçŸ¥é“äº†æœ¬åœ°å¼€å‘<code>Tree Shaking</code>ç›¸å¯¹æ¥è¯´æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œé‚£ä¹ˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰“åŒ…æ—¶ï¼Œ<code>Tree Shaking</code>çš„è¡¨ç°åˆå¦‚ä½•å‘¢ï¼Ÿ<br></p><p>åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰“åŒ…ï¼Œéœ€è¦æˆ‘ä»¬å¯¹<code>webpack.config.js</code>ä¸­çš„<code>mode</code>å±æ€§ï¼Œéœ€è¦ç”±<code>development</code>æ”¹ä¸º<code>production</code>ï¼Œå®ƒçš„æ”¹åŠ¨å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;main.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬ä¾ç„¶ä½¿ç”¨<code>npx webpack</code>è¿›è¡Œæ‰“åŒ…ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒçš„æ‰“åŒ…ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// dist/main.js</span></span>
<span class="line"><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span>n<span class="token punctuation">,</span>r</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">var</span> t<span class="token punctuation">,</span>o<span class="token punctuation">;</span></span>
<span class="line">  r<span class="token punctuation">.</span><span class="token function">r</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  t<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">  o<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span></span>
<span class="line">  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>t<span class="token operator">+</span>o<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰“åŒ…ä»£ç åˆ†æ</strong>ï¼šä»¥ä¸Šä»£ç æ˜¯ä¸€æ®µè¢«å‹ç¼©è¿‡åçš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢åªæœ‰<code>add</code>æ–¹æ³•ï¼Œæœªä½¿ç”¨çš„<code>minus</code>æ–¹æ³•å¹¶æ²¡æœ‰è¢«æ‰“åŒ…è¿›æ¥ï¼Œè¿™è¯´æ˜åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æˆ‘ä»¬çš„<code>Tree Shaking</code>æ‰èƒ½çœŸæ­£èµ·ä½œç”¨ã€‚</p><h4 id="sideeffects" tabindex="-1"><a class="header-anchor" href="#sideeffects"><span>SideEffects</span></a></h4><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p>ç”±äº<code>Tree Shaking</code>ä½œç”¨äºæ‰€æœ‰é€šè¿‡<code>import</code>å¼•å…¥çš„æ–‡ä»¶ï¼Œå¦‚æœæˆ‘ä»¬å¼•å…¥ç¬¬ä¸‰æ–¹åº“ï¼Œä¾‹å¦‚ï¼š<code>import _ from &#39;lodash&#39;</code>æˆ–è€…<code>.css</code>æ–‡ä»¶ï¼Œä¾‹å¦‚<code>import &#39;./style.css&#39;</code> æ—¶ï¼Œå¦‚æœæˆ‘ä»¬ä¸ åšé™åˆ¶çš„è¯ï¼ŒTree Shakingå°†èµ·å‰¯ä½œç”¨ï¼Œ<code>SideEffects</code>å±æ€§èƒ½å¸®æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå®ƒå‘Šè¯‰<code>webpack</code>ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å“ªäº›æ–‡ä»¶ä¸åš <code>Tree Shaking</code></p></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// ä¿®æ”¹package.json</span></span>
<span class="line"><span class="token comment">// å¦‚æœä¸å¸Œæœ›å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œæ­¤é…ç½®ï¼Œå¯ä»¥è®¾ç½®sideEffectså±æ€§å€¼ä¸ºfalse</span></span>
<span class="line"><span class="token comment">// *.css è¡¨ç¤º å¯¹æ‰€æœ‰cssæ–‡ä»¶ä¸åš Tree Shaking</span></span>
<span class="line"><span class="token comment">// @babael/polyfill è¡¨ç¤º å¯¹@babel/polyfillä¸åš Tree Shaking</span></span>
<span class="line"><span class="token string-property property">&quot;sideEffects&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">  <span class="token string">&quot;*.css&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token string">&quot;@babel/polyfill&quot;</span></span>
<span class="line"><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å°ç»“</strong>ï¼šå¯¹äº<code>Tree Shaking</code>çš„äº‰è®®æ¯”è¾ƒå¤šï¼Œæ¨èçœ‹ğŸ‘‰<a href="https://zhuanlan.zhihu.com/p/32831172" target="_blank" rel="noopener noreferrer">ä½ çš„Tree Shakingå¹¶æ²¡æœ‰ä»€ä¹ˆåµç”¨</a>ï¼Œçœ‹å®Œä½ ä¼šå‘ç°æˆ‘ä»¬å¯¹<code>Tree Shaking</code>çš„äº†è§£è¿˜éœ€è¦è¿›ä¸€æ­¥åŠ æ·±ã€‚</p><h2 id="åŒºåˆ†å¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#åŒºåˆ†å¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼"><span>åŒºåˆ†å¼€å‘æ¨¡å¼å’Œç”Ÿäº§æ¨¡å¼</span></a></h2><p>åƒä¸Šä¸€èŠ‚é‚£æ ·ï¼Œå¦‚æœæˆ‘ä»¬è¦åŒºåˆ†<code>Tree Shaking</code>çš„å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡æ‰“åŒ…çš„éƒ½è¦å»æ›´æ”¹<code>webpack.config.js</code>æ–‡ä»¶ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½è®©æˆ‘ä»¬å°‘æ”¹ä¸€ç‚¹ä»£ç å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯æœ‰çš„ï¼</p><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p>åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œæœ€å¥½çš„åŠæ³•æ˜¯æŠŠå…¬ç”¨é…ç½®æå–åˆ°ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒåªå†™è‡ªå·±éœ€è¦çš„é…ç½®ï¼Œåœ¨æ‰“åŒ…çš„æ—¶å€™å†è¿›è¡Œåˆå¹¶å³å¯ï¼Œ<strong><code>webpack-merge</code></strong> å¯ä»¥å¸®æˆ‘ä»¬åšåˆ°è¿™ä¸ªäº‹æƒ…ã€‚</p></div><p>é¦–å…ˆï¼Œæˆ‘ä»¬æ•ˆä»¿å„å¤§æ¡†æ¶çš„è„šæ‰‹æ¶çš„å½¢å¼ï¼ŒæŠŠ Webpack ç›¸å…³çš„é…ç½®éƒ½æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„<code>build</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ª<code>build</code>æ–‡ä»¶å¤¹ï¼Œéšåæˆ‘ä»¬è¦åœ¨æ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸‰ä¸ª<code>.js</code>æ–‡ä»¶å’Œåˆ é™¤<code>webpack.config.js</code>ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><ul><li><code>webpack.common.js</code>ï¼šWebpack å…¬ç”¨é…ç½®æ–‡ä»¶</li><li><code>webpack.dev.js</code>ï¼šå¼€å‘ç¯å¢ƒä¸‹çš„ Webpack é…ç½®æ–‡ä»¶</li><li><code>webpack.prod.js</code>ï¼šç”Ÿäº§ç¯å¢ƒä¸‹çš„ Webpack é…ç½®æ–‡ä»¶</li><li><code>webpack.config.js</code>ï¼š<strong>åˆ é™¤</strong>æ ¹ç›®å½•ä¸‹çš„æ­¤æ–‡ä»¶</li></ul><p>æ–°å»ºå®Œ<code>webpack.common.js</code>æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦æŠŠå…¬ç”¨é…ç½®æå–å‡ºæ¥ï¼Œå®ƒçš„ä»£ç çœ‹èµ·æ¥åº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·å­çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;clean-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;style-loader&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;css-loader&#39;</span><span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span> </span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;src/index.html&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;dist&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æå–å®Œ Webpack å…¬ç”¨é…ç½®æ–‡ä»¶åï¼Œæˆ‘ä»¬å¼€å‘ç¯å¢ƒä¸‹çš„é…ç½®ï¼Œä¹Ÿå°±æ˜¯<code>webpack.dev.js</code>ä¸­çš„ä»£ç ï¼Œå°†å‰©ä¸‹ä¸‹é¢è¿™äº›ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;cheap-module-eval-source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">contentBase</span><span class="token operator">:</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">hotOnly</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€Œç”Ÿäº§ç¯å¢ƒä¸‹çš„é…ç½®ï¼Œä¹Ÿå°±æ˜¯<code>webpack.prod.js</code>ä¸­çš„ä»£ç ï¼Œå¯èƒ½æ˜¯ä¸‹é¢è¿™æ ·å­çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;cheap-module-source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨å¤„ç†å®Œä»¥ä¸Šä¸‰ä¸ª<code>.js</code>æ–‡ä»¶åï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä»¶äº‹æƒ…ï¼š</p><ul><li>å½“å¤„äºå¼€å‘ç¯å¢ƒä¸‹æ—¶ï¼ŒæŠŠ<code>webpack.common.js</code>ä¸­çš„é…ç½®å’Œ<code>webpack.dev.js</code>ä¸­çš„é…ç½®åˆå¹¶åœ¨ä¸€èµ·</li><li>å½“å¤„äºå¼€å‘ç¯å¢ƒä¸‹æ—¶ï¼ŒæŠŠ<code>webpack.common.js</code>ä¸­çš„é…ç½®å’Œ<code>webpack.prod.js</code>ä¸­çš„é…ç½®åˆå¹¶åœ¨ä¸€èµ·</li></ul><p>é’ˆå¯¹ä»¥ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>webpack-merge</code>è¿›è¡Œåˆå¹¶ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">$ <span class="token function">npm</span> <span class="token function">install</span> webpack-merge <span class="token parameter variable">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åï¼Œæˆ‘ä»¬éœ€è¦å¯¹<code>webpack.dev.js</code>å’Œ<code>webpack.prod.js</code>åšä¸€ä¸‹æ‰‹è„šï¼Œå…¶ä¸­<code>webpack.dev.js</code>ä¸­çš„æ”¹åŠ¨å¦‚ä¸‹(ä»£ç é«˜äº®éƒ¨åˆ†)ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.common&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> devConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;development&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;cheap-module-eval-source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">contentBase</span><span class="token operator">:</span> <span class="token string">&#39;dist&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">open</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">hot</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">hotOnly</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>HotModuleReplacementPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line highlighted">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> devConfig<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç›¸åŒçš„ä»£ç ï¼Œ<code>webpack.prod.js</code>ä¸­çš„æ”¹åŠ¨éƒ¨åˆ†å¦‚ä¸‹(ä»£ç é«˜äº®)ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line highlighted"><span class="token keyword">const</span> merge <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack-merge&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> commonConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./webpack.common&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> prodConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">devtool</span><span class="token operator">:</span> <span class="token string">&#39;cheap-module-source-map&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">usedExports</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line highlighted">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">merge</span><span class="token punctuation">(</span>commonConfig<span class="token punctuation">,</span> prodConfig<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>èªæ˜çš„ä½ ä¸€å®šæƒ³åˆ°äº†ï¼Œå› ä¸ºä¸Šé¢æˆ‘ä»¬å·²ç»åˆ é™¤äº†<code>webpack.config.js</code>æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡æ–°åœ¨<code>package.json</code>ä¸­é…ç½®ä¸€ä¸‹æˆ‘ä»¬çš„æ‰“åŒ…å‘½ä»¤ï¼Œå®ƒä»¬æ˜¯è¿™æ ·å­å†™çš„ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack-dev-server --config ./build/webpack.dev.js&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;webpack --config ./build/webpack.prod.js&quot;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ‰“åŒ…å‘½ä»¤ï¼Œå¿ƒæ€¥çš„ä½ å¯èƒ½ä¼šé©¬ä¸Šå¼€å§‹å°è¯•è¿›è¡Œæ‰“åŒ…ï¼Œä½ çš„æ‰“åŒ…ç›®å½•å¯èƒ½é•¿æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> build</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> src</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> math<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token punctuation">.</span>babelrc</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> postcss<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>é—®é¢˜åˆ†æ</strong>ï¼šå½“æˆ‘ä»¬è¿è¡Œ<code>npm run build</code>æ—¶ï¼Œ<code>dist</code>ç›®å½•æ‰“åŒ…åˆ°äº†<code>build</code>æ–‡ä»¶å¤¹ä¸‹äº†ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬æŠŠWebpack ç›¸å…³çš„é…ç½®æ”¾åˆ°äº†<code>build</code>æ–‡ä»¶å¤¹ä¸‹åï¼Œå¹¶æ²¡æœ‰åšå…¶ä»–é…ç½®ï¼ŒWebpack ä¼šè®¤ä¸º<code>build</code>æ–‡ä»¶å¤¹ä¼šæ˜¯æ ¹ç›®å½•ï¼Œè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦æˆ‘ä»¬åœ¨<code>webpack.common.js</code>ä¸­ä¿®æ”¹<code>output</code>å±æ€§ï¼Œå…·ä½“æ”¹åŠ¨çš„éƒ¨åˆ†å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line">output<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  filename<span class="token operator">:</span> &#39;<span class="token punctuation">[</span>name<span class="token punctuation">]</span>.js&#39;<span class="token punctuation">,</span></span>
<span class="line highlighted">  path<span class="token operator">:</span> path.resolve(__dirname<span class="token punctuation">,</span>&#39;../dist&#39;)</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é‚£ä¹ˆè§£å†³å®Œä¸Šé¢è¿™ä¸ªé—®é¢˜ï¼Œèµ¶ç´§ä½¿ç”¨ä½ çš„æ‰“åŒ…å‘½ä»¤æµ‹è¯•ä¸€ä¸‹å§ï¼Œæˆ‘çš„æ‰“åŒ…ç›®å½•æ˜¯ä¸‹é¢è¿™æ ·å­ï¼Œå¦‚æœä½ æŒ‰ä¸Šé¢çš„é…ç½®åï¼Œä½ çš„åº”è¯¥è·Ÿæ­¤ç›®å½•ç±»ä¼¼</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> build</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> src</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> math<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token punctuation">.</span>babelrc</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> postcss<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä»£ç åˆ†ç¦»-codesplitting" tabindex="-1"><a class="header-anchor" href="#ä»£ç åˆ†ç¦»-codesplitting"><span>ä»£ç åˆ†ç¦»(CodeSplitting)</span></a></h2><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p><code>Code Splitting</code> çš„æ ¸å¿ƒæ˜¯æŠŠå¾ˆå¤§çš„æ–‡ä»¶ï¼Œåˆ†ç¦»æˆæ›´å°çš„å—ï¼Œè®©æµè§ˆå™¨è¿›è¡Œå¹¶è¡ŒåŠ è½½ã€‚</p></div><p>å¸¸è§çš„ä»£ç åˆ†å‰²æœ‰ä¸‰ç§å½¢å¼ï¼š</p><ul><li>æ‰‹åŠ¨è¿›è¡Œåˆ†å‰²ï¼šä¾‹å¦‚é¡¹ç›®å¦‚æœç”¨åˆ°<code>lodash</code>ï¼Œåˆ™æŠŠ<code>lodash</code>å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶ã€‚</li><li>åŒæ­¥å¯¼å…¥çš„ä»£ç ï¼šä½¿ç”¨ Webpack é…ç½®è¿›è¡Œä»£ç åˆ†å‰²ã€‚</li><li>å¼‚æ­¥å¯¼å…¥çš„ä»£ç ï¼šé€šè¿‡æ¨¡å—ä¸­çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†å‰²ä»£ç ã€‚</li></ul><h4 id="æ‰‹åŠ¨è¿›è¡Œåˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#æ‰‹åŠ¨è¿›è¡Œåˆ†å‰²"><span>æ‰‹åŠ¨è¿›è¡Œåˆ†å‰²</span></a></h4><p>æ‰‹åŠ¨è¿›è¡Œåˆ†å‰²çš„æ„æ€æ˜¯åœ¨<code>entry</code>ä¸Šé…ç½®å¤šä¸ªå…¥å£ï¼Œä¾‹å¦‚åƒä¸‹é¢è¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">lodash</span><span class="token operator">:</span> <span class="token string">&#39;lodash&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·é…ç½®åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>npm run build</code>æ‰“åŒ…å‘½ä»¤ï¼Œå®ƒçš„æ‰“åŒ…è¾“å‡ºç»“æœä¸ºï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text"><pre><code><span class="line">        Asset       Size  Chunks             Chunk Names</span>
<span class="line">  index.html  462 bytes          [emitted]</span>
<span class="line">    lodash.js   1.46 KiB       1  [emitted]  lodash</span>
<span class="line">lodash.js.map   5.31 KiB       1  [emitted]  lodash</span>
<span class="line">      main.js   1.56 KiB       2  [emitted]  main</span>
<span class="line">  main.js.map   5.31 KiB       2  [emitted]  main</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®ƒè¾“å‡ºäº†ä¸¤ä¸ªæ¨¡å—ï¼Œä¹Ÿèƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¿›è¡Œä»£ç åˆ†å‰²ï¼Œä¸è¿‡è¿™ç§åˆ†å‰²æ˜¯ååˆ†è„†å¼±çš„ï¼Œå¦‚æœä¸¤ä¸ªæ¨¡å—å…±åŒå¼•ç”¨äº†ç¬¬ä¸‰ä¸ªæ¨¡å—ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªæ¨¡å—ä¼šè¢«åŒæ—¶æ‰“åŒ…è¿›è¿™ä¸¤ä¸ªå…¥å£æ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯åˆ†ç¦»å‡ºæ¥ã€‚<br><br></p><p>æ‰€ä»¥æˆ‘ä»¬å¸¸è§çš„åšæ³•æ˜¯å…³å¿ƒæœ€åä¸¤ç§ä»£ç åˆ†å‰²æ–¹æ³•ï¼Œæ— è®ºæ˜¯åŒæ­¥ä»£ç è¿˜æ˜¯å¼‚æ­¥ä»£ç ï¼Œéƒ½éœ€è¦åœ¨<code>webpack.common.js</code>ä¸­é…ç½®<code>splitChunks</code>å±æ€§ï¼Œåƒä¸‹é¢è¿™æ ·å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½ å¯èƒ½å·²ç»çœ‹åˆ°äº†å…¶ä¸­æœ‰ä¸€ä¸ª<code>chunks</code>å±æ€§ï¼Œå®ƒå‘Šè¯‰ Webpack åº”è¯¥å¯¹å“ªäº›æ¨¡å¼è¿›è¡Œæ‰“åŒ…ï¼Œå®ƒçš„å‚æ•°æœ‰ä¸‰ç§ï¼š</p><ul><li><code>async</code>ï¼šæ­¤å€¼ä¸ºé»˜è®¤å€¼ï¼Œåªæœ‰å¼‚æ­¥å¯¼å…¥çš„ä»£ç æ‰ä¼šè¿›è¡Œä»£ç åˆ†å‰²ã€‚</li><li><code>initial</code>ï¼šä¸<code>async</code>ç›¸å¯¹ï¼Œåªæœ‰åŒæ­¥å¼•å…¥çš„ä»£ç æ‰ä¼šè¿›è¡Œä»£ç åˆ†å‰²ã€‚</li><li><code>all</code>ï¼šè¡¨ç¤ºæ— è®ºæ˜¯åŒæ­¥ä»£ç è¿˜æ˜¯å¼‚æ­¥ä»£ç éƒ½ä¼šè¿›è¡Œä»£ç åˆ†å‰²ã€‚</li></ul><h4 id="åŒæ­¥ä»£ç åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥ä»£ç åˆ†å‰²"><span>åŒæ­¥ä»£ç åˆ†å‰²</span></a></h4><p>åœ¨å®Œæˆä¸Šé¢çš„é…ç½®åï¼Œè®©æˆ‘ä»¬æ¥å®‰è£…ä¸€ä¸ªç›¸å¯¹å¤§ä¸€ç‚¹çš„åŒ…ï¼Œä¾‹å¦‚ï¼š<code>lodash</code>ï¼Œç„¶åå¯¹<code>index.js</code>ä¸­çš„ä»£ç åšä¸€äº›æ‰‹è„šï¼Œåƒä¸‹é¢è¿™æ ·ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#39;lodash&#39;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Dell&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;Lee&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å°±åƒä¸Šé¢æåˆ°çš„é‚£æ ·ï¼ŒåŒæ­¥ä»£ç åˆ†å‰²ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨<code>webpack.common.js</code>é…ç½®<code>chunks</code>å±æ€§å€¼ä¸º<code>initial</code>å³å¯ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;initial&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>webpack.common.js</code>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>npm run build</code>æ¥è¿›è¡Œæ‰“åŒ…ï¼Œ ä½ çš„æ‰“åŒ…<code>dist</code>ç›®å½•çœ‹èµ·æ¥åº”è¯¥åƒä¸‹é¢è¿™æ ·å­ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰“åŒ…åˆ†æ</strong>ï¼š<code>main.js</code>ä½¿æˆ‘ä»¬çš„ä¸šåŠ¡ä»£ç ï¼Œ<code>vendors~main.js</code>æ˜¯ç¬¬ä¸‰æ–¹æ¨¡å—çš„ä»£ç ï¼Œåœ¨æ­¤æ¡ˆä¾‹ä¸­ä¹Ÿå°±æ˜¯<code>_lodash</code>ä¸­çš„ä»£ç ã€‚</p><h4 id="å¼‚æ­¥ä»£ç åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#å¼‚æ­¥ä»£ç åˆ†å‰²"><span>å¼‚æ­¥ä»£ç åˆ†å‰²</span></a></h4><p>ç”±äº<code>chunks</code>å±æ€§çš„é»˜è®¤å€¼ä¸º<code>async</code>ï¼Œå¦‚æœæˆ‘ä»¬åªéœ€è¦é’ˆå¯¹å¼‚æ­¥ä»£ç è¿›è¡Œä»£ç åˆ†å‰²çš„è¯ï¼Œæˆ‘ä»¬åªéœ€è¦è¿›è¡Œå¼‚æ­¥å¯¼å…¥ï¼ŒWebpackä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œä»£ç åˆ†å‰²ï¼Œå¼‚æ­¥ä»£ç åˆ†å‰²å®ƒçš„é…ç½®å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;async&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ³¨æ„</strong>ï¼šç”±äºå¼‚æ­¥å¯¼å…¥è¯­æ³•ç›®å‰å¹¶æ²¡æœ‰å¾—åˆ°å…¨é¢æ”¯æŒï¼Œéœ€è¦é€šè¿‡ npm å®‰è£… <code>@babel/plugin-syntax-dynamic-import</code> æ’ä»¶æ¥è¿›è¡Œè½¬è¯‘</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">$ <span class="token function">npm</span> <span class="token function">install</span> @babel/plugin-syntax-dynamic-import <span class="token parameter variable">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ ¹ç›®å½•ä¸‹çš„<code>.babelrc</code>æ–‡ä»¶åšä¸€ä¸‹æ”¹åŠ¨ï¼Œåƒä¸‹é¢è¿™æ ·å­ï¼š</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line highlighted">  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/plugin-syntax-dynamic-import&quot;</span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•åï¼Œæˆ‘ä»¬éœ€è¦å¯¹<code>index.js</code>åšä¸€ä¸‹ä»£ç æ”¹åŠ¨ï¼Œè®©å®ƒä½¿ç”¨å¼‚æ­¥å¯¼å…¥ä»£ç å—:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// ç‚¹å‡»é¡µé¢ï¼Œå¼‚æ­¥å¯¼å…¥lodashæ¨¡å—</span></span>
<span class="line">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">getComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getComponent</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &#39;lodash&#39; */</span><span class="token string">&#39;lodash&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Dell&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;lee&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">return</span> element<span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å†™å¥½ä»¥ä¸Šä»£ç åï¼Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨<code>npm run build</code>è¿›è¡Œæ‰“åŒ…ï¼Œ<code>dist</code>æ‰“åŒ…ç›®å½•çš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> <span class="token number">1</span><span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> <span class="token number">1</span><span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ<code>dist</code>ç›®å½•ä¸‹çš„<code>index.html</code>ï¼Œåˆ‡æ¢åˆ°<code>network</code>é¢æ¿æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°åªåŠ è½½äº†<code>main.js</code>ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><img src="`+t+'" alt="å¼‚æ­¥å¯¼å…¥çš„ç»“æœ"><br><br></p><p>å½“æˆ‘ä»¬ç‚¹å‡»é¡µé¢æ—¶ï¼Œæ‰ <strong>çœŸæ­£å¼€å§‹åŠ è½½</strong> ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œå¦‚ä¸‹å›¾(<code>1.js</code>)ï¼š</p><p><img src="'+o+`" alt="å¼‚æ­¥å¯¼å…¥çš„ç»“æœ"></p><h2 id="splitchunkspluginé…ç½®å‚æ•°è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#splitchunkspluginé…ç½®å‚æ•°è¯¦è§£"><span>SplitChunksPluginé…ç½®å‚æ•°è¯¦è§£</span></a></h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬é…ç½®äº†<code>splitChunks</code>å±æ€§ï¼Œå®ƒèƒ½è®©æˆ‘ä»¬è¿›è¡Œä»£ç åˆ†å‰²ï¼Œå…¶å®è¿™æ˜¯å› ä¸º Webpack åº•å±‚ä½¿ç”¨äº† <strong><code>splitChunksPlugin</code></strong> æ’ä»¶ã€‚è¿™ä¸ªæ’ä»¶æœ‰å¾ˆå¤šå¯ä»¥é…ç½®çš„å±æ€§ï¼Œå®ƒä¹Ÿæœ‰ä¸€äº›é»˜è®¤çš„é…ç½®å‚æ•°ï¼Œå®ƒçš„é»˜è®¤é…ç½®å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢ä¸ºä¸€äº›å¸¸ç”¨çš„é…ç½®é¡¹åšä¸€äº›è¯´æ˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®é¡¹</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;async&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">minSize</span><span class="token operator">:</span> <span class="token number">30000</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">maxSize</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">maxAsyncRequests</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">automaticNameDelimiter</span><span class="token operator">:</span> <span class="token string">&#39;~&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">cacheGroups</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="chunkså‚æ•°" tabindex="-1"><a class="header-anchor" href="#chunkså‚æ•°"><span>chunkså‚æ•°</span></a></h4><p>æ­¤å‚æ•°çš„å«ä¹‰åœ¨ä¸Šä¸€èŠ‚ä¸­å·²è¯¦ç»†è¯´æ˜ï¼ŒåŒæ—¶ä¹Ÿé…ç½®äº†ç›¸åº”çš„æ¡ˆä¾‹ï¼Œå°±<strong>ä¸å†æ¬¡ç´¯è¿°</strong>ã€‚</p><h4 id="minsize-å’Œ-maxsize" tabindex="-1"><a class="header-anchor" href="#minsize-å’Œ-maxsize"><span>minSize å’Œ maxSize</span></a></h4><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p><code>minSize</code>é»˜è®¤å€¼æ˜¯30000ï¼Œä¹Ÿå°±æ˜¯30kbï¼Œå½“ä»£ç è¶…è¿‡30kbæ—¶ï¼Œæ‰å¼€å§‹è¿›è¡Œä»£ç åˆ†å‰²ï¼Œå°äº30kbçš„åˆ™ä¸ä¼šè¿›è¡Œä»£ç åˆ†å‰²ï¼›ä¸<code>minSize</code>ç›¸å¯¹çš„ï¼Œ<code>maxSize</code>é»˜è®¤å€¼ä¸º0ï¼Œä¸º0è¡¨ç¤ºä¸é™åˆ¶æ‰“åŒ…åæ–‡ä»¶çš„å¤§å°ï¼Œä¸€èˆ¬è¿™ä¸ªå±æ€§ä¸æ¨èè®¾ç½®ï¼Œä¸€å®šè¦è®¾ç½®çš„è¯ï¼Œå®ƒçš„æ„æ€æ˜¯ï¼šæ‰“åŒ…åçš„æ–‡ä»¶æœ€å¤§ä¸èƒ½è¶…è¿‡è®¾å®šçš„å€¼ï¼Œè¶…è¿‡çš„è¯å°±ä¼šè¿›è¡Œä»£ç åˆ†å‰²ã€‚</p></div><p>ä¸ºäº†æµ‹è¯•ä»¥ä¸Šä¸¤ä¸ªå±æ€§ï¼Œæˆ‘ä»¬æ¥å†™ä¸€ä¸ªå°å°çš„ä¾‹å­ï¼Œåœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>math.js</code>æ–‡ä»¶ï¼Œå®ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–°å»ºå®Œæ¯•åï¼Œåœ¨<code>index.js</code>ä¸­å¼•å…¥<code>math.js</code>:</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> add <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./math.js&#39;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰“åŒ…åˆ†æ</strong>ï¼šå› ä¸ºæˆ‘ä»¬å†™çš„<code>math.js</code>æ–‡ä»¶çš„å¤§å°éå¸¸å°ï¼Œå¦‚æœåº”ç”¨é»˜è®¤å€¼ï¼Œå®ƒæ˜¯ä¸ä¼šè¿›è¡Œä»£ç åˆ†å‰²çš„ï¼Œå¦‚æœä½ è¦è¿›ä¸€æ­¥æµ‹è¯•<code>minSize</code>å’Œ<code>maxSize</code>ï¼Œè¯·è‡ªè¡Œä¿®æ”¹åæ‰“åŒ…æµ‹è¯•ã€‚</p><h4 id="minchunks" tabindex="-1"><a class="header-anchor" href="#minchunks"><span>minChunks</span></a></h4><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p>é»˜è®¤å€¼ä¸º1ï¼Œè¡¨ç¤ºæŸä¸ªæ¨¡å—å¤ç”¨çš„æ¬¡æ•°å¤§äºæˆ–ç­‰äºä¸€æ¬¡ï¼Œå°±è¿›è¡Œä»£ç åˆ†å‰²ã€‚</p></div><p>å¦‚æœå°†å…¶è®¾ç½®å¤§äº1ï¼Œä¾‹å¦‚ï¼š<code>minChunks:2</code>ï¼Œåœ¨ä¸è€ƒè™‘å…¶ä»–æ¨¡å—çš„æƒ…å†µä¸‹ï¼Œä»¥ä¸‹ä»£ç ä¸ä¼šè¿›è¡Œä»£ç åˆ†å‰²ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// é…ç½®äº†minChunks: 2ï¼Œä»¥ä¸‹lodashä¸ä¼šè¿›è¡Œä»£ç åˆ†å‰²ï¼Œå› ä¸ºåªä½¿ç”¨äº†ä¸€æ¬¡ </span></span>
<span class="line"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#39;lodash&#39;</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Dell&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Lee&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;-&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="maxasyncrequests-å’Œ-maxinitialrequests" tabindex="-1"><a class="header-anchor" href="#maxasyncrequests-å’Œ-maxinitialrequests"><span>maxAsyncRequests å’Œ maxInitialRequests</span></a></h4><ul><li><code>maxAsyncRequests</code>ï¼šå®ƒçš„é»˜è®¤å€¼æ˜¯5ï¼Œä»£è¡¨åœ¨è¿›è¡Œå¼‚æ­¥ä»£ç åˆ†å‰²æ—¶ï¼Œå‰äº”ä¸ªä¼šè¿›è¡Œä»£ç åˆ†å‰²ï¼Œè¶…è¿‡äº”ä¸ªçš„ä¸å†è¿›è¡Œä»£ç åˆ†å‰²ã€‚</li><li><code>maxInitialRequests</code>ï¼šå®ƒçš„é»˜è®¤å€¼æ˜¯3ï¼Œä»£è¡¨åœ¨è¿›è¡ŒåŒæ­¥ä»£ç åˆ†å‰²æ—¶ï¼Œå‰ä¸‰ä¸ªä¼šè¿›è¡Œä»£ç åˆ†å‰²ï¼Œè¶…è¿‡ä¸‰ä¸ªçš„ä¸å†è¿›è¡Œä»£ç åˆ†å‰²ã€‚</li></ul><h4 id="automaticnamedelimiter" tabindex="-1"><a class="header-anchor" href="#automaticnamedelimiter"><span>automaticNameDelimiter</span></a></h4><p>è¿™æ˜¯ä¸€ä¸ªè¿æ¥ç¬¦ï¼Œå·¦è¾¹æ˜¯ä»£ç åˆ†å‰²çš„ç¼“å­˜ç»„ï¼Œå³è¾¹æ˜¯æ‰“åŒ…çš„å…¥å£æ–‡ä»¶çš„é¡¹ï¼Œä¾‹å¦‚<code>vendors~main.js</code></p><h4 id="cachegroups" tabindex="-1"><a class="header-anchor" href="#cachegroups"><span>cacheGroups</span></a></h4><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p>åœ¨è¿›è¡Œä»£ç åˆ†å‰²æ—¶ï¼Œä¼šæŠŠç¬¦åˆæ¡ä»¶çš„æ”¾åœ¨ä¸€ç»„ï¼Œç„¶åæŠŠä¸€ç»„ä¸­çš„æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œé»˜è®¤é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªåˆ†ç»„ï¼Œä¸€ä¸ªæ˜¯<code>vendors</code>å’Œ<code>default</code></p></div><p><strong>vendorsç»„ï¼š</strong> ä»¥ä¸‹ä»£ç çš„å«ä¹‰æ˜¯ï¼Œå°†æ‰€æœ‰é€šè¿‡å¼•ç”¨<code>node_modules</code>æ–‡ä»¶å¤¹ä¸‹çš„éƒ½æ”¾åœ¨<code>vendors</code>ç»„ä¸­</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>defaultç»„ï¼š</strong> é»˜è®¤ç»„ï¼Œæ„æ€æ˜¯ï¼Œä¸ç¬¦åˆ<code>vendors</code>çš„åˆ†ç»„éƒ½å°†åˆ†é…åœ¨<code>default</code>ç»„ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ–‡ä»¶å³æ»¡è¶³<code>vendors</code>åˆ†ç»„ï¼Œåˆæ»¡è¶³<code>default</code>åˆ†ç»„ï¼Œé‚£ä¹ˆé€šè¿‡<code>priority</code>çš„å€¼è¿›è¡Œå–èˆï¼Œå€¼æœ€å¤§<strong>ä¼˜å…ˆçº§</strong>è¶Šé«˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">default</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">minChunks</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>reuseExistingChunkï¼š</strong> ä¸­æ–‡è§£é‡Šæ˜¯å¤ç”¨å·²å­˜åœ¨çš„æ–‡ä»¶ã€‚æ„æ€æ˜¯ï¼Œå¦‚æœæœ‰ä¸€ä¸ª<code>a.js</code>æ–‡ä»¶ï¼Œå®ƒé‡Œé¢å¼•ç”¨äº†<code>b.js</code>ï¼Œä½†æˆ‘ä»¬å…¶ä»–æ¨¡å—åˆæœ‰å¼•ç”¨<code>b.js</code>çš„åœ°æ–¹ã€‚å¼€å¯è¿™ä¸ªé…ç½®é¡¹åï¼Œåœ¨æ‰“åŒ…æ—¶ä¼šåˆ†æ<code>b.js</code>å·²ç»æ‰“åŒ…è¿‡äº†ï¼Œç›´æ¥å¯ä»¥å¤ç”¨ä¸ç”¨å†æ¬¡æ‰“åŒ…ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// a.js</span></span>
<span class="line"><span class="token keyword">import</span> b <span class="token keyword">from</span> <span class="token string">&#39;b.js&#39;</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// c.js</span></span>
<span class="line"><span class="token keyword">import</span> b <span class="token keyword">from</span> <span class="token string">&#39;b.js&#39;</span><span class="token punctuation">;</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;c.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="è‡ªå®šä¹‰æ–‡ä»¶å" tabindex="-1"><a class="header-anchor" href="#è‡ªå®šä¹‰æ–‡ä»¶å"><span>è‡ªå®šä¹‰æ–‡ä»¶å</span></a></h4><p>æˆ‘ä»¬å¦‚æœä¸å¯¹ä»£ç åˆ†éš”åçš„æ–‡ä»¶è¿›è¡Œé…ç½®çš„è¯ï¼Œé‚£ä¹ˆåœ¨<code>vendors</code>ç»„é‡Œé¢çš„æ–‡ä»¶åï¼Œé»˜è®¤ä¼šæŒ‰<code>vendors</code>+<code>main</code>(å…¥å£)çš„å½¢å¼å‘½åï¼Œä¾‹å¦‚ï¼š<code>vendors~main.js</code>ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰é…ç½®æ–‡ä»¶åçš„è¯ï¼Œåˆ™éœ€è¦åˆ†æƒ…å†µï¼š</p><ul><li>åŒæ­¥ä»£ç åˆ†éš”ï¼šä½¿ç”¨<code>filename</code>å‘½åã€‚</li><li>éåŒæ­¥ä»£ç åˆ†éš”ï¼šä½¿ç”¨<code>name</code>æ¥å‘½ä»¤ã€‚</li></ul><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// åŒæ­¥ä»£ç åˆ†éš”</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®ç•¥</span></span>
<span class="line">  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;initial&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;vendors.js&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// éåŒæ­¥ä»£ç åˆ†éš”</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®ç•¥</span></span>
<span class="line">  <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;async&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">vendors</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\\\\/]node_modules[\\\\/]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">priority</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;vendors&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="lazy-loadingæ‡’åŠ è½½" tabindex="-1"><a class="header-anchor" href="#lazy-loadingæ‡’åŠ è½½"><span>Lazy Loadingæ‡’åŠ è½½</span></a></h2><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p><code>Lazy Loading</code>æ‡’åŠ è½½çš„ç†è§£æ˜¯ï¼šé€šè¿‡å¼‚æ­¥å¼•å…¥ä»£ç ï¼Œè¿™é‡Œè¯´çš„å¼‚æ­¥ï¼Œå¹¶ä¸æ˜¯åœ¨é¡µé¢ä¸€å¼€å§‹å°±åŠ è½½ï¼Œè€Œæ˜¯åœ¨åˆé€‚çš„æ—¶æœºè¿›è¡ŒåŠ è½½ã€‚</p></div><p><code>Lazy Loading</code>æ‡’åŠ è½½çš„å®é™…æ¡ˆä¾‹æˆ‘ä»¬å·²ç»åœ¨ä¸Šä¸€å°èŠ‚ä¹¦å†™äº†ä¸€ä¸ªä¾‹å­ï¼Œä¸è¿‡æˆ‘ä»¬ä¾ç„¶å¯ä»¥åšä¸€ä¸‹å°å°çš„æ”¹åŠ¨ï¼Œè®©å®ƒä½¿ç”¨<code>async/await</code>è¿›è¡Œå¼‚æ­¥åŠ è½½ï¼Œå®ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// é¡µé¢ç‚¹å‡»çš„æ—¶å€™æ‰åŠ è½½lodashæ¨¡å—</span></span>
<span class="line">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">getComponet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getComponet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span>  <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &#39;lodash&#39; */</span> <span class="token string">&#39;lodash&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;**&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> element<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šæ‡’åŠ è½½çš„ç»“æœä¸ä¸Šä¸€å°èŠ‚çš„ç»“æœç±»ä¼¼ï¼Œå°±ä¸åœ¨æ­¤å±•ç¤ºï¼Œä½ å¯ä»¥åœ¨ä½ æœ¬åœ°çš„é¡¹ç›®ä¸­æ‰“åŒ…åè‡ªè¡Œæµ‹è¯•å’ŒæŸ¥çœ‹ã€‚</p><h2 id="preloading-å’Œprefetching" tabindex="-1"><a class="header-anchor" href="#preloading-å’Œprefetching"><span>PreLoading å’ŒPrefetching</span></a></h2><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p>åœ¨ä»¥ä¸Š<code>Lazy Loading</code>çš„ä¾‹å­ä¸­ï¼Œåªæœ‰å½“æˆ‘ä»¬åœ¨é¡µé¢ç‚¹å‡»æ—¶æ‰ä¼šåŠ è½½<code>lodash</code>ï¼Œä¹Ÿæœ‰ä¸€äº›æ¨¡å—è™½ç„¶æ˜¯å¼‚æ­¥å¯¼å…¥çš„ï¼Œä½†æˆ‘ä»¬å¸Œæœ›èƒ½æå‰è¿›è¡ŒåŠ è½½ï¼Œ<code>PreLoading</code>å’Œ<code>Prefetching</code>å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ä¸€ç‚¹ï¼Œå®ƒä»¬çš„ç”¨æ³•ç±»ä¼¼ï¼Œä½†å®ƒä»¬è¿˜æ˜¯æœ‰åŒºåˆ«çš„ï¼š<code>Prefetching</code>ä¸ä¼šè·Ÿéšä¸»è¿›ç¨‹ä¸€èµ·ä¸‹è½½ï¼Œè€Œæ˜¯ç­‰åˆ°ä¸»è¿›ç¨‹åŠ è½½å®Œæ¯•ï¼Œå¸¦å®½é‡Šæ”¾åæ‰è¿›è¡ŒåŠ è½½ï¼Œ<code>PreLoading</code>ä¼šéšä¸»è¿›ç¨‹ä¸€èµ·åŠ è½½ã€‚</p></div><p>å®ç°<code>PreLoading</code>æˆ–è€…<code>Prefetching</code>éå¸¸ç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ä¸Šä¸€èŠ‚çš„ä¾‹å­ä¸­åŠ ä¸€ç‚¹ç‚¹ä»£ç å³å¯(å‚è€ƒé«˜äº®éƒ¨åˆ†)ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// é¡µé¢ç‚¹å‡»çš„æ—¶å€™æ‰åŠ è½½lodashæ¨¡å—</span></span>
<span class="line">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">getComponet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getComponet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">  <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token keyword">default</span><span class="token operator">:</span> _ <span class="token punctuation">}</span>  <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">&#39;lodash&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  <span class="token keyword">var</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;**&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> element<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ”¹å†™å®Œæ¯•åï¼Œæˆ‘ä»¬ä½¿ç”¨<code>npm run dev</code>æˆ–è€…<code>npm run build</code>è¿›è¡Œæ‰“åŒ…ï¼Œåœ¨æµè§ˆå™¨ä¸­ç‚¹å‡»é¡µé¢ï¼Œæˆ‘ä»¬å°†åœ¨<code>network</code>é¢æ¿çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="`+l+`" alt="Prefetchç»“æœ"></p><p>ç›¸ä¿¡èªæ˜çš„ä½ ä¸€å®šçœ‹åˆ°äº†<code>0.js</code>ï¼Œå®ƒæ˜¯<code>from disk cache</code>ï¼Œé‚£ä¸ºä»€ä¹ˆï¼ŸåŸå› åœ¨äºï¼Œ<code>Prefetching</code>çš„ä»£ç å®ƒä¼šåœ¨<code>head</code>å¤´éƒ¨ï¼Œæ·»åŠ åƒè¿™æ ·çš„ä¸€æ®µå†…å®¹ï¼š</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line">&lt;link rel=<span class="token string">&quot;prefetch&quot;</span> as=<span class="token string">&quot;script&quot;</span> href=<span class="token string">&quot;0.js&quot;</span>&gt;</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>è¿™æ ·ä¸€æ®µå†…å®¹è¿½åŠ åˆ°<code>head</code>å¤´éƒ¨åï¼ŒæŒ‡ç¤ºæµè§ˆå™¨åœ¨ç©ºé—²æ—¶é—´é‡Œå»åŠ è½½<code>0.js</code>ï¼Œè¿™æ­£æ˜¯<code>Prefetching</code>å®ƒæ‰€èƒ½å¸®æˆ‘ä»¬åšåˆ°çš„äº‹æƒ…ï¼Œè€Œ<code>PreLoading</code>çš„ç”¨æ³•äºæ­¤ç±»ä¼¼ï¼Œè¯·è‡ªè¡Œæµ‹è¯•ã€‚</p><h2 id="cssä»£ç åˆ†å‰²" tabindex="-1"><a class="header-anchor" href="#cssä»£ç åˆ†å‰²"><span>CSSä»£ç åˆ†å‰²</span></a></h2><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p>å½“æˆ‘ä»¬åœ¨ä½¿ç”¨<code>style-loader</code>å’Œ<code>css-loader</code>æ‰“åŒ…<code>.css</code>æ–‡ä»¶æ—¶ä¼šç›´æ¥æŠŠCSSæ–‡ä»¶æ‰“åŒ…è¿›<code>.js</code>æ–‡ä»¶ä¸­ï¼Œç„¶åç›´æ¥æŠŠæ ·å¼é€šè¿‡<code>&lt;style&gt;&lt;/style&gt;</code>çš„æ–¹å¼å†™åœ¨é¡µé¢ï¼Œå¦‚æœæˆ‘ä»¬è¦æŠŠCSSå•ç‹¬æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œç„¶åé€šè¿‡<code>link</code>æ ‡ç­¾å¼•å…¥ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>mini-css-extract-plugin</code>æ’ä»¶è¿›è¡Œæ‰“åŒ…ã€‚</p></div><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p><s>æˆªæ­¢åˆ°å†™æ­¤æ–‡æ¡£æ—¶ï¼Œæ­¤æ’ä»¶è¿˜æœªæ”¯æŒHMRï¼Œæ„å‘³ç€æˆ‘ä»¬è¦ä½¿ç”¨è¿™ä¸ªæ’ä»¶è¿›è¡Œæ‰“åŒ…CSSæ—¶ï¼Œä¸ºäº†å¼€å‘æ•ˆç‡ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œå¼€å‘ç¯å¢ƒä¾ç„¶è¿˜æ˜¯ä½¿ç”¨<code>style-loader</code>è¿›è¡Œæ‰“åŒ…</s>ã€‚<br><strong>æ­¤æ’ä»¶çš„æœ€æ–°ç‰ˆå·²æ”¯æŒHMR</strong>ã€‚</p></div><p>åœ¨é…ç½®ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>npm install</code>è¿›è¡Œå®‰è£…æ­¤æ’ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">$ <span class="token function">npm</span> <span class="token function">install</span> mini-css-extract-plugin <span class="token parameter variable">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åï¼Œç”±äºæ­¤æ’ä»¶å·²æ”¯æŒ<code>HMR</code>ï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠé…ç½®å†™åœ¨<code>webpack.common.js</code>ä¸­(ä»¥ä¸‹é…ç½®ä¸ºå®Œæ•´é…ç½®ï¼Œæ”¹åŠ¨å‚è€ƒé«˜äº®ä»£ç å—)ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;html-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token punctuation">{</span> CleanWebpackPlugin <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;clean-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line highlighted"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;mini-css-extract-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">main</span><span class="token operator">:</span> <span class="token string">&#39;./src/index.js&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.css$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">          <span class="token punctuation">{</span> </span>
<span class="line highlighted">            <span class="token literal-property property">loader</span><span class="token operator">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span></span>
<span class="line highlighted">            <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">              <span class="token literal-property property">hmr</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line highlighted">              <span class="token literal-property property">reloadAll</span><span class="token operator">:</span> <span class="token boolean">true</span></span>
<span class="line highlighted">            <span class="token punctuation">}</span></span>
<span class="line">          <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token string">&#39;css-loader&#39;</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&quot;babel-loader&quot;</span> </span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">&#39;src/index.html&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">CleanWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line highlighted">    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line highlighted">      <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].css&#39;</span></span>
<span class="line highlighted">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">path</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span><span class="token string">&#39;../dist&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•ä»¥åï¼Œæˆ‘ä»¬æ¥åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>style.css</code>æ–‡ä»¶ï¼Œå®ƒçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ”¹åŠ¨ä¸€ä¸‹<code>index.js</code>æ–‡ä»¶ï¼Œè®©å®ƒå¼•å…¥<code>style.css</code>ï¼Œå®ƒçš„ä»£ç å¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./style.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;Hello,world&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>npm run build</code>è¿›è¡Œæ‰“åŒ…ï¼Œ<code>dist</code>æ‰“åŒ…ç›®å½•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>css</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>css<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">æ³¨æ„</p><p>å¦‚æœå‘ç°å¹¶æ²¡æœ‰æ‰“åŒ…ç”Ÿæˆ<code>main.css</code>æ–‡ä»¶ï¼Œå¯èƒ½æ˜¯<code>Tree Shaking</code>çš„å‰¯ä½œç”¨ï¼Œåº”è¯¥åœ¨<code>package.json</code>ä¸­æ·»åŠ å±æ€§<code>sideEffects:[&#39;*.css&#39;]</code></p></div><h4 id="csså‹ç¼©" tabindex="-1"><a class="header-anchor" href="#csså‹ç¼©"><span>CSSå‹ç¼©</span></a></h4><div class="hint-container tip"><p class="hint-container-title">ç†è§£</p><p><code>CSS</code>å‹ç¼©çš„ç†è§£æ˜¯ï¼šå½“æˆ‘ä»¬æœ‰ä¸¤ä¸ªç›¸åŒçš„æ ·å¼åˆ†å¼€å†™çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼›ä¸ºäº†å‡å°‘<code>CSS</code>æ–‡ä»¶çš„ä½“ç§¯ï¼Œæˆ‘ä»¬éœ€è¦åƒå‹ç¼©<code>JS</code>æ–‡ä»¶ä¸€æ ·ï¼Œå‹ç¼©ä¸€ä¸‹<code>CSS</code>æ–‡ä»¶ã€‚</p></div><p>æˆ‘ä»¬å†åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>style1.css</code>æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">body</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">line-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨<code>index.js</code>æ–‡ä»¶ä¸­å¼•å…¥æ­¤CSSæ–‡ä»¶</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./style.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token string">&#39;./style1.css&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">var</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&#39;Hello,world&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨æ‰“åŒ…<code>npm run build</code>æ‰“åŒ…å‘½ä»¤ï¼Œæˆ‘ä»¬å‘ç°è™½ç„¶æ’ä»¶å¸®æˆ‘ä»¬æŠŠCSSæ‰“åŒ…åœ¨äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œä½†å¹¶æ²¡æœ‰åˆå¹¶å‹ç¼©ã€‚</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">body</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token selector">body</span><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">line-height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¦å®ç°<code>CSS</code>çš„å‹ç¼©ï¼Œæˆ‘ä»¬éœ€è¦å†å®‰è£…ä¸€ä¸ªæ’ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">$ <span class="token function">npm</span> <span class="token function">install</span> optimize-css-assets-webpack-plugin <span class="token parameter variable">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åæˆ‘ä»¬éœ€è¦å†ä¸€æ¬¡æ”¹å†™<code>webpack.common.js</code>çš„é…ç½®ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line highlighted"><span class="token keyword">const</span> optimizaCssAssetsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;optimize-css-assets-webpack-plugin&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">optimization</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">splitChunks</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">chunks</span><span class="token operator">:</span> <span class="token string">&#39;all&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line highlighted">    <span class="token literal-property property">minimizer</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line highlighted">      <span class="token keyword">new</span> <span class="token class-name">optimizaCssAssetsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line highlighted">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•ä»¥åï¼Œæˆ‘ä»¬å†æ¬¡ä½¿ç”¨<code>npm run build</code>è¿›è¡Œæ‰“åŒ…ï¼Œæ‰“åŒ…ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹è§ï¼Œä¸¤ä¸ªCSSæ–‡ä»¶çš„ä»£ç å·²ç»å‹ç¼©åˆå¹¶äº†ã€‚</p><div class="language-css line-numbers-mode" data-highlighter="prismjs" data-ext="css"><pre><code><span class="line"><span class="token selector">body</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">line-height</span><span class="token punctuation">:</span>100px<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="webpackå’Œæµè§ˆå™¨ç¼“å­˜-caching" tabindex="-1"><a class="header-anchor" href="#webpackå’Œæµè§ˆå™¨ç¼“å­˜-caching"><span>Webpackå’Œæµè§ˆå™¨ç¼“å­˜(Caching)</span></a></h2><p>åœ¨è®²è¿™ä¸€å°èŠ‚ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ¸…ç†ä¸‹é¡¹ç›®ç›®å½•ï¼Œæ”¹å†™ä¸‹æˆ‘ä»¬çš„<code>index.js</code>ï¼Œåˆ é™¤æ‰ä¸€äº›æ²¡ç”¨çš„æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#39;lodash&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> dom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">dom<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Dell&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Lee&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;---&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¸…ç†åçš„é¡¹ç›®ç›®å½•å¯èƒ½æ˜¯è¿™æ ·çš„ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> build</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> src</span>
<span class="line">    <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line">    <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> postcss<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬ä½¿ç”¨<code>npm run build</code>æ‰“åŒ…å‘½ä»¤ï¼Œæ‰“åŒ…æˆ‘ä»¬çš„ä»£ç ï¼Œå¯èƒ½ä¼šç”Ÿæˆå¦‚ä¸‹çš„æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> build</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>common<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> webpack<span class="token punctuation">.</span>prod<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> src</span>
<span class="line">    <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line">    <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> <span class="token keyword">package</span><span class="token punctuation">.</span>json</span>
<span class="line"><span class="token operator">|</span><span class="token operator">--</span> postcss<span class="token punctuation">.</span>config<span class="token punctuation">.</span>js</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ‰“åŒ…ç”Ÿæˆçš„<code>dist</code>ç›®å½•ä¸‹ï¼Œæ–‡ä»¶åæ˜¯<code>main.js</code>å’Œ<code>vendors~main.js</code>ï¼Œå¦‚æœæˆ‘ä»¬æŠŠ<code>dist</code>ç›®å½•æ”¾åœ¨æœåŠ¡å™¨éƒ¨ç½²çš„è¯ï¼Œå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®é¡µé¢æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æŠŠè¿™ä¸¤ä¸ª<code>.js</code>æ–‡ä»¶ç¼“å­˜èµ·æ¥ï¼Œä¸‹ä¸€æ¬¡éå¼ºåˆ¶æ€§åˆ·æ–°é¡µé¢æ—¶ï¼Œä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜èµ·æ¥çš„æ–‡ä»¶ã€‚<br><br> å‡å¦‚ï¼Œæˆ‘ä»¬åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡åˆ·æ–°é¡µé¢å’Œç¬¬äºŒæ¬¡åˆ·æ–°é¡µé¢ä¹‹é—´ï¼Œæˆ‘ä»¬ä¿®æ”¹äº†æˆ‘ä»¬çš„ä»£ç ï¼Œå¹¶å†ä¸€æ¬¡éƒ¨ç½²ï¼Œè¿™ä¸ªæ—¶å€™ç”±äºæµè§ˆå™¨ç¼“å­˜äº†è¿™ä¸¤ä¸ª<code>.js</code>æ–‡ä»¶ï¼Œæ‰€ä»¥ç”¨æˆ·ç•Œé¢æ— æ³•è·å–æœ€æ–°çš„ä»£ç ã€‚<br><br> é‚£ä¹ˆï¼Œæˆ‘ä»¬æœ‰åŠæ³•èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Œç­”æ¡ˆæ˜¯<code>[contenthash]</code>å ä½ç¬¦ï¼Œå®ƒèƒ½æ ¹æ®æ–‡ä»¶çš„å†…å®¹ï¼Œåœ¨æ¯ä¸€æ¬¡æ‰“åŒ…æ—¶ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„hashå€¼ï¼Œåªè¦æˆ‘ä»¬æ–‡ä»¶å‘ç”Ÿäº†å˜åŠ¨ï¼Œå°±é‡æ–°ç”Ÿæˆä¸€ä¸ªhashå€¼ï¼Œæ²¡æœ‰æ”¹åŠ¨çš„è¯ï¼Œ<code>[contenthash]</code>åˆ™ä¸ä¼šå‘ç”Ÿå˜åŠ¨ï¼Œå¯ä»¥åœ¨<code>output</code>ä¸­è¿›è¡Œé…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// å¼€å‘ç¯å¢ƒä¸‹çš„outputé…ç½®è¿˜æ˜¯åŸæ¥çš„é‚£æ ·ï¼Œä¹Ÿå°±æ˜¯webpack.common.jsä¸­çš„outputé…ç½®</span></span>
<span class="line"><span class="token comment">// å› ä¸ºå¼€å‘ç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬ä¸ç”¨è€ƒè™‘ç¼“å­˜é—®é¢˜</span></span>
<span class="line"><span class="token comment">// webpack.prod.jsä¸­æ·»åŠ outputé…ç½®</span></span>
<span class="line"><span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[contenthash].js&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">chunkFilename</span><span class="token operator">:</span> <span class="token string">&#39;[name].[contenthash].js&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨<code>npm run build</code>è¿›è¡Œæ‰“åŒ…ï¼Œ<code>dist</code>æ‰“åŒ…ç›®å½•çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸€ä¸ª<code>.js</code>æ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„<code>hash</code>å€¼ï¼Œè¿™æ ·é…ç½®åå°±èƒ½æœ‰æ•ˆè§£å†³æµè§ˆå™¨ç¼“å­˜çš„é—®é¢˜ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token operator">|</span><span class="token operator">--</span> dist</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> index<span class="token punctuation">.</span>html</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>8bef05e11ca1dc804836<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> main<span class="token punctuation">.</span>8bef05e11ca1dc804836<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>4b711ce6ccdc861de436<span class="token punctuation">.</span>js</span>
<span class="line"><span class="token operator">|</span>   <span class="token operator">|</span><span class="token operator">--</span> vendors<span class="token operator">~</span>main<span class="token punctuation">.</span>4b711ce6ccdc861de436<span class="token punctuation">.</span>js<span class="token punctuation">.</span>map</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="shimming" tabindex="-1"><a class="header-anchor" href="#shimming"><span>Shimming</span></a></h2><p>æœ‰æ—¶å€™æˆ‘ä»¬åœ¨å¼•å…¥ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œä¸å¾—ä¸å¤„ç†ä¸€äº›å…¨å±€å˜é‡çš„é—®é¢˜ï¼Œä¾‹å¦‚jQueryçš„<code>$</code>ï¼Œlodashçš„<code>_</code>ï¼Œä½†ç”±äºä¸€äº›è€çš„ç¬¬ä¸‰æ–¹åº“ä¸èƒ½ç›´æ¥ä¿®æ”¹å®ƒçš„ä»£ç ï¼Œè¿™æ—¶æˆ‘ä»¬èƒ½ä¸èƒ½å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå½“æ–‡ä»¶ä¸­å­˜åœ¨<code>$</code>æˆ–è€…<code>_</code>çš„æ—¶å€™è‡ªåŠ¨çš„å¸®ä»–ä»¬å¼•å…¥å¯¹åº”çš„åŒ…ã€‚</p><div class="hint-container tip"><p class="hint-container-title">è§£å†³åŠæ³•</p><p>è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨<code>ProvidePlugin</code>æ’ä»¶æ¥è§£å†³ï¼Œè¿™ä¸ªæ’ä»¶å·²ç»è¢« Webpack å†…ç½®ï¼Œæ— éœ€å®‰è£…ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</p></div><p>åœ¨<code>src</code>ç›®å½•ä¸‹æ–°å»º<code>jquery.ui.js</code>æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼Œå®ƒä½¿ç”¨äº†<code>jQuery</code>çš„<code>$</code>ç¬¦å·ï¼Œåˆ›å»ºè¿™ä¸ªæ–‡ä»¶ç›®çš„æ˜¯ä¸ºäº†æ¥æ¨¡ä»¿ç¬¬ä¸‰æ–¹åº“ã€‚</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token constant">UI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;body&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&#39;background&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;green&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºå®Œæ¯•åï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹<code>index.js</code>æ–‡ä»¶ï¼Œ è®©å®ƒä½¿ç”¨åˆšæ‰æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶ï¼š</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">&#39;lodash&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> $ <span class="token keyword">from</span> <span class="token string">&#39;jquery&#39;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">UI</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./jquery.ui&#39;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token constant">UI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">var</span> dom <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&lt;div&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;Dell&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Lee&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">&#39;---&#39;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/div&gt;</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&#39;#root&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>dom<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨<code>npm run dev</code>è¿›è¡Œæ‰“åŒ…ï¼Œå®ƒçš„ç»“æœå¦‚ä¸‹ï¼š</p><p><img src="`+c+`" alt="æ‰“åŒ…ç»“æœ"></p><p><strong>é—®é¢˜ï¼š</strong> æˆ‘ä»¬å‘ç°ï¼Œæ ¹æœ¬è¿è¡Œä¸èµ·æ¥ï¼ŒæŠ¥é”™<code>$ is not defined</code><br><strong>è§£ç­”ï¼š</strong> è¿™æ˜¯å› ä¸ºè™½ç„¶æˆ‘ä»¬åœ¨<code>index.js</code>ä¸­å¼•å…¥çš„<code>jquery</code>æ–‡ä»¶ï¼Œä½†<code>$</code>ç¬¦å·åªèƒ½åœ¨<code>index.js</code>æ‰æœ‰æ•ˆï¼Œåœ¨<code>jquery.ui.js</code>æ— æ•ˆï¼ŒæŠ¥é”™æ˜¯å› ä¸º<code>jquery.ui.js</code>ä¸­<code>$</code>ç¬¦å·æ‰¾ä¸åˆ°å¼•èµ·çš„ã€‚<br></p><p>ä»¥ä¸Šåœºæ™¯å®Œç¾å†ç°äº†æˆ‘ä»¬æœ€å¼€å§‹æåˆ°çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±é€šè¿‡é…ç½®è§£å†³ï¼Œé¦–å…ˆåœ¨<code>webpack.common.js</code>æ–‡ä»¶ä¸­ä½¿ç”¨<code>ProvidePlugin</code>æ’ä»¶ï¼š</p><div class="hint-container tip"><p class="hint-container-title">è¯´æ˜</p><p>é…ç½®<code>$:&#39;jquery&#39;</code>ï¼Œåªè¦æˆ‘ä»¬æ–‡ä»¶ä¸­ä½¿ç”¨äº†<code>$</code>ç¬¦å·ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å¼•å…¥<code>jquery</code>ï¼Œç›¸å½“äº<code>import $ from &#39;jquery&#39;</code></p></div><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;webpack&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line highlighted">  <span class="token comment">// å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProvidePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">$</span><span class="token operator">:</span> <span class="token string">&#39;jquery&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token literal-property property">_</span><span class="token operator">:</span> <span class="token string">&#39;lodash&#39;</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ‰“åŒ…ç»“æœï¼š</strong> ä½¿ç”¨<code>npm run dev</code>è¿›è¡Œæ‰“åŒ…ï¼Œæ‰“åŒ…ç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥å‘ç°ï¼Œé¡¹ç›®å·²ç»å¯ä»¥æ­£ç¡®è¿è¡Œäº†ã€‚</p><p><img src="`+i+`" alt="æ‰“åŒ…ç»“æœ"></p><h2 id="å¤„ç†å…¨å±€thisæŒ‡å‘é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¤„ç†å…¨å±€thisæŒ‡å‘é—®é¢˜"><span>å¤„ç†å…¨å±€thisæŒ‡å‘é—®é¢˜</span></a></h2><p>æˆ‘ä»¬ç°åœ¨æ¥æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ¨¡å—ä¸­çš„<code>this</code>åˆ°åº•æŒ‡å‘ä»€ä¹ˆï¼Œæ˜¯æ¨¡å—è‡ªèº«è¿˜æ˜¯å…¨å±€çš„<code>window</code>å¯¹è±¡</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line"><span class="token comment">// index.jsä»£ç ï¼Œåœ¨æµè§ˆå™¨ä¸­è¾“å‡ºï¼šfalse</span></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">===</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸Šæ‰€ç¤ºï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨<code>npm run dev</code>è¿è¡Œé¡¹ç›®ï¼Œè¿è¡Œ<code>index.html</code>æ—¶ï¼Œä¼šåœ¨æµè§ˆå™¨çš„<code>console</code>é¢æ¿è¾“å‡º<code>false</code>ï¼Œè¯æ˜åœ¨æ¨¡å—ä¸­<code>this</code>æŒ‡å‘æ¨¡å—è‡ªèº«ï¼Œè€Œä¸æ˜¯å…¨å±€çš„<code>window</code>å¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä»€ä¹ˆåŠæ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p><div class="hint-container tip"><p class="hint-container-title">è§£å†³åŠæ³•</p><p>å®‰è£…ä½¿ç”¨<code>imports-loader</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p></div><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">$ <span class="token function">npm</span> <span class="token function">install</span> imports-loader <span class="token parameter variable">-D</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å®‰è£…å®Œæ¯•åï¼Œæˆ‘ä»¬åœ¨<code>webpack.common.js</code>åŠ ä¸€ç‚¹é…ç½®ï¼Œåœ¨<code>.js</code>çš„loaderå¤„ç†ä¸­ï¼Œæ·»åŠ <code>imports-loader</code></p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js"><pre><code><span class="line">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// ... å…¶å®ƒé…ç½®</span></span>
<span class="line">  <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span> </span>
<span class="line">        <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> </span>
<span class="line">        <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">          <span class="token punctuation">{</span></span>
<span class="line">            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;babel-loader&#39;</span></span>
<span class="line">          <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token punctuation">{</span></span>
<span class="line highlighted">            <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">&#39;imports-loader?this=&gt;window&#39;</span></span>
<span class="line">          <span class="token punctuation">}</span></span>
<span class="line">        <span class="token punctuation">]</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">]</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é…ç½®å®Œæ¯•åä½¿ç”¨<code>npm run dev</code>æ¥è¿›è¡Œæ‰“åŒ…ï¼ŒæŸ¥çœ‹<code>console</code>æ§åˆ¶å°è¾“å‡º<code>true</code>ï¼Œè¯æ˜<code>this</code>è¿™ä¸ªæ—¶å€™å·²ç»æŒ‡å‘äº†å…¨å±€<code>window</code>å¯¹è±¡ï¼Œé—®é¢˜è§£å†³ã€‚</p><p><img src="`+r+'" alt="æ‰“åŒ…ç»“æœ"></p>',198)]))}const m=n(u,[["render",d]]),b=JSON.parse('{"path":"/webpack/webpack/advanced.html","title":"Webpackè¿›é˜¶","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1746545772000,"contributors":[{"name":"wangtunan","username":"wangtunan","email":"why583440138@gmail.com","commits":1,"url":"https://github.com/wangtunan"}],"changelog":[{"hash":"0819d3a24b098b91020da2fcc54ff0badcec7ca3","time":1746545772000,"email":"why583440138@gmail.com","author":"wangtunan","message":"blog RAGç»“æ„åŒ–æ–‡æ¡£å¯¼å…¥æ–‡ç« æ’°å†™"}]},"filePathRelative":"webpack/webpack/advanced.md"}');export{m as comp,b as data};
